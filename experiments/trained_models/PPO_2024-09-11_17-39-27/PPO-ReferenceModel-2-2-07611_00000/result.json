{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.34287770204246043, "cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 0.038843896123580635, "policy_loss": -0.003331999809870467, "vf_loss": 0.05368450675159693, "vf_explained_var": 0.010197405517101289, "kl": 0.004611516448062502, "entropy": 1.2430913537740707, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 20.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -2.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.859375, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 3200, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.96484375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.874898999456375, "mean_inference_ms": 6.3122548754253085, "mean_action_processing_ms": 3.227510622569493, "mean_env_wait_ms": 24.533070269085115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.13898983597755432, "StateBufferConnector_ms": 0.053128600120544434, "ViewRequirementAgentConnector_ms": 0.7262788712978363}, "num_episodes": 32, "episode_return_max": -2.0, "episode_return_min": -4.0, "episode_return_mean": -3.859375, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 597.8949181047392, "num_env_steps_trained_throughput_per_sec": 597.8949181047392, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 6690.139, "restore_workers_time_ms": 0.0, "training_step_time_ms": 6690.139, "sample_time_ms": 5666.004, "learn_time_ms": 995.8, "learn_throughput": 4016.87, "synch_weights_time_ms": 28.335}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "07611_00000", "date": "2024-09-11_17-40-14", "timestamp": 1726069214, "time_this_iter_s": 6.699134111404419, "time_total_s": 6.699134111404419, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE0A1630>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.699134111404419, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 71.87777777777777, "ram_util_percent": 88.15555555555555, "gpu_util_percent0": 0.11333333333333334, "vram_util_percent0": 0.13639322916666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32390250749886035, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 0.02814167855249252, "policy_loss": -0.0026814436714630574, "vf_loss": 0.042855330649763344, "vf_explained_var": 0.02179771214723587, "kl": 0.0037591399516713865, "entropy": 1.2408121705055237, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -2.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.859375, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 6400, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.96484375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -2.5, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.520927533033353, "mean_inference_ms": 6.1026919572605, "mean_action_processing_ms": 3.1258355641677156, "mean_env_wait_ms": 23.825784411201486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.14516077935695648, "StateBufferConnector_ms": 0.04257671535015106, "ViewRequirementAgentConnector_ms": 0.6596054881811142}, "num_episodes": 32, "episode_return_max": -2.0, "episode_return_min": -4.0, "episode_return_mean": -3.859375, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 687.8156846605139, "num_env_steps_trained_throughput_per_sec": 687.8156846605139, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 6252.825, "restore_workers_time_ms": 0.0, "training_step_time_ms": 6252.825, "sample_time_ms": 5290.589, "learn_time_ms": 933.231, "learn_throughput": 4286.185, "synch_weights_time_ms": 28.504}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "07611_00000", "date": "2024-09-11_17-40-33", "timestamp": 1726069233, "time_this_iter_s": 5.823659420013428, "time_total_s": 12.522793531417847, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE109120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.522793531417847, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 37.148, "ram_util_percent": 91.79199999999999, "gpu_util_percent0": 0.054400000000000004, "vram_util_percent0": 0.140478515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.22369652651250363, "cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 0.0218382310893503, "policy_loss": -0.0020618718415789774, "vf_loss": 0.03597399918362498, "vf_explained_var": 0.06385609805583954, "kl": 0.003857788974437426, "entropy": 1.226678618788719, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 100.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -2.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.8333333333333335, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 9600, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.9583333333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -2.5, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.279917297951924, "mean_inference_ms": 5.930611466030569, "mean_action_processing_ms": 3.040488834038365, "mean_env_wait_ms": 23.102503150489763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12818624575932822, "StateBufferConnector_ms": 0.05570501089096069, "ViewRequirementAgentConnector_ms": 0.6485650936762491}, "num_episodes": 32, "episode_return_max": -2.0, "episode_return_min": -4.0, "episode_return_mean": -3.8333333333333335, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 738.6087347535963, "num_env_steps_trained_throughput_per_sec": 738.6087347535963, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 5973.746, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5973.746, "sample_time_ms": 5000.336, "learn_time_ms": 943.418, "learn_throughput": 4239.904, "synch_weights_time_ms": 29.325}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "07611_00000", "date": "2024-09-11_17-40-39", "timestamp": 1726069239, "time_this_iter_s": 5.424623250961304, "time_total_s": 17.94741678237915, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE108D30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.94741678237915, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 63.51428571428572, "ram_util_percent": 93.41428571428571, "gpu_util_percent0": 0.051428571428571435, "vram_util_percent0": 0.14531598772321427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40984115451574327, "cur_kl_coeff": 0.025, "cur_lr": 0.0003, "total_loss": 0.034340787067776546, "policy_loss": -0.00281904130060866, "vf_loss": 0.049202303681522605, "vf_explained_var": 0.08903592973947524, "kl": 0.0033913314554411046, "entropy": 1.2127259910106658, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 140.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -2.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.7, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -2.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -2.0, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -2.5, -4.0, -4.0, -2.0, -3.5, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.645383934774962, "mean_inference_ms": 5.481733990011324, "mean_action_processing_ms": 2.814129800904563, "mean_env_wait_ms": 21.19223204882922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12471580505371094, "StateBufferConnector_ms": 0.05741286277770996, "ViewRequirementAgentConnector_ms": 0.6471171379089355}, "num_episodes": 64, "episode_return_max": -2.0, "episode_return_min": -4.0, "episode_return_mean": -3.7, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 769.2140802923168, "num_env_steps_trained_throughput_per_sec": 769.2140802923168, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 5780.338, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5780.338, "sample_time_ms": 4821.347, "learn_time_ms": 929.097, "learn_throughput": 4305.257, "synch_weights_time_ms": 29.143}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "07611_00000", "date": "2024-09-11_17-40-44", "timestamp": 1726069244, "time_this_iter_s": 5.209384918212891, "time_total_s": 23.15680170059204, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE0A1630>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.15680170059204, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 66.93333333333332, "ram_util_percent": 93.46666666666665, "gpu_util_percent0": 0.06833333333333333, "vram_util_percent0": 0.1517333984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12625832185149194, "cur_kl_coeff": 0.0125, "cur_lr": 0.0003, "total_loss": 0.007936561273527331, "policy_loss": -0.0024270681042253273, "vf_loss": 0.02224490838125348, "vf_explained_var": 0.24020411670207978, "kl": 0.004759911846304021, "entropy": 1.1940777331590653, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -2.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.6, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -2.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -2.0, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -2.5, -4.0, -4.0, -2.0, -3.5, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -2.5, -2.5, -4.0, -3.5, -3.0, -4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -2.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.491872903618308, "mean_inference_ms": 5.372963003751993, "mean_action_processing_ms": 2.7586298867515904, "mean_env_wait_ms": 20.688784820273014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12481045722961426, "StateBufferConnector_ms": 0.033050537109375, "ViewRequirementAgentConnector_ms": 0.6499695777893066}, "num_episodes": 32, "episode_return_max": -2.0, "episode_return_min": -4.0, "episode_return_mean": -3.6, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 780.708770387186, "num_env_steps_trained_throughput_per_sec": 780.708770387186, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 5648.98, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5648.98, "sample_time_ms": 4701.409, "learn_time_ms": 917.498, "learn_throughput": 4359.682, "synch_weights_time_ms": 29.269}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "07611_00000", "date": "2024-09-11_17-40-49", "timestamp": 1726069249, "time_this_iter_s": 5.132533311843872, "time_total_s": 28.289335012435913, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE109B40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.289335012435913, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 57.714285714285715, "ram_util_percent": 93.48571428571428, "gpu_util_percent0": 0.015714285714285715, "vram_util_percent0": 0.1517333984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1236911652609706, "cur_kl_coeff": 0.00625, "cur_lr": 0.0003, "total_loss": 0.009026061798795126, "policy_loss": -0.0030567443711333906, "vf_loss": 0.02413783287629485, "vf_explained_var": 0.19842737317085266, "kl": 0.0037909944279817865, "entropy": 1.207872036099434, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 220.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -2.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.55, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.8875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -2.0, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -2.5, -4.0, -4.0, -2.0, -3.5, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -2.5, -2.5, -4.0, -3.5, -3.0, -4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -2.5, -3.5, -3.5, -4.0, -4.0, -3.0, -3.5, -2.5, -3.5, -4.0, -4.0, -4.0, -3.0, -3.5, -3.5, -4.0, -2.5, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.382148050689924, "mean_inference_ms": 5.300844938858529, "mean_action_processing_ms": 2.7303521401837947, "mean_env_wait_ms": 20.375851969374953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11769723892211914, "StateBufferConnector_ms": 0.032021284103393555, "ViewRequirementAgentConnector_ms": 0.6559915542602539}, "num_episodes": 32, "episode_return_max": -2.0, "episode_return_min": -4.0, "episode_return_mean": -3.55, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 780.3580586641979, "num_env_steps_trained_throughput_per_sec": 780.3580586641979, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 5561.792, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5561.792, "sample_time_ms": 4624.072, "learn_time_ms": 907.538, "learn_throughput": 4407.528, "synch_weights_time_ms": 29.345}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "07611_00000", "date": "2024-09-11_17-40-54", "timestamp": 1726069254, "time_this_iter_s": 5.134013414382935, "time_total_s": 33.42334842681885, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE109510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.42334842681885, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 56.92857142857144, "ram_util_percent": 93.54285714285713, "gpu_util_percent0": 0.015714285714285715, "vram_util_percent0": 0.1517333984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.111261629126966, "cur_kl_coeff": 0.003125, "cur_lr": 0.0003, "total_loss": 0.009953236949513666, "policy_loss": -0.0027070381795056163, "vf_loss": 0.02454416244290769, "vf_explained_var": 0.1285776063799858, "kl": 0.004351837582544249, "entropy": 1.1897486925125123, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 260.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -2.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.55, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.8875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -2.5, -2.5, -4.0, -3.5, -3.0, -4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -2.5, -3.5, -3.5, -4.0, -4.0, -3.0, -3.5, -2.5, -3.5, -4.0, -4.0, -4.0, -3.0, -3.5, -3.5, -4.0, -2.5, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -2.0, -4.0, -3.5, -3.0, -3.0, -4.0, -3.0, -3.5, -3.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -2.0, -4.0, -4.0, -4.0, -3.5, -4.0, -2.5, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.291937173275398, "mean_inference_ms": 5.212451908943018, "mean_action_processing_ms": 2.679079902514926, "mean_env_wait_ms": 19.9264617857711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11287617683410645, "StateBufferConnector_ms": 0.03212451934814453, "ViewRequirementAgentConnector_ms": 0.6569173336029053}, "num_episodes": 32, "episode_return_max": -2.0, "episode_return_min": -4.0, "episode_return_mean": -3.55, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 775.5681921930963, "num_env_steps_trained_throughput_per_sec": 775.5681921930963, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 5504.037, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5504.037, "sample_time_ms": 4571.337, "learn_time_ms": 902.437, "learn_throughput": 4432.441, "synch_weights_time_ms": 29.403}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "07611_00000", "date": "2024-09-11_17-40-59", "timestamp": 1726069259, "time_this_iter_s": 5.165682792663574, "time_total_s": 38.58903121948242, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE109AB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.58903121948242, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 64.76666666666667, "ram_util_percent": 93.58333333333333, "gpu_util_percent0": 0.049999999999999996, "vram_util_percent0": 0.15142822265625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.24348354171961545, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0003, "total_loss": 0.025304593972396105, "policy_loss": -0.003080619501633919, "vf_loss": 0.039944576751440766, "vf_explained_var": 0.04183170944452286, "kl": 0.0056688361562919455, "entropy": 1.1568221569061279, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -1.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.56, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -2.0, -4.0, -3.5, -3.0, -3.0, -4.0, -3.0, -3.5, -3.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -2.0, -4.0, -4.0, -4.0, -3.5, -4.0, -2.5, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -2.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -3.5, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -3.0, -4.0, -4.0, -2.0, -3.0, -4.0, -3.5, -3.5, -2.5, -4.0, -3.5, -3.5, -3.0, -3.5, -1.0, -2.5, -2.5, -3.0, -3.5, -4.0, -3.5, -4.0, -4.0, -2.5, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.171254507484326, "mean_inference_ms": 5.108153635097683, "mean_action_processing_ms": 2.623080350666362, "mean_env_wait_ms": 19.355788652665463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12353372573852539, "StateBufferConnector_ms": 0.04630732536315918, "ViewRequirementAgentConnector_ms": 0.5970458984375}, "num_episodes": 64, "episode_return_max": -1.0, "episode_return_min": -4.0, "episode_return_mean": -3.56, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 790.7311310283576, "num_env_steps_trained_throughput_per_sec": 790.7311310283576, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 5448.359, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5448.359, "sample_time_ms": 4516.599, "learn_time_ms": 901.529, "learn_throughput": 4436.906, "synch_weights_time_ms": 29.354}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "07611_00000", "date": "2024-09-11_17-41-04", "timestamp": 1726069264, "time_this_iter_s": 5.067792654037476, "time_total_s": 43.6568238735199, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10A0E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43.6568238735199, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 55.142857142857146, "ram_util_percent": 93.5, "gpu_util_percent0": 0.04, "vram_util_percent0": 0.14897809709821427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.08816705048084258, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0003, "total_loss": 0.006922472093174292, "policy_loss": -0.0021102629179949872, "vf_loss": 0.02023386205546558, "vf_explained_var": 0.059582915902137754, "kl": 0.002175487186650571, "entropy": 1.1204526335000993, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 340.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -1.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.6, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.5, -4.0, -4.0, -2.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -3.5, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -3.0, -4.0, -4.0, -2.0, -3.0, -4.0, -3.5, -3.5, -2.5, -4.0, -3.5, -3.5, -3.0, -3.5, -1.0, -2.5, -2.5, -3.0, -3.5, -4.0, -3.5, -4.0, -4.0, -2.5, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -2.0, -2.5, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -3.0, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -4.0, -1.5, -3.5, -4.0, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.144790165902759, "mean_inference_ms": 5.091361295133888, "mean_action_processing_ms": 2.612588476168226, "mean_env_wait_ms": 19.195950624387514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09864544868469238, "StateBufferConnector_ms": 0.0563507080078125, "ViewRequirementAgentConnector_ms": 0.6098988056182861}, "num_episodes": 32, "episode_return_max": -1.0, "episode_return_min": -4.0, "episode_return_mean": -3.6, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 749.8916655823913, "num_env_steps_trained_throughput_per_sec": 749.8916655823913, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 5435.664, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5435.664, "sample_time_ms": 4495.651, "learn_time_ms": 909.96, "learn_throughput": 4395.797, "synch_weights_time_ms": 29.159}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "07611_00000", "date": "2024-09-11_17-41-10", "timestamp": 1726069270, "time_this_iter_s": 5.347071886062622, "time_total_s": 49.00389575958252, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10AB90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.00389575958252, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 64.01428571428572, "ram_util_percent": 93.77142857142857, "gpu_util_percent0": 0.1285714285714286, "vram_util_percent0": 0.13694545200892858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11450706887990236, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0003, "total_loss": 0.009549184038769453, "policy_loss": -0.0031988013557565863, "vf_loss": 0.023745047207921744, "vf_explained_var": 0.06246767193078995, "kl": 0.005172251228395907, "entropy": 1.1001102447509765, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 380.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -1.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.485, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.87125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.5, -3.5, -2.5, -4.0, -3.5, -3.5, -3.0, -3.5, -1.0, -2.5, -2.5, -3.0, -3.5, -4.0, -3.5, -4.0, -4.0, -2.5, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -2.0, -2.5, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -3.0, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -4.0, -1.5, -3.5, -4.0, -4.0, -4.0, -2.0, -4.0, -2.5, -4.0, -3.5, -1.0, -3.0, -4.0, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -4.0, -3.0, -2.5, -2.5, -3.5, -2.5, -3.5, -4.0, -3.5, -2.0, -2.0, -2.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.16436511194068, "mean_inference_ms": 5.113995549461885, "mean_action_processing_ms": 2.6236130952777956, "mean_env_wait_ms": 19.22525662011119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09506583213806152, "StateBufferConnector_ms": 0.05347323417663574, "ViewRequirementAgentConnector_ms": 0.6481213569641113}, "num_episodes": 32, "episode_return_max": -1.0, "episode_return_min": -4.0, "episode_return_mean": -3.485, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 672.1130208974101, "num_env_steps_trained_throughput_per_sec": 672.1130208974101, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 5487.235, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5487.235, "sample_time_ms": 4545.985, "learn_time_ms": 911.362, "learn_throughput": 4389.036, "synch_weights_time_ms": 28.984}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "07611_00000", "date": "2024-09-11_17-41-16", "timestamp": 1726069276, "time_this_iter_s": 5.959712982177734, "time_total_s": 54.963608741760254, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10B1C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.963608741760254, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 76.2, "ram_util_percent": 94.44285714285715, "gpu_util_percent0": 0.1885714285714286, "vram_util_percent0": 0.13828822544642858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1030189024284482, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0003, "total_loss": 0.010255527566187084, "policy_loss": -0.002049274499586318, "vf_loss": 0.02263834639452398, "vf_explained_var": 0.07824375480413437, "kl": 0.0036260733358176368, "entropy": 1.033637797832489, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -1.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.445, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.86125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -2.0, -2.5, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -3.0, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -4.0, -1.5, -3.5, -4.0, -4.0, -4.0, -2.0, -4.0, -2.5, -4.0, -3.5, -1.0, -3.0, -4.0, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -4.0, -3.0, -2.5, -2.5, -3.5, -2.5, -3.5, -4.0, -3.5, -2.0, -2.0, -2.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -3.0, -3.5, -4.0, -2.5, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -2.0, -1.0, -4.0, -3.5, -2.0, -3.0, -4.0, -3.5, -3.5, -2.5, -3.0, -3.0, -2.5, -2.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.217476325030596, "mean_inference_ms": 5.130398555193378, "mean_action_processing_ms": 2.6307072094193886, "mean_env_wait_ms": 19.126591414248868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08916592597961426, "StateBufferConnector_ms": 0.046276092529296875, "ViewRequirementAgentConnector_ms": 0.6871676445007324}, "num_episodes": 32, "episode_return_max": -1.0, "episode_return_min": -4.0, "episode_return_mean": -3.445, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.9344072691536, "num_env_steps_trained_throughput_per_sec": 736.9344072691536, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 5361.011, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5361.011, "sample_time_ms": 4404.755, "learn_time_ms": 926.642, "learn_throughput": 4316.663, "synch_weights_time_ms": 28.609}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "07611_00000", "date": "2024-09-11_17-41-21", "timestamp": 1726069281, "time_this_iter_s": 5.436159372329712, "time_total_s": 60.399768114089966, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10BD90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 60.399768114089966, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 63.89999999999999, "ram_util_percent": 94.44285714285715, "gpu_util_percent0": 0.12428571428571429, "vram_util_percent0": 0.13664899553571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1835198387503624, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0003, "total_loss": 0.027607760441605934, "policy_loss": -0.0025349274670588783, "vf_loss": 0.03962038652971387, "vf_explained_var": 0.09722789376974106, "kl": 0.004467107937307447, "entropy": 0.9479444146156311, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 460.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -1.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.345, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.83625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -4.0, -4.0, -4.0, -3.5, -3.0, -3.5, -4.0, -2.5, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -2.0, -1.0, -4.0, -3.5, -2.0, -3.0, -4.0, -3.5, -3.5, -2.5, -3.0, -3.0, -2.5, -2.0, -4.0, -3.5, -1.5, -3.5, -2.5, -3.5, -3.5, -4.0, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -1.5, -4.0, -4.0, -4.0, -4.0, -3.5, -2.0, -3.5, -3.5, -2.0, -2.0, -2.0, -3.5, -3.5, -3.5, -3.5, -2.5, -2.5, -4.0, -3.5, -4.0, -3.5, -3.5, -2.5, -4.0, -3.0, -4.0, -3.5, -4.0, -3.5, -1.5, -3.0, -3.5, -3.5, -4.0, -4.0, -4.0, -3.0, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.272435450536875, "mean_inference_ms": 5.156604043109325, "mean_action_processing_ms": 2.642511767960193, "mean_env_wait_ms": 18.94113832890339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10181999206542969, "StateBufferConnector_ms": 0.03377389907836914, "ViewRequirementAgentConnector_ms": 0.7113902568817139}, "num_episodes": 64, "episode_return_max": -1.0, "episode_return_min": -4.0, "episode_return_mean": -3.345, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 775.3321749790862, "num_env_steps_trained_throughput_per_sec": 775.3321749790862, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 5295.367, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5295.367, "sample_time_ms": 4335.644, "learn_time_ms": 930.54, "learn_throughput": 4298.578, "synch_weights_time_ms": 28.179}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "07611_00000", "date": "2024-09-11_17-41-27", "timestamp": 1726069287, "time_this_iter_s": 5.212692022323608, "time_total_s": 65.61246013641357, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10AB90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.61246013641357, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 64.54285714285714, "ram_util_percent": 94.97142857142856, "gpu_util_percent0": 0.14142857142857143, "vram_util_percent0": 0.15483747209821427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10597874401137233, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0003, "total_loss": 0.008907355210976676, "policy_loss": -0.0014534451205690858, "vf_loss": 0.019765440467745067, "vf_explained_var": 0.2563096061348915, "kl": 0.0024543810334762385, "entropy": 0.9405119001865387, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 500.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": -1.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.3, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -2.5, -2.0, -4.0, -3.5, -1.5, -3.5, -2.5, -3.5, -3.5, -4.0, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -1.5, -4.0, -4.0, -4.0, -4.0, -3.5, -2.0, -3.5, -3.5, -2.0, -2.0, -2.0, -3.5, -3.5, -3.5, -3.5, -2.5, -2.5, -4.0, -3.5, -4.0, -3.5, -3.5, -2.5, -4.0, -3.0, -4.0, -3.5, -4.0, -3.5, -1.5, -3.0, -3.5, -3.5, -4.0, -4.0, -4.0, -3.0, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -2.0, -3.5, -2.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -4.0, -3.5, -2.0, -1.0, -3.5, -2.5, -3.5, -2.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.28382341648915, "mean_inference_ms": 5.163026660181104, "mean_action_processing_ms": 2.6450759579240017, "mean_env_wait_ms": 18.816656546974194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10419678688049316, "StateBufferConnector_ms": 0.03134632110595703, "ViewRequirementAgentConnector_ms": 0.7343161106109619}, "num_episodes": 32, "episode_return_max": -1.0, "episode_return_min": -4.0, "episode_return_mean": -3.3, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 777.6650177247122, "num_env_steps_trained_throughput_per_sec": 777.6650177247122, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 5268.169, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5268.169, "sample_time_ms": 4320.161, "learn_time_ms": 918.952, "learn_throughput": 4352.787, "synch_weights_time_ms": 28.052}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "07611_00000", "date": "2024-09-11_17-41-32", "timestamp": 1726069292, "time_this_iter_s": 5.151874542236328, "time_total_s": 70.7643346786499, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10AA70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.7643346786499, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 70.76666666666667, "ram_util_percent": 95.45, "gpu_util_percent0": 0.11166666666666668, "vram_util_percent0": 0.16963704427083334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11017719712108373, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0003, "total_loss": 0.01168432787576421, "policy_loss": -0.0016691260621882974, "vf_loss": 0.02324440125375986, "vf_explained_var": 0.3008386969566345, "kl": 0.00205150595043051, "entropy": 0.9891147509217262, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.3, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.5, -3.5, -2.5, -2.5, -4.0, -3.5, -4.0, -3.5, -3.5, -2.5, -4.0, -3.0, -4.0, -3.5, -4.0, -3.5, -1.5, -3.0, -3.5, -3.5, -4.0, -4.0, -4.0, -3.0, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -2.0, -3.5, -2.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -4.0, -3.5, -2.0, -1.0, -3.5, -2.5, -3.5, -2.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -1.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.5, -4.0, -2.5, -3.5, -3.0, -3.0, -3.5, -2.5, -3.5, -2.5, -3.0, -1.0, -3.5, -0.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.0, -3.5, -3.5, -3.5, -3.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.265570901480022, "mean_inference_ms": 5.165445020679429, "mean_action_processing_ms": 2.645920333779203, "mean_env_wait_ms": 18.74898136990537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11879253387451172, "StateBufferConnector_ms": 0.03635835647583008, "ViewRequirementAgentConnector_ms": 0.7288773059844971}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -3.3, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 785.4545999322094, "num_env_steps_trained_throughput_per_sec": 785.4545999322094, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 5257.417, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5257.417, "sample_time_ms": 4310.362, "learn_time_ms": 917.787, "learn_throughput": 4358.31, "synch_weights_time_ms": 28.164}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "07611_00000", "date": "2024-09-11_17-41-37", "timestamp": 1726069297, "time_this_iter_s": 5.101866960525513, "time_total_s": 75.86620163917542, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10BC70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 75.86620163917542, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 59.557142857142864, "ram_util_percent": 95.12857142857145, "gpu_util_percent0": 0.018571428571428572, "vram_util_percent0": 0.15452357700892858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12615797771140932, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0003, "total_loss": 0.0142547577037476, "policy_loss": -0.0027227064420003444, "vf_loss": 0.027309207059442998, "vf_explained_var": 0.2875764474272728, "kl": 0.004001412150410033, "entropy": 1.0331938177347184, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 580.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.14, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.5, -3.5, -2.0, -3.5, -2.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -4.0, -3.5, -2.0, -1.0, -3.5, -2.5, -3.5, -2.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -1.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.5, -4.0, -2.5, -3.5, -3.0, -3.0, -3.5, -2.5, -3.5, -2.5, -3.0, -1.0, -3.5, -0.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.0, -3.5, -3.0, -3.0, -3.5, -3.0, -3.5, -3.5, -3.5, -3.0, -1.0, -4.0, -3.5, -3.5, -3.0, -3.0, -3.5, -2.0, -2.5, -2.5, -4.0, -2.0, -3.5, -3.5, -3.5, -3.5, -1.0, -3.5, -2.0, -1.5, -3.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.270948686524667, "mean_inference_ms": 5.158953077665943, "mean_action_processing_ms": 2.645484936979967, "mean_env_wait_ms": 18.600037963324265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12085652351379395, "StateBufferConnector_ms": 0.04470324516296387, "ViewRequirementAgentConnector_ms": 0.673032283782959}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -3.14, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 772.151326640797, "num_env_steps_trained_throughput_per_sec": 772.151326640797, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 5263.095, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5263.095, "sample_time_ms": 4317.241, "learn_time_ms": 916.897, "learn_throughput": 4362.542, "synch_weights_time_ms": 27.955}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "07611_00000", "date": "2024-09-11_17-41-42", "timestamp": 1726069302, "time_this_iter_s": 5.190584897994995, "time_total_s": 81.05678653717041, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE109090>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81.05678653717041, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 61.357142857142854, "ram_util_percent": 95.02857142857142, "gpu_util_percent0": 0.045714285714285714, "vram_util_percent0": 0.14632742745535715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1549412991851568, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0003, "total_loss": 0.032560636373818855, "policy_loss": -0.0015634689800208435, "vf_loss": 0.04492664923891425, "vf_explained_var": 0.23379487544298172, "kl": 0.0020605641081601787, "entropy": 1.0802595019340515, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 620.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.805, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.70125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.5, -3.5, -3.5, -3.0, -3.0, -3.5, -3.0, -3.0, -3.5, -3.0, -3.5, -3.5, -3.5, -3.0, -1.0, -4.0, -3.5, -3.5, -3.0, -3.0, -3.5, -2.0, -2.5, -2.5, -4.0, -2.0, -3.5, -3.5, -3.5, -3.5, -1.0, -3.5, -2.0, -1.5, -3.0, -3.5, -4.0, -2.5, -3.0, -2.0, -3.5, -3.5, -2.5, -2.5, -1.0, -2.5, -3.0, -2.5, -3.0, -3.5, -1.0, -3.0, -4.0, -2.5, -3.5, -3.5, -1.5, -3.5, -3.0, -3.5, -3.5, -1.5, -3.5, -3.0, -3.0, -1.5, -3.0, -3.0, -3.0, -3.0, -2.0, -4.0, -3.5, -3.0, -3.0, -3.5, -2.5, -3.5, -3.0, -1.5, -3.5, -2.0, -2.0, -3.5, -3.0, -3.0, -1.5, -1.5, -0.5, -2.0, -2.0, -3.5, -1.5, -0.5, -1.5, -3.5, -2.0, -2.5, -3.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.240536706692133, "mean_inference_ms": 5.146941114661714, "mean_action_processing_ms": 2.6428627375198146, "mean_env_wait_ms": 18.46774906042073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12230348587036133, "StateBufferConnector_ms": 0.0483088493347168, "ViewRequirementAgentConnector_ms": 0.6179437637329102}, "num_episodes": 64, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -2.805, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 774.8387774635984, "num_env_steps_trained_throughput_per_sec": 774.8387774635984, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 5266.746, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5266.746, "sample_time_ms": 4321.439, "learn_time_ms": 916.349, "learn_throughput": 4365.148, "synch_weights_time_ms": 27.955}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "07611_00000", "date": "2024-09-11_17-41-47", "timestamp": 1726069307, "time_this_iter_s": 5.1726462841033936, "time_total_s": 86.2294328212738, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10AA70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.2294328212738, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 68.50000000000001, "ram_util_percent": 94.88333333333333, "gpu_util_percent0": 0.026666666666666672, "vram_util_percent0": 0.1455078125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12520745396614075, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0003, "total_loss": 0.01451903281849809, "policy_loss": -0.002125529307522811, "vf_loss": 0.027714816248044373, "vf_explained_var": 0.32087556570768355, "kl": 0.0024593283172180238, "entropy": 1.1070284515619278, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.575, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.64375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -2.0, -1.5, -3.0, -3.5, -4.0, -2.5, -3.0, -2.0, -3.5, -3.5, -2.5, -2.5, -1.0, -2.5, -3.0, -2.5, -3.0, -3.5, -1.0, -3.0, -4.0, -2.5, -3.5, -3.5, -1.5, -3.5, -3.0, -3.5, -3.5, -1.5, -3.5, -3.0, -3.0, -1.5, -3.0, -3.0, -3.0, -3.0, -2.0, -4.0, -3.5, -3.0, -3.0, -3.5, -2.5, -3.5, -3.0, -1.5, -3.5, -2.0, -2.0, -3.5, -3.0, -3.0, -1.5, -1.5, -0.5, -2.0, -2.0, -3.5, -1.5, -0.5, -1.5, -3.5, -2.0, -2.5, -3.0, -3.5, -3.5, -1.5, -3.5, -3.5, -2.5, -1.5, -1.5, -2.0, -3.0, -1.5, -2.5, -1.5, -2.5, -2.5, -3.0, -2.5, -2.0, -3.0, -1.5, -3.0, -2.0, -1.5, -2.0, -2.5, -2.5, -2.0, -3.0, -2.0, -3.5, -1.5, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.22834010415877, "mean_inference_ms": 5.1396411709679795, "mean_action_processing_ms": 2.6398205285956307, "mean_env_wait_ms": 18.45535961985637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11303043365478516, "StateBufferConnector_ms": 0.03948545455932617, "ViewRequirementAgentConnector_ms": 0.6006524562835693}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -2.575, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 756.4831511858804, "num_env_steps_trained_throughput_per_sec": 756.4831511858804, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 5279.758, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5279.758, "sample_time_ms": 4336.93, "learn_time_ms": 913.893, "learn_throughput": 4376.88, "synch_weights_time_ms": 27.932}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "07611_00000", "date": "2024-09-11_17-41-53", "timestamp": 1726069313, "time_this_iter_s": 5.2969279289245605, "time_total_s": 91.52636075019836, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE108700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 91.52636075019836, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 60.48571428571429, "ram_util_percent": 94.87142857142855, "gpu_util_percent0": 0.032857142857142856, "vram_util_percent0": 0.14540318080357142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11649619983509182, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0003, "total_loss": 0.017677366988209542, "policy_loss": -0.003055673042035778, "vf_loss": 0.03143799654208124, "vf_explained_var": 0.3236891314387321, "kl": 0.003887825657693611, "entropy": 1.0704980313777923, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 700.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.465, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.61625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -3.0, -1.5, -3.0, -3.0, -3.0, -3.0, -2.0, -4.0, -3.5, -3.0, -3.0, -3.5, -2.5, -3.5, -3.0, -1.5, -3.5, -2.0, -2.0, -3.5, -3.0, -3.0, -1.5, -1.5, -0.5, -2.0, -2.0, -3.5, -1.5, -0.5, -1.5, -3.5, -2.0, -2.5, -3.0, -3.5, -3.5, -1.5, -3.5, -3.5, -2.5, -1.5, -1.5, -2.0, -3.0, -1.5, -2.5, -1.5, -2.5, -2.5, -3.0, -2.5, -2.0, -3.0, -1.5, -3.0, -2.0, -1.5, -2.0, -2.5, -2.5, -2.0, -3.0, -2.0, -3.5, -1.5, -2.0, -1.5, -4.0, -3.5, -2.5, -3.5, -2.0, -3.0, -2.5, -0.5, -1.5, -1.5, -3.5, -3.0, -2.0, -3.0, -3.0, -1.0, -2.0, -4.0, -0.5, -3.5, -3.0, -2.0, -3.0, -1.0, -2.0, -3.0, -2.5, -2.0, -3.0, -2.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.215704521670178, "mean_inference_ms": 5.139758654698077, "mean_action_processing_ms": 2.6749273982134656, "mean_env_wait_ms": 18.492161229260233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11799955368041992, "StateBufferConnector_ms": 0.04642653465270996, "ViewRequirementAgentConnector_ms": 0.6235253810882568}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -2.465, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 710.2499169508949, "num_env_steps_trained_throughput_per_sec": 710.2499169508949, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 5337.079, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5337.079, "sample_time_ms": 4395.811, "learn_time_ms": 912.571, "learn_throughput": 4383.222, "synch_weights_time_ms": 27.694}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "07611_00000", "date": "2024-09-11_17-41-58", "timestamp": 1726069318, "time_this_iter_s": 5.640967130661011, "time_total_s": 97.16732788085938, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE164CA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 97.16732788085938, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 65.77142857142857, "ram_util_percent": 94.62857142857145, "gpu_util_percent0": 0.05142857142857143, "vram_util_percent0": 0.14503696986607142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10052479365840554, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0003, "total_loss": 0.015948798429235467, "policy_loss": -0.002588089174241759, "vf_loss": 0.028963724663481117, "vf_explained_var": 0.321678401529789, "kl": 0.00322016012369204, "entropy": 1.0426846355199815, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 740.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.415, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.60375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -2.0, -2.5, -3.0, -3.5, -3.5, -1.5, -3.5, -3.5, -2.5, -1.5, -1.5, -2.0, -3.0, -1.5, -2.5, -1.5, -2.5, -2.5, -3.0, -2.5, -2.0, -3.0, -1.5, -3.0, -2.0, -1.5, -2.0, -2.5, -2.5, -2.0, -3.0, -2.0, -3.5, -1.5, -2.0, -1.5, -4.0, -3.5, -2.5, -3.5, -2.0, -3.0, -2.5, -0.5, -1.5, -1.5, -3.5, -3.0, -2.0, -3.0, -3.0, -1.0, -2.0, -4.0, -0.5, -3.5, -3.0, -2.0, -3.0, -1.0, -2.0, -3.0, -2.5, -2.0, -3.0, -2.5, -3.5, -3.0, -4.0, -3.0, -2.0, -2.0, -2.0, -3.5, -2.0, -1.5, -2.5, -0.5, -2.0, -2.5, -3.0, -3.5, -3.0, -2.0, -3.0, -3.5, -1.5, -1.5, -3.0, -1.0, -3.0, -2.5, -1.0, -1.5, -3.5, -1.0, -2.0, -3.5, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.2157294345396, "mean_inference_ms": 5.131996044647784, "mean_action_processing_ms": 2.706474434073746, "mean_env_wait_ms": 18.482358663094715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10222268104553223, "StateBufferConnector_ms": 0.03644919395446777, "ViewRequirementAgentConnector_ms": 0.6482803821563721}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -2.415, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 745.0515460941697, "num_env_steps_trained_throughput_per_sec": 745.0515460941697, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 5340.544, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5340.544, "sample_time_ms": 4410.597, "learn_time_ms": 900.633, "learn_throughput": 4441.322, "synch_weights_time_ms": 28.312}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "07611_00000", "date": "2024-09-11_17-42-04", "timestamp": 1726069324, "time_this_iter_s": 5.378957986831665, "time_total_s": 102.54628586769104, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10AA70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 102.54628586769104, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 64.54285714285714, "ram_util_percent": 94.1857142857143, "gpu_util_percent0": 0.05857142857142857, "vram_util_percent0": 0.13882882254464285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16328674275428057, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0003, "total_loss": 0.03369333901209757, "policy_loss": -0.0031661849527154116, "vf_loss": 0.047094080876559016, "vf_explained_var": 0.2806872665882111, "kl": 0.004023019011174256, "entropy": 1.0234562367200852, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.285, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.57125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -3.0, -2.5, -3.5, -3.0, -4.0, -3.0, -2.0, -2.0, -2.0, -3.5, -2.0, -1.5, -2.5, -0.5, -2.0, -2.5, -3.0, -3.5, -3.0, -2.0, -3.0, -3.5, -1.5, -1.5, -3.0, -1.0, -3.0, -2.5, -1.0, -1.5, -3.5, -1.0, -2.0, -3.5, -2.0, -1.0, -2.0, -2.5, -3.5, -3.0, -4.0, -3.5, -2.0, -1.5, -1.5, -2.0, -1.5, -1.0, -0.5, -3.0, -3.5, -1.5, -2.0, -2.5, -1.0, -2.0, -2.0, -2.5, -2.5, -1.5, -3.0, -1.5, -3.5, -1.5, -3.0, -1.0, -2.0, -2.5, -0.5, -2.0, -4.0, -2.0, -1.5, -3.0, -2.5, -2.0, -1.0, -1.5, -3.5, -1.5, -2.0, -3.0, -2.0, -4.0, -2.5, -3.0, -2.0, -2.0, -2.5, -3.0, -2.0, -3.0, -0.5, -2.5, -2.5, -1.0, -2.0, -3.0, -3.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.209464309218568, "mean_inference_ms": 5.1293957188297625, "mean_action_processing_ms": 2.7362646839388676, "mean_env_wait_ms": 18.49635693180948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0790400505065918, "StateBufferConnector_ms": 0.02851104736328125, "ViewRequirementAgentConnector_ms": 0.6725621223449707}, "num_episodes": 64, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -2.285, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 767.3534705111509, "num_env_steps_trained_throughput_per_sec": 767.3534705111509, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 5266.679, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5266.679, "sample_time_ms": 4343.758, "learn_time_ms": 893.266, "learn_throughput": 4477.949, "synch_weights_time_ms": 28.651}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "07611_00000", "date": "2024-09-11_17-42-09", "timestamp": 1726069329, "time_this_iter_s": 5.222872495651245, "time_total_s": 107.76915836334229, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE1657E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 107.76915836334229, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 61.38571428571429, "ram_util_percent": 94.15714285714286, "gpu_util_percent0": 0.015714285714285715, "vram_util_percent0": 0.1317138671875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12024683058261872, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0003, "total_loss": 0.015157037106109782, "policy_loss": -0.0027585860269027764, "vf_loss": 0.027969642402604224, "vf_explained_var": 0.41960290670394895, "kl": 0.003924349574936059, "entropy": 1.0054022461175918, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 820.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.21, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.5525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -2.0, -3.5, -2.0, -1.0, -2.0, -2.5, -3.5, -3.0, -4.0, -3.5, -2.0, -1.5, -1.5, -2.0, -1.5, -1.0, -0.5, -3.0, -3.5, -1.5, -2.0, -2.5, -1.0, -2.0, -2.0, -2.5, -2.5, -1.5, -3.0, -1.5, -3.5, -1.5, -3.0, -1.0, -2.0, -2.5, -0.5, -2.0, -4.0, -2.0, -1.5, -3.0, -2.5, -2.0, -1.0, -1.5, -3.5, -1.5, -2.0, -3.0, -2.0, -4.0, -2.5, -3.0, -2.0, -2.0, -2.5, -3.0, -2.0, -3.0, -0.5, -2.5, -2.5, -1.0, -2.0, -3.0, -3.0, -2.0, -3.0, -2.0, -1.0, -1.0, -2.5, -1.5, -1.0, -1.5, -3.0, -2.5, -2.0, -2.0, -2.0, -4.0, -2.0, -0.5, -3.0, -3.5, -2.5, -3.5, -1.0, -1.0, -4.0, -1.0, -2.5, -3.0, -0.5, -2.0, -2.0, -4.0, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.212624793821057, "mean_inference_ms": 5.126591584147539, "mean_action_processing_ms": 2.7325437592831268, "mean_env_wait_ms": 18.499497566482237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09223604202270508, "StateBufferConnector_ms": 0.03453421592712402, "ViewRequirementAgentConnector_ms": 0.6839478015899658}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -2.21, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 738.2110398376265, "num_env_steps_trained_throughput_per_sec": 738.2110398376265, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 5265.74, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5265.74, "sample_time_ms": 4368.245, "learn_time_ms": 867.851, "learn_throughput": 4609.087, "synch_weights_time_ms": 28.64}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "07611_00000", "date": "2024-09-11_17-42-14", "timestamp": 1726069334, "time_this_iter_s": 5.426736116409302, "time_total_s": 113.19589447975159, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE109090>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 113.19589447975159, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 66.12857142857143, "ram_util_percent": 93.91428571428571, "gpu_util_percent0": 0.05142857142857143, "vram_util_percent0": 0.13567243303571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11423496343195438, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0003, "total_loss": 0.01805707149906084, "policy_loss": -0.002332465945437434, "vf_loss": 0.03040212611667812, "vf_explained_var": 0.4182154029607773, "kl": 0.004090689927306812, "entropy": 1.001258985698223, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 860.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.26, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5, -3.0, -1.0, -2.0, -2.5, -0.5, -2.0, -4.0, -2.0, -1.5, -3.0, -2.5, -2.0, -1.0, -1.5, -3.5, -1.5, -2.0, -3.0, -2.0, -4.0, -2.5, -3.0, -2.0, -2.0, -2.5, -3.0, -2.0, -3.0, -0.5, -2.5, -2.5, -1.0, -2.0, -3.0, -3.0, -2.0, -3.0, -2.0, -1.0, -1.0, -2.5, -1.5, -1.0, -1.5, -3.0, -2.5, -2.0, -2.0, -2.0, -4.0, -2.0, -0.5, -3.0, -3.5, -2.5, -3.5, -1.0, -1.0, -4.0, -1.0, -2.5, -3.0, -0.5, -2.0, -2.0, -4.0, -3.5, -2.0, -2.0, -3.5, -2.5, -1.5, -2.0, -3.5, -3.5, -3.0, -4.0, -4.0, -3.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -2.0, -0.5, -2.0, -2.0, -2.5, -4.0, -2.0, -2.0, -2.5, -3.5, -3.0, -1.5, -4.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.207583928183531, "mean_inference_ms": 5.12903831965668, "mean_action_processing_ms": 2.729975697551538, "mean_env_wait_ms": 18.53963500663017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12275171279907227, "StateBufferConnector_ms": 0.02852654457092285, "ViewRequirementAgentConnector_ms": 0.6674442291259766}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -2.26, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 749.1963111990211, "num_env_steps_trained_throughput_per_sec": 749.1963111990211, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 5283.748, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5283.737, "sample_time_ms": 4390.491, "learn_time_ms": 863.069, "learn_throughput": 4634.626, "synch_weights_time_ms": 29.173}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "07611_00000", "date": "2024-09-11_17-42-20", "timestamp": 1726069340, "time_this_iter_s": 5.348268747329712, "time_total_s": 118.5441632270813, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE108D30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 118.5441632270813, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 64.17142857142856, "ram_util_percent": 93.79999999999998, "gpu_util_percent0": 0.051428571428571435, "vram_util_percent0": 0.146240234375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10219879131764173, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0003, "total_loss": 0.01579928417413612, "policy_loss": -0.0027424230123870076, "vf_loss": 0.02838271567597985, "vf_explained_var": 0.45412690490484237, "kl": 0.004077943417178176, "entropy": 0.9841009318828583, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.195, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.54875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -2.0, -3.0, -3.0, -2.0, -3.0, -2.0, -1.0, -1.0, -2.5, -1.5, -1.0, -1.5, -3.0, -2.5, -2.0, -2.0, -2.0, -4.0, -2.0, -0.5, -3.0, -3.5, -2.5, -3.5, -1.0, -1.0, -4.0, -1.0, -2.5, -3.0, -0.5, -2.0, -2.0, -4.0, -3.5, -2.0, -2.0, -3.5, -2.5, -1.5, -2.0, -3.5, -3.5, -3.0, -4.0, -4.0, -3.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -2.0, -0.5, -2.0, -2.0, -2.5, -4.0, -2.0, -2.0, -2.5, -3.5, -3.0, -1.5, -4.0, -1.0, -1.0, -2.0, -2.0, -2.0, -2.5, -2.0, -3.0, -0.5, -2.0, -1.0, -1.5, -2.5, -2.5, -2.0, -3.0, -1.5, -2.0, -2.5, -3.0, -1.0, -2.0, -3.0, -2.5, -1.5, -3.0, -3.0, -2.0, -2.0, -1.0, -2.5, -2.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.21720508190661, "mean_inference_ms": 5.121675655957701, "mean_action_processing_ms": 2.7266780952209366, "mean_env_wait_ms": 18.513890856296268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12155866622924805, "StateBufferConnector_ms": 0.03525900840759277, "ViewRequirementAgentConnector_ms": 0.6754562854766846}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -2.195, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 762.9705946087046, "num_env_steps_trained_throughput_per_sec": 762.9705946087046, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 5293.654, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5293.644, "sample_time_ms": 4399.28, "learn_time_ms": 863.76, "learn_throughput": 4630.918, "synch_weights_time_ms": 29.6}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "07611_00000", "date": "2024-09-11_17-42-25", "timestamp": 1726069345, "time_this_iter_s": 5.250915288925171, "time_total_s": 123.79507851600647, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE109360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 123.79507851600647, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 62.47142857142858, "ram_util_percent": 93.74285714285715, "gpu_util_percent0": 0.027142857142857142, "vram_util_percent0": 0.14615304129464285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1837924974039197, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0003, "total_loss": 0.03818818628787994, "policy_loss": -0.0016650787641992793, "vf_loss": 0.049252666719257834, "vf_explained_var": 0.30648202896118165, "kl": 0.0022090215585194527, "entropy": 0.939940319955349, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 940.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.275, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.56875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -1.5, -4.0, -1.0, -1.0, -2.0, -2.0, -2.0, -2.5, -2.0, -3.0, -0.5, -2.0, -1.0, -1.5, -2.5, -2.5, -2.0, -3.0, -1.5, -2.0, -2.5, -3.0, -1.0, -2.0, -3.0, -2.5, -1.5, -3.0, -3.0, -2.0, -2.0, -1.0, -2.5, -2.0, -1.0, -1.5, -2.0, -3.5, -2.0, -4.0, -3.5, -3.0, -3.5, -0.5, -4.0, -2.0, -2.0, -3.0, -1.0, -3.5, -2.0, -3.5, -2.0, -2.0, -3.5, -3.0, -3.5, -2.0, -2.0, -2.0, -3.5, -0.5, -3.5, -3.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.5, -1.0, -0.5, -2.5, -3.0, -2.0, -3.0, -4.0, -0.5, -2.0, -2.0, -2.0, -2.0, -3.0, -4.0, -2.0, -2.0, -2.5, -3.5, -1.0, -4.0, -2.0, -1.5, -2.0, -1.0, -2.0, -4.0, -3.0, -2.0, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.216230827068644, "mean_inference_ms": 5.1215329493786665, "mean_action_processing_ms": 2.7220156653093635, "mean_env_wait_ms": 18.52507621256943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10892343521118164, "StateBufferConnector_ms": 0.04578208923339844, "ViewRequirementAgentConnector_ms": 0.7052805423736572}, "num_episodes": 64, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -2.275, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 736.3953942456205, "num_env_steps_trained_throughput_per_sec": 736.3953942456205, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 5327.581, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5327.571, "sample_time_ms": 4433.545, "learn_time_ms": 863.739, "learn_throughput": 4631.026, "synch_weights_time_ms": 29.382}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "07611_00000", "date": "2024-09-11_17-42-31", "timestamp": 1726069351, "time_this_iter_s": 5.44108772277832, "time_total_s": 129.2361662387848, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10BBE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 129.2361662387848, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 67.47142857142856, "ram_util_percent": 93.70000000000002, "gpu_util_percent0": 0.05, "vram_util_percent0": 0.14573451450892858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11643119510263204, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0003, "total_loss": 0.018419050335069187, "policy_loss": -0.002274167574068997, "vf_loss": 0.03014882137067616, "vf_explained_var": 0.43046954125165937, "kl": 0.002961341871332479, "entropy": 0.9455603688955307, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 980.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.27, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.5675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -2.5, -2.0, -1.0, -1.5, -2.0, -3.5, -2.0, -4.0, -3.5, -3.0, -3.5, -0.5, -4.0, -2.0, -2.0, -3.0, -1.0, -3.5, -2.0, -3.5, -2.0, -2.0, -3.5, -3.0, -3.5, -2.0, -2.0, -2.0, -3.5, -0.5, -3.5, -3.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.5, -1.0, -0.5, -2.5, -3.0, -2.0, -3.0, -4.0, -0.5, -2.0, -2.0, -2.0, -2.0, -3.0, -4.0, -2.0, -2.0, -2.5, -3.5, -1.0, -4.0, -2.0, -1.5, -2.0, -1.0, -2.0, -4.0, -3.0, -2.0, -3.5, -1.0, -2.0, -2.5, -0.5, -1.5, -2.0, -0.5, -2.5, -4.0, -0.5, -2.5, -1.5, -1.5, -2.5, -2.5, -3.5, -4.0, -2.0, -3.0, -2.0, 0.5, -0.5, -2.0, -3.5, -4.0, -2.0, -3.5, -2.5, -0.5, -1.5, -4.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.234603869251336, "mean_inference_ms": 5.132528446552396, "mean_action_processing_ms": 2.7264148209685497, "mean_env_wait_ms": 18.571487172074757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12085223197937012, "StateBufferConnector_ms": 0.054754018783569336, "ViewRequirementAgentConnector_ms": 0.7059726715087891}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -4.0, "episode_return_mean": -2.27, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 649.4413567850245, "num_env_steps_trained_throughput_per_sec": 649.4413567850245, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 5425.462, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5425.452, "sample_time_ms": 4520.831, "learn_time_ms": 873.816, "learn_throughput": 4577.622, "synch_weights_time_ms": 29.873}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "07611_00000", "date": "2024-09-11_17-42-37", "timestamp": 1726069357, "time_this_iter_s": 6.167142152786255, "time_total_s": 135.40330839157104, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10A0E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 135.40330839157104, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 72.8875, "ram_util_percent": 94.16250000000001, "gpu_util_percent0": 0.0675, "vram_util_percent0": 0.1484527587890625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11183976167812944, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0003, "total_loss": 0.021729054000752514, "policy_loss": -0.0018414907273836434, "vf_loss": 0.032970415381714704, "vf_explained_var": 0.42383253425359724, "kl": 0.0021908462246756242, "entropy": 0.9399870321154594, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.155, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.53875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.5, -1.0, -0.5, -2.5, -3.0, -2.0, -3.0, -4.0, -0.5, -2.0, -2.0, -2.0, -2.0, -3.0, -4.0, -2.0, -2.0, -2.5, -3.5, -1.0, -4.0, -2.0, -1.5, -2.0, -1.0, -2.0, -4.0, -3.0, -2.0, -3.5, -1.0, -2.0, -2.5, -0.5, -1.5, -2.0, -0.5, -2.5, -4.0, -0.5, -2.5, -1.5, -1.5, -2.5, -2.5, -3.5, -4.0, -2.0, -3.0, -2.0, 0.5, -0.5, -2.0, -3.5, -4.0, -2.0, -3.5, -2.5, -0.5, -1.5, -4.0, -2.0, -3.0, -4.0, -1.5, -2.0, -1.5, -2.0, -0.5, -1.5, -3.0, -3.5, -2.0, 0.5, -0.5, -3.0, -0.5, -2.0, -2.5, -3.5, -1.5, -1.0, -3.5, -2.5, -1.5, -1.5, -2.0, -3.5, -3.5, -0.5, -2.0, -3.0, -1.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.249718323577989, "mean_inference_ms": 5.15121893312128, "mean_action_processing_ms": 2.73319652946333, "mean_env_wait_ms": 18.657003418796037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12949442863464355, "StateBufferConnector_ms": 0.05166816711425781, "ViewRequirementAgentConnector_ms": 0.7070631980895996}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -4.0, "episode_return_mean": -2.155, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 707.2959396120298, "num_env_steps_trained_throughput_per_sec": 707.2959396120298, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 5474.76, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5474.749, "sample_time_ms": 4567.91, "learn_time_ms": 876.045, "learn_throughput": 4565.976, "synch_weights_time_ms": 29.863}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "07611_00000", "date": "2024-09-11_17-42-43", "timestamp": 1726069363, "time_this_iter_s": 5.667603969573975, "time_total_s": 141.07091236114502, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE164160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 141.07091236114502, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 71.85714285714285, "ram_util_percent": 88.20000000000002, "gpu_util_percent0": 0.07428571428571429, "vram_util_percent0": 0.14346749441964285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09362241737544537, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0003, "total_loss": 0.020032587097375654, "policy_loss": -0.0015688331426645164, "vf_loss": 0.031080737104639412, "vf_explained_var": 0.4557827591896057, "kl": 0.002060655865625449, "entropy": 0.9479315906763077, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1060.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.13, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.5325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.0, -2.0, -3.5, -1.0, -2.0, -2.5, -0.5, -1.5, -2.0, -0.5, -2.5, -4.0, -0.5, -2.5, -1.5, -1.5, -2.5, -2.5, -3.5, -4.0, -2.0, -3.0, -2.0, 0.5, -0.5, -2.0, -3.5, -4.0, -2.0, -3.5, -2.5, -0.5, -1.5, -4.0, -2.0, -3.0, -4.0, -1.5, -2.0, -1.5, -2.0, -0.5, -1.5, -3.0, -3.5, -2.0, 0.5, -0.5, -3.0, -0.5, -2.0, -2.5, -3.5, -1.5, -1.0, -3.5, -2.5, -1.5, -1.5, -2.0, -3.5, -3.5, -0.5, -2.0, -3.0, -1.5, -3.5, -1.0, -0.5, -1.0, -2.0, -2.5, -3.0, -2.0, -3.0, -1.5, -4.0, -2.0, -2.0, -2.0, -3.0, -0.5, -3.0, -1.5, -2.0, -1.5, -3.0, -1.5, -1.0, -2.0, -1.0, -2.0, -2.0, -3.5, -1.5, -3.0, -2.0, -3.0, -2.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.27702761850184, "mean_inference_ms": 5.159839601601234, "mean_action_processing_ms": 2.738307626713616, "mean_env_wait_ms": 18.686454296167295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1263425350189209, "StateBufferConnector_ms": 0.04124021530151367, "ViewRequirementAgentConnector_ms": 0.6505546569824219}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -4.0, "episode_return_mean": -2.13, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 747.1463114707192, "num_env_steps_trained_throughput_per_sec": 747.1463114707192, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 5481.368, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5481.345, "sample_time_ms": 4569.626, "learn_time_ms": 880.91, "learn_throughput": 4540.759, "synch_weights_time_ms": 29.878}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "07611_00000", "date": "2024-09-11_17-42-48", "timestamp": 1726069368, "time_this_iter_s": 5.362924814224243, "time_total_s": 146.43383717536926, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10BBE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 146.43383717536926, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 63.34285714285714, "ram_util_percent": 87.60000000000001, "gpu_util_percent0": 0.049999999999999996, "vram_util_percent0": 0.13671875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11988789774477482, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0003, "total_loss": 0.034357595461187884, "policy_loss": -0.001941829671159212, "vf_loss": 0.045602398365736006, "vf_explained_var": 0.41520421057939527, "kl": 0.0027228973222918284, "entropy": 0.9302974075078965, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1100.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -4.0, "episode_reward_mean": -1.745, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.43625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -3.0, -1.5, -3.5, -1.0, -0.5, -1.0, -2.0, -2.5, -3.0, -2.0, -3.0, -1.5, -4.0, -2.0, -2.0, -2.0, -3.0, -0.5, -3.0, -1.5, -2.0, -1.5, -3.0, -1.5, -1.0, -2.0, -1.0, -2.0, -2.0, -3.5, -1.5, -3.0, -2.0, -3.0, -2.5, -2.0, -2.5, -2.0, -2.0, -1.5, -2.0, -2.0, -1.5, -2.0, -0.5, 0.5, -1.5, -0.5, -1.0, -2.0, -2.0, -2.0, -2.0, -2.0, -1.0, -0.5, -3.5, -2.0, -1.0, -2.0, -2.0, -3.0, -0.5, -1.5, -1.5, -0.5, 0.5, -1.5, -1.0, -2.0, -1.0, -2.0, -2.0, 0.5, -2.5, -4.0, -1.5, -0.5, -2.0, -0.5, -0.5, -4.0, -1.5, -3.5, -2.0, -0.5, -2.5, -2.0, -2.0, -1.5, -2.0, -1.5, -0.5, -0.5, 0.5, -0.5, -1.0, -2.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.286396795651969, "mean_inference_ms": 5.161463381668783, "mean_action_processing_ms": 2.7366680622961708, "mean_env_wait_ms": 18.69669238827238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12306046485900879, "StateBufferConnector_ms": 0.033625125885009766, "ViewRequirementAgentConnector_ms": 0.6526412963867188}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -4.0, "episode_return_mean": -1.745, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 755.9190556598784, "num_env_steps_trained_throughput_per_sec": 755.9190556598784, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 5447.343, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5447.32, "sample_time_ms": 4535.894, "learn_time_ms": 880.624, "learn_throughput": 4542.232, "synch_weights_time_ms": 29.97}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "07611_00000", "date": "2024-09-11_17-42-53", "timestamp": 1726069373, "time_this_iter_s": 5.3007261753082275, "time_total_s": 151.7345633506775, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE167010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 151.7345633506775, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 63.6, "ram_util_percent": 87.68571428571427, "gpu_util_percent0": 0.02142857142857143, "vram_util_percent0": 0.13671875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13164499681442976, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0003, "total_loss": 0.018941669426567387, "policy_loss": -0.0023280541572603397, "vf_loss": 0.0307173574808985, "vf_explained_var": 0.5479712292551995, "kl": 0.00284988639441508, "entropy": 0.9447633445262908, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -4.0, "episode_reward_mean": -1.55, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.3875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -2.0, -3.0, -2.5, -2.0, -2.5, -2.0, -2.0, -1.5, -2.0, -2.0, -1.5, -2.0, -0.5, 0.5, -1.5, -0.5, -1.0, -2.0, -2.0, -2.0, -2.0, -2.0, -1.0, -0.5, -3.5, -2.0, -1.0, -2.0, -2.0, -3.0, -0.5, -1.5, -1.5, -0.5, 0.5, -1.5, -1.0, -2.0, -1.0, -2.0, -2.0, 0.5, -2.5, -4.0, -1.5, -0.5, -2.0, -0.5, -0.5, -4.0, -1.5, -3.5, -2.0, -0.5, -2.5, -2.0, -2.0, -1.5, -2.0, -1.5, -0.5, -0.5, 0.5, -0.5, -1.0, -2.0, -2.0, -1.5, -0.5, -1.5, -3.0, -1.5, -1.5, -2.5, -2.5, -1.0, -2.0, 0.5, -1.5, -3.5, -3.0, -1.0, 0.5, -2.0, -0.5, -2.0, -0.5, -3.0, -0.5, -1.5, -1.0, -1.0, 0.5, -0.5, -1.5, -1.5, -1.5, -3.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.285914501896185, "mean_inference_ms": 5.157671655863376, "mean_action_processing_ms": 2.7337541213656498, "mean_env_wait_ms": 18.68732403910195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12440896034240723, "StateBufferConnector_ms": 0.03687238693237305, "ViewRequirementAgentConnector_ms": 0.6765635013580322}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -4.0, "episode_return_mean": -1.55, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 755.1935146650687, "num_env_steps_trained_throughput_per_sec": 755.1935146650687, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 5440.133, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5440.11, "sample_time_ms": 4525.317, "learn_time_ms": 884.402, "learn_throughput": 4522.83, "synch_weights_time_ms": 29.561}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "07611_00000", "date": "2024-09-11_17-42-59", "timestamp": 1726069379, "time_this_iter_s": 5.309784650802612, "time_total_s": 157.0443480014801, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE166F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.0443480014801, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 62.885714285714286, "ram_util_percent": 87.71428571428571, "gpu_util_percent0": 0.04428571428571428, "vram_util_percent0": 0.13602120535714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11268597561866045, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0003, "total_loss": 0.01761075400208938, "policy_loss": -0.0021769417697214523, "vf_loss": 0.02902223328128457, "vf_explained_var": 0.5601591482758522, "kl": 0.0023212094045447886, "entropy": 0.9234537228941917, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1180.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -4.0, "episode_reward_mean": -1.445, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.36125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5, -1.5, -0.5, 0.5, -1.5, -1.0, -2.0, -1.0, -2.0, -2.0, 0.5, -2.5, -4.0, -1.5, -0.5, -2.0, -0.5, -0.5, -4.0, -1.5, -3.5, -2.0, -0.5, -2.5, -2.0, -2.0, -1.5, -2.0, -1.5, -0.5, -0.5, 0.5, -0.5, -1.0, -2.0, -2.0, -1.5, -0.5, -1.5, -3.0, -1.5, -1.5, -2.5, -2.5, -1.0, -2.0, 0.5, -1.5, -3.5, -3.0, -1.0, 0.5, -2.0, -0.5, -2.0, -0.5, -3.0, -0.5, -1.5, -1.0, -1.0, 0.5, -0.5, -1.5, -1.5, -1.5, -3.5, -0.5, -0.5, -1.0, -2.5, -2.5, -2.0, -2.0, -2.0, -1.0, -2.0, -1.0, 0.5, -2.0, -2.0, -1.5, 0.5, 0.5, 0.5, -3.0, -3.0, 0.5, -1.5, -2.0, -1.5, -2.0, -0.5, -1.5, -3.0, -1.5, -2.0, -1.0, -2.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.281046783002418, "mean_inference_ms": 5.164957158823066, "mean_action_processing_ms": 2.732905155441972, "mean_env_wait_ms": 18.731462820366644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12940335273742676, "StateBufferConnector_ms": 0.03742218017578125, "ViewRequirementAgentConnector_ms": 0.6974728107452393}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -4.0, "episode_return_mean": -1.445, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 698.7514845726888, "num_env_steps_trained_throughput_per_sec": 698.7514845726888, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 5491.31, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5491.287, "sample_time_ms": 4578.011, "learn_time_ms": 882.958, "learn_throughput": 4530.229, "synch_weights_time_ms": 29.489}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "07611_00000", "date": "2024-09-11_17-43-04", "timestamp": 1726069384, "time_this_iter_s": 5.7357096672058105, "time_total_s": 162.7800576686859, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE0184C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 162.7800576686859, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 71.82857142857141, "ram_util_percent": 87.94285714285715, "gpu_util_percent0": 0.09142857142857143, "vram_util_percent0": 0.1475830078125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12402568701654673, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0003, "total_loss": 0.017336073715705426, "policy_loss": -0.002020726472255774, "vf_loss": 0.028456832747906446, "vf_explained_var": 0.5783473014831543, "kl": 0.0029817191596976044, "entropy": 0.9100032776594162, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1220.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.36, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -1.0, -2.0, -2.0, -1.5, -0.5, -1.5, -3.0, -1.5, -1.5, -2.5, -2.5, -1.0, -2.0, 0.5, -1.5, -3.5, -3.0, -1.0, 0.5, -2.0, -0.5, -2.0, -0.5, -3.0, -0.5, -1.5, -1.0, -1.0, 0.5, -0.5, -1.5, -1.5, -1.5, -3.5, -0.5, -0.5, -1.0, -2.5, -2.5, -2.0, -2.0, -2.0, -1.0, -2.0, -1.0, 0.5, -2.0, -2.0, -1.5, 0.5, 0.5, 0.5, -3.0, -3.0, 0.5, -1.5, -2.0, -1.5, -2.0, -0.5, -1.5, -3.0, -1.5, -2.0, -1.0, -2.0, -2.0, -1.0, -2.0, 0.5, -2.0, -2.0, -2.0, -1.5, -0.5, -1.5, -2.0, -0.5, 0.5, -0.5, -2.5, -1.0, -2.0, 0.5, -1.5, -2.0, -1.5, -1.0, -2.5, -1.0, -0.5, -1.5, -0.5, -2.0, -1.0, -2.0, -0.5, 0.5, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.293478942442546, "mean_inference_ms": 5.163042830548196, "mean_action_processing_ms": 2.7344357582333383, "mean_env_wait_ms": 18.723035422231124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12654638290405273, "StateBufferConnector_ms": 0.053502798080444336, "ViewRequirementAgentConnector_ms": 0.714759349822998}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.36, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 742.6648021122802, "num_env_steps_trained_throughput_per_sec": 742.6648021122802, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 5488.061, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5488.038, "sample_time_ms": 4576.011, "learn_time_ms": 881.383, "learn_throughput": 4538.321, "synch_weights_time_ms": 29.814}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "07611_00000", "date": "2024-09-11_17-43-10", "timestamp": 1726069390, "time_this_iter_s": 5.395313739776611, "time_total_s": 168.17537140846252, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE108700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 168.17537140846252, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 66.24285714285715, "ram_util_percent": 88.01428571428573, "gpu_util_percent0": 0.04857142857142858, "vram_util_percent0": 0.14923967633928573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12938451375812293, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0003, "total_loss": 0.03531190778012387, "policy_loss": -0.0027837076839205112, "vf_loss": 0.04719880074262619, "vf_explained_var": 0.5031586304306984, "kl": 0.002948742278113059, "entropy": 0.9103184998035431, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -2.5, "episode_reward_mean": -1.21, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.3025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -1.0, -2.0, -2.0, -1.0, -2.0, 0.5, -2.0, -2.0, -2.0, -1.5, -0.5, -1.5, -2.0, -0.5, 0.5, -0.5, -2.5, -1.0, -2.0, 0.5, -1.5, -2.0, -1.5, -1.0, -2.5, -1.0, -0.5, -1.5, -0.5, -2.0, -1.0, -2.0, -0.5, 0.5, -2.0, -1.5, -2.0, -2.5, -1.5, -1.5, -1.5, 0.5, -1.0, -1.5, -1.5, -1.5, -2.5, -0.5, -0.5, -2.0, -2.0, -2.0, -2.0, -2.0, 0.5, -1.5, -2.5, -0.5, -2.5, -0.5, -1.5, -1.5, -0.5, -1.5, -2.0, -0.5, -1.5, 0.5, -1.0, -2.5, -1.5, -1.5, -2.0, -0.5, -0.5, -2.5, -1.5, -1.5, -0.5, -2.0, -1.5, -1.5, 0.5, -2.0, -0.5, -0.5, -0.5, -0.5, -1.0, -1.5, -0.5, -2.5, 0.5, -1.5, 0.5, -0.5, 0.5, -0.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.290660671078003, "mean_inference_ms": 5.166203214142504, "mean_action_processing_ms": 2.733415225732872, "mean_env_wait_ms": 18.7212315352023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15345215797424316, "StateBufferConnector_ms": 0.04289555549621582, "ViewRequirementAgentConnector_ms": 0.6829965114593506}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -2.5, "episode_return_mean": -1.21, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 789.0065901447823, "num_env_steps_trained_throughput_per_sec": 789.0065901447823, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 5461.111, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5461.099, "sample_time_ms": 4548.232, "learn_time_ms": 882.222, "learn_throughput": 4534.008, "synch_weights_time_ms": 29.816}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "07611_00000", "date": "2024-09-11_17-43-15", "timestamp": 1726069395, "time_this_iter_s": 5.07882285118103, "time_total_s": 173.25419425964355, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE109FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 173.25419425964355, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 67.25, "ram_util_percent": 88.10000000000001, "gpu_util_percent0": 0.024999999999999998, "vram_util_percent0": 0.14571126302083334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11010089758783578, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0003, "total_loss": 0.018796304744319058, "policy_loss": -0.0020636254870623817, "vf_loss": 0.02977249794639647, "vf_explained_var": 0.6341966405510903, "kl": 0.0037814724040799775, "entropy": 0.8912567675113678, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1300.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.24, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.31}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -0.5, 0.5, -2.0, -1.5, -2.0, -2.5, -1.5, -1.5, -1.5, 0.5, -1.0, -1.5, -1.5, -1.5, -2.5, -0.5, -0.5, -2.0, -2.0, -2.0, -2.0, -2.0, 0.5, -1.5, -2.5, -0.5, -2.5, -0.5, -1.5, -1.5, -0.5, -1.5, -2.0, -0.5, -1.5, 0.5, -1.0, -2.5, -1.5, -1.5, -2.0, -0.5, -0.5, -2.5, -1.5, -1.5, -0.5, -2.0, -1.5, -1.5, 0.5, -2.0, -0.5, -0.5, -0.5, -0.5, -1.0, -1.5, -0.5, -2.5, 0.5, -1.5, 0.5, -0.5, 0.5, -0.5, -0.5, -2.0, -2.0, -2.0, -2.5, -1.5, -0.5, -1.5, -2.0, -0.5, -2.0, -0.5, -3.5, -0.5, -0.5, -1.5, -1.5, -1.5, -3.5, -1.5, -2.5, -0.5, -2.0, 0.5, -0.5, -0.5, -0.5, -0.5, -2.0, 0.5, -3.5, -0.5, -1.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.286796089341571, "mean_inference_ms": 5.163948263795931, "mean_action_processing_ms": 2.7310558976087056, "mean_env_wait_ms": 18.70394951859239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.13426756858825684, "StateBufferConnector_ms": 0.034912109375, "ViewRequirementAgentConnector_ms": 0.6610312461853027}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.24, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 755.1341665792733, "num_env_steps_trained_throughput_per_sec": 755.1341665792733, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 5466.552, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5466.54, "sample_time_ms": 4552.622, "learn_time_ms": 883.744, "learn_throughput": 4526.196, "synch_weights_time_ms": 29.344}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "07611_00000", "date": "2024-09-11_17-43-20", "timestamp": 1726069400, "time_this_iter_s": 5.306298017501831, "time_total_s": 178.56049227714539, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE108C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 178.56049227714539, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 64.7, "ram_util_percent": 88.07142857142857, "gpu_util_percent0": 0.027142857142857142, "vram_util_percent0": 0.1456298828125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11609066110104323, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0003, "total_loss": 0.019100490122946213, "policy_loss": -0.0020264390368538443, "vf_loss": 0.030254995543509723, "vf_explained_var": 0.6288469478487968, "kl": 0.0035846870836394374, "entropy": 0.9128066673874855, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1340.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.19, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.2975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5, -2.0, -0.5, -1.5, 0.5, -1.0, -2.5, -1.5, -1.5, -2.0, -0.5, -0.5, -2.5, -1.5, -1.5, -0.5, -2.0, -1.5, -1.5, 0.5, -2.0, -0.5, -0.5, -0.5, -0.5, -1.0, -1.5, -0.5, -2.5, 0.5, -1.5, 0.5, -0.5, 0.5, -0.5, -0.5, -2.0, -2.0, -2.0, -2.5, -1.5, -0.5, -1.5, -2.0, -0.5, -2.0, -0.5, -3.5, -0.5, -0.5, -1.5, -1.5, -1.5, -3.5, -1.5, -2.5, -0.5, -2.0, 0.5, -0.5, -0.5, -0.5, -0.5, -2.0, 0.5, -3.5, -0.5, -1.5, -2.0, -3.5, -2.0, -1.5, -1.5, -0.5, -0.5, -0.5, -0.5, 0.5, -1.5, 0.5, -3.5, 0.5, -0.5, -1.5, -1.5, -1.5, -2.0, -0.5, -2.0, -3.0, -2.5, -2.0, 0.5, -0.5, -1.0, -0.5, -2.0, -1.0, -1.5, 0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.277339344895257, "mean_inference_ms": 5.167490480306543, "mean_action_processing_ms": 2.7279312458450637, "mean_env_wait_ms": 18.72009716102313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.13408946990966797, "StateBufferConnector_ms": 0.0336759090423584, "ViewRequirementAgentConnector_ms": 0.6625003814697266}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.19, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 755.3446462637845, "num_env_steps_trained_throughput_per_sec": 755.3446462637845, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 5452.925, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5452.913, "sample_time_ms": 4538.733, "learn_time_ms": 884.014, "learn_throughput": 4524.815, "synch_weights_time_ms": 29.437}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "07611_00000", "date": "2024-09-11_17-43-26", "timestamp": 1726069406, "time_this_iter_s": 5.305322885513306, "time_total_s": 183.8658151626587, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE108700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 183.8658151626587, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 63.7, "ram_util_percent": 88.0, "gpu_util_percent0": 0.06857142857142857, "vram_util_percent0": 0.14531598772321427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1142528060823679, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0003, "total_loss": 0.015352826510206797, "policy_loss": -0.0015149189915973694, "vf_loss": 0.026079166168347, "vf_explained_var": 0.6355751127004623, "kl": 0.002198928698317104, "entropy": 0.9211420014500618, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.105, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.27625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, 0.5, -0.5, -0.5, -2.0, -2.0, -2.0, -2.5, -1.5, -0.5, -1.5, -2.0, -0.5, -2.0, -0.5, -3.5, -0.5, -0.5, -1.5, -1.5, -1.5, -3.5, -1.5, -2.5, -0.5, -2.0, 0.5, -0.5, -0.5, -0.5, -0.5, -2.0, 0.5, -3.5, -0.5, -1.5, -2.0, -3.5, -2.0, -1.5, -1.5, -0.5, -0.5, -0.5, -0.5, 0.5, -1.5, 0.5, -3.5, 0.5, -0.5, -1.5, -1.5, -1.5, -2.0, -0.5, -2.0, -3.0, -2.5, -2.0, 0.5, -0.5, -1.0, -0.5, -2.0, -1.0, -1.5, 0.5, 0.5, 0.5, -2.5, -0.5, 0.5, -0.5, -1.5, -1.5, 0.5, -1.5, -0.5, 0.5, -0.5, -2.0, -2.0, -0.5, -0.5, -3.0, -1.5, -2.0, 0.5, 0.5, -0.5, -3.0, -0.5, -2.0, 0.5, -2.0, -1.5, -0.5, -0.5, 0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.291585367108903, "mean_inference_ms": 5.164807576605378, "mean_action_processing_ms": 2.729002747662826, "mean_env_wait_ms": 18.69277667373199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1151587963104248, "StateBufferConnector_ms": 0.04024243354797363, "ViewRequirementAgentConnector_ms": 0.6792137622833252}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.105, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 713.282980293202, "num_env_steps_trained_throughput_per_sec": 713.282980293202, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 5397.798, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5397.786, "sample_time_ms": 4488.587, "learn_time_ms": 878.721, "learn_throughput": 4552.068, "synch_weights_time_ms": 29.675}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "07611_00000", "date": "2024-09-11_17-43-31", "timestamp": 1726069411, "time_this_iter_s": 5.6178929805755615, "time_total_s": 189.48370814323425, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE165E10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 189.48370814323425, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 70.04285714285716, "ram_util_percent": 87.98571428571428, "gpu_util_percent0": 0.1042857142857143, "vram_util_percent0": 0.14643205915178573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1643347078934312, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0003, "total_loss": 0.0338330187019892, "policy_loss": -0.002907778217922896, "vf_loss": 0.0459272482432425, "vf_explained_var": 0.5235183805227279, "kl": 0.0032412278995252565, "entropy": 0.9186450853943825, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1420.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.01, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.2525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -1.0, -1.5, 0.5, 0.5, 0.5, -2.5, -0.5, 0.5, -0.5, -1.5, -1.5, 0.5, -1.5, -0.5, 0.5, -0.5, -2.0, -2.0, -0.5, -0.5, -3.0, -1.5, -2.0, 0.5, 0.5, -0.5, -3.0, -0.5, -2.0, 0.5, -2.0, -1.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -1.5, -2.0, -1.5, -2.0, 0.5, -2.0, -3.0, -0.5, -1.0, -1.5, -1.5, -1.5, -0.5, -2.0, -0.5, -3.5, -0.5, 0.5, -0.5, -0.5, -3.5, -0.5, 0.5, -2.0, -1.5, -1.0, -0.5, -0.5, -2.0, -1.5, -1.0, -1.5, -1.5, -0.5, -0.5, -0.5, -1.5, -1.5, -1.5, -0.5, -0.5, 0.5, -0.5, -1.5, 0.5, -3.0, 0.5, -2.0, -0.5, -2.0, -2.0, -0.5, -0.5, -3.0, -2.0, -1.0, -2.0, 0.5, -0.5, -2.0, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.30958579348091, "mean_inference_ms": 5.176789033621585, "mean_action_processing_ms": 2.7330474785466463, "mean_env_wait_ms": 18.7120890773632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11992597579956055, "StateBufferConnector_ms": 0.040032148361206055, "ViewRequirementAgentConnector_ms": 0.7224421501159668}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.01, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 710.3331244601758, "num_env_steps_trained_throughput_per_sec": 710.3331244601758, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 5395.38, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5395.368, "sample_time_ms": 4480.391, "learn_time_ms": 884.266, "learn_throughput": 4523.528, "synch_weights_time_ms": 29.909}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "07611_00000", "date": "2024-09-11_17-43-37", "timestamp": 1726069417, "time_this_iter_s": 5.640193939208984, "time_total_s": 195.12390208244324, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE108C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 195.12390208244324, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 70.41428571428571, "ram_util_percent": 88.12857142857142, "gpu_util_percent0": 0.16, "vram_util_percent0": 0.14247349330357142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12044065371155739, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0003, "total_loss": 0.01633784734585788, "policy_loss": -0.0024322975092218257, "vf_loss": 0.028083699708804487, "vf_explained_var": 0.6885548666119575, "kl": 0.003480097599594956, "entropy": 0.9313554853200913, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1460.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.05, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.2625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -1.5, -2.0, -1.5, -2.0, 0.5, -2.0, -3.0, -0.5, -1.0, -1.5, -1.5, -1.5, -0.5, -2.0, -0.5, -3.5, -0.5, 0.5, -0.5, -0.5, -3.5, -0.5, 0.5, -2.0, -1.5, -1.0, -0.5, -0.5, -2.0, -1.5, -1.0, -1.5, -1.5, -0.5, -0.5, -0.5, -1.5, -1.5, -1.5, -0.5, -0.5, 0.5, -0.5, -1.5, 0.5, -3.0, 0.5, -2.0, -0.5, -2.0, -2.0, -0.5, -0.5, -3.0, -2.0, -1.0, -2.0, 0.5, -0.5, -2.0, -0.5, -0.5, -0.5, -1.5, 0.5, -1.5, -0.5, -0.5, -1.5, -1.5, -0.5, -0.5, -1.5, -1.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.5, -1.5, -1.0, -1.5, -1.5, -1.0, -2.0, -2.0, -0.5, -2.0, -1.5, -0.5, -1.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.323762191832438, "mean_inference_ms": 5.184129871368794, "mean_action_processing_ms": 2.73623679874917, "mean_env_wait_ms": 18.73857429031095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11625027656555176, "StateBufferConnector_ms": 0.03311800956726074, "ViewRequirementAgentConnector_ms": 0.7751750946044922}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.05, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 672.9074820075672, "num_env_steps_trained_throughput_per_sec": 672.9074820075672, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 5454.445, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5454.445, "sample_time_ms": 4532.85, "learn_time_ms": 890.304, "learn_throughput": 4492.849, "synch_weights_time_ms": 30.488}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "07611_00000", "date": "2024-09-11_17-43-43", "timestamp": 1726069423, "time_this_iter_s": 5.953647613525391, "time_total_s": 201.07754969596863, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE164CA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 201.07754969596863, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 68.69999999999999, "ram_util_percent": 88.1625, "gpu_util_percent0": 0.22625, "vram_util_percent0": 0.1485748291015625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10163574172183872, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0003, "total_loss": 0.01753619919763878, "policy_loss": -0.00239555247098906, "vf_loss": 0.02909170910716057, "vf_explained_var": 0.650455904006958, "kl": 0.003703922223576228, "entropy": 0.9159958034753799, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.06, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -0.5, -0.5, -2.0, -1.5, -1.0, -1.5, -1.5, -0.5, -0.5, -0.5, -1.5, -1.5, -1.5, -0.5, -0.5, 0.5, -0.5, -1.5, 0.5, -3.0, 0.5, -2.0, -0.5, -2.0, -2.0, -0.5, -0.5, -3.0, -2.0, -1.0, -2.0, 0.5, -0.5, -2.0, -0.5, -0.5, -0.5, -1.5, 0.5, -1.5, -0.5, -0.5, -1.5, -1.5, -0.5, -0.5, -1.5, -1.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.5, -1.5, -1.0, -1.5, -1.5, -1.0, -2.0, -2.0, -0.5, -2.0, -1.5, -0.5, -1.5, -0.5, -0.5, -1.5, -2.0, -2.0, -2.0, -1.5, 0.5, -0.5, 0.5, -0.5, -1.5, -2.0, -2.5, -2.0, 0.5, -0.5, -1.0, -1.5, -2.0, -0.5, -0.5, -1.5, -0.5, -1.5, 0.5, -2.0, -2.0, -2.0, -2.0, -0.5, -0.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.331381917111294, "mean_inference_ms": 5.19663502386647, "mean_action_processing_ms": 2.737539311288485, "mean_env_wait_ms": 18.797194914607974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10772275924682617, "StateBufferConnector_ms": 0.03813982009887695, "ViewRequirementAgentConnector_ms": 0.7808430194854736}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.06, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 690.3000493288474, "num_env_steps_trained_throughput_per_sec": 690.3000493288474, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 5504.746, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5504.746, "sample_time_ms": 4585.287, "learn_time_ms": 887.771, "learn_throughput": 4505.664, "synch_weights_time_ms": 30.784}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "07611_00000", "date": "2024-09-11_17-43-49", "timestamp": 1726069429, "time_this_iter_s": 5.802921533584595, "time_total_s": 206.88047122955322, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE167F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 206.88047122955322, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 75.48571428571428, "ram_util_percent": 87.97142857142856, "gpu_util_percent0": 0.19857142857142857, "vram_util_percent0": 0.15047781808035715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10462555326521397, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0003, "total_loss": 0.01736827445492963, "policy_loss": -0.002593536482709169, "vf_loss": 0.029058925108984113, "vf_explained_var": 0.6361947238445282, "kl": 0.0029614462346216897, "entropy": 0.909711466729641, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1540.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.075, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.26875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -0.5, -2.0, -0.5, -0.5, -0.5, -1.5, 0.5, -1.5, -0.5, -0.5, -1.5, -1.5, -0.5, -0.5, -1.5, -1.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.5, -1.5, -1.0, -1.5, -1.5, -1.0, -2.0, -2.0, -0.5, -2.0, -1.5, -0.5, -1.5, -0.5, -0.5, -1.5, -2.0, -2.0, -2.0, -1.5, 0.5, -0.5, 0.5, -0.5, -1.5, -2.0, -2.5, -2.0, 0.5, -0.5, -1.0, -1.5, -2.0, -0.5, -0.5, -1.5, -0.5, -1.5, 0.5, -2.0, -2.0, -2.0, -2.0, -0.5, -0.5, -0.5, -1.5, 0.5, -1.0, -2.0, -1.0, -1.5, -1.5, -1.0, 0.5, 0.5, -0.5, -2.0, -2.0, -0.5, -2.0, -2.0, -2.0, -2.0, -1.5, 0.5, -2.0, -0.5, -0.5, 0.5, -3.0, -2.0, -1.5, -0.5, -2.0, -0.5, -1.5, -1.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.359454154573653, "mean_inference_ms": 5.2016584305478695, "mean_action_processing_ms": 2.7434094527794444, "mean_env_wait_ms": 18.81853148244423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09944534301757812, "StateBufferConnector_ms": 0.03771686553955078, "ViewRequirementAgentConnector_ms": 0.7526216506958008}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.075, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 709.5025857583346, "num_env_steps_trained_throughput_per_sec": 709.5025857583346, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 5538.856, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5538.856, "sample_time_ms": 4616.233, "learn_time_ms": 890.907, "learn_throughput": 4489.807, "synch_weights_time_ms": 30.814}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "07611_00000", "date": "2024-09-11_17-43-55", "timestamp": 1726069435, "time_this_iter_s": 5.647753477096558, "time_total_s": 212.52822470664978, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE1F0820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 212.52822470664978, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 63.587500000000006, "ram_util_percent": 87.9625, "gpu_util_percent0": 0.15875, "vram_util_percent0": 0.150390625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1471401982009411, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0003, "total_loss": 0.033817283634562045, "policy_loss": -0.003181990027951542, "vf_loss": 0.0458923127502203, "vf_explained_var": 0.5427869871258736, "kl": 0.0027940028935518058, "entropy": 0.8893039867281913, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1580.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.135, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.28375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -0.5, -0.5, -0.5, -1.5, 0.5, -1.0, -2.0, -1.0, -1.5, -1.5, -1.0, 0.5, 0.5, -0.5, -2.0, -2.0, -0.5, -2.0, -2.0, -2.0, -2.0, -1.5, 0.5, -2.0, -0.5, -0.5, 0.5, -3.0, -2.0, -1.5, -0.5, -2.0, -0.5, -1.5, -1.5, -2.0, -0.5, -3.0, -0.5, -2.0, -0.5, -0.5, -1.0, 0.5, -2.0, -2.0, -1.5, -0.5, 0.5, -0.5, -1.5, -0.5, 0.5, -2.0, -3.5, -0.5, -0.5, -0.5, -2.5, -2.0, -2.0, -1.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -1.5, -2.0, -0.5, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -2.0, -0.5, -1.0, -3.0, -0.5, -2.0, -2.0, -0.5, -2.0, -1.5, -2.0, -0.5, -2.0, -0.5, -1.5, -1.5, -2.0, -1.0, -0.5, -0.5, -2.0, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.390196020849306, "mean_inference_ms": 5.218715079157031, "mean_action_processing_ms": 2.7507111767150327, "mean_env_wait_ms": 18.87768193753551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.13924670219421387, "StateBufferConnector_ms": 0.049746036529541016, "ViewRequirementAgentConnector_ms": 0.7091715335845947}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.135, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 685.2007048201373, "num_env_steps_trained_throughput_per_sec": 685.2007048201373, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 5550.177, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5550.177, "sample_time_ms": 4617.533, "learn_time_ms": 901.239, "learn_throughput": 4438.333, "synch_weights_time_ms": 30.503}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "07611_00000", "date": "2024-09-11_17-44-00", "timestamp": 1726069440, "time_this_iter_s": 5.846738338470459, "time_total_s": 218.37496304512024, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE166D40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 218.37496304512024, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 75.85714285714286, "ram_util_percent": 88.07142857142857, "gpu_util_percent0": 0.19714285714285715, "vram_util_percent0": 0.14650181361607142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12972562462091447, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0003, "total_loss": 0.01289344646866084, "policy_loss": -0.0029476900199369993, "vf_loss": 0.024818645091727376, "vf_explained_var": 0.7209255501627923, "kl": 0.0028714640307043737, "entropy": 0.8977508708834648, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.025, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.25625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -0.5, -1.5, -1.5, -2.0, -0.5, -3.0, -0.5, -2.0, -0.5, -0.5, -1.0, 0.5, -2.0, -2.0, -1.5, -0.5, 0.5, -0.5, -1.5, -0.5, 0.5, -2.0, -3.5, -0.5, -0.5, -0.5, -2.5, -2.0, -2.0, -1.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -1.5, -2.0, -0.5, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -2.0, -0.5, -1.0, -3.0, -0.5, -2.0, -2.0, -0.5, -2.0, -1.5, -2.0, -0.5, -2.0, -0.5, -1.5, -1.5, -2.0, -1.0, -0.5, -0.5, -2.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -2.0, -2.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -2.0, 0.5, -2.0, -0.5, -2.0, -0.5, 0.5, -1.5, -0.5, -0.5, -1.5, -0.5, -2.0, -0.5, -1.5, -2.0, -0.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.399840691198069, "mean_inference_ms": 5.225902219703434, "mean_action_processing_ms": 2.753369105517369, "mean_env_wait_ms": 18.90340917393728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16137385368347168, "StateBufferConnector_ms": 0.045146942138671875, "ViewRequirementAgentConnector_ms": 0.7087273597717285}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.025, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 697.7121640226695, "num_env_steps_trained_throughput_per_sec": 697.7121640226695, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 5584.878, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5584.878, "sample_time_ms": 4649.421, "learn_time_ms": 903.351, "learn_throughput": 4427.959, "synch_weights_time_ms": 31.206}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "07611_00000", "date": "2024-09-11_17-44-06", "timestamp": 1726069446, "time_this_iter_s": 5.743178844451904, "time_total_s": 224.11814188957214, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE167F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 224.11814188957214, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 65.2625, "ram_util_percent": 88.6125, "gpu_util_percent0": 0.04875, "vram_util_percent0": 0.1509857177734375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09915371872484684, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0003, "total_loss": 0.015314763932474306, "policy_loss": -0.0018565655952016869, "vf_loss": 0.025917916791513562, "vf_explained_var": 0.6820112332701683, "kl": 0.0026390602681203744, "entropy": 0.8746586441993713, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1660.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.25375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -0.5, -0.5, -1.0, -1.0, -1.5, -2.0, -0.5, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -2.0, -0.5, -1.0, -3.0, -0.5, -2.0, -2.0, -0.5, -2.0, -1.5, -2.0, -0.5, -2.0, -0.5, -1.5, -1.5, -2.0, -1.0, -0.5, -0.5, -2.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -2.0, -2.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -2.0, 0.5, -2.0, -0.5, -2.0, -0.5, 0.5, -1.5, -0.5, -0.5, -1.5, -0.5, -2.0, -0.5, -1.5, -2.0, -0.5, -0.5, -0.5, -1.5, -1.5, -0.5, -1.0, -1.5, -2.0, -0.5, -1.0, -1.5, -1.0, -1.0, -2.0, -0.5, -1.0, -1.0, -1.5, 0.5, -1.0, -0.5, -2.0, -1.5, -2.0, -2.0, 0.5, -2.0, -2.0, -2.0, 0.5, -0.5, -3.0, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.417817010688964, "mean_inference_ms": 5.245400805899532, "mean_action_processing_ms": 2.7583323762247427, "mean_env_wait_ms": 18.986832938190542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1740281581878662, "StateBufferConnector_ms": 0.039537906646728516, "ViewRequirementAgentConnector_ms": 0.7948417663574219}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.015, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 569.3520550249601, "num_env_steps_trained_throughput_per_sec": 569.3520550249601, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 5780.465, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5780.465, "sample_time_ms": 4829.637, "learn_time_ms": 919.238, "learn_throughput": 4351.43, "synch_weights_time_ms": 30.689}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "07611_00000", "date": "2024-09-11_17-44-13", "timestamp": 1726069453, "time_this_iter_s": 7.0337865352630615, "time_total_s": 231.1519284248352, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE1672E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 231.1519284248352, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 87.07499999999999, "ram_util_percent": 89.3625, "gpu_util_percent0": 0.27, "vram_util_percent0": 0.142333984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11430548317730427, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0003, "total_loss": 0.01957379131927155, "policy_loss": -0.002112585346912965, "vf_loss": 0.0304522804915905, "vf_explained_var": 0.6200768172740936, "kl": 0.002853444854463305, "entropy": 0.8765903443098069, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1700.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.1, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -0.5, -2.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -2.0, -2.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -2.0, 0.5, -2.0, -0.5, -2.0, -0.5, 0.5, -1.5, -0.5, -0.5, -1.5, -0.5, -2.0, -0.5, -1.5, -2.0, -0.5, -0.5, -0.5, -1.5, -1.5, -0.5, -1.0, -1.5, -2.0, -0.5, -1.0, -1.5, -1.0, -1.0, -2.0, -0.5, -1.0, -1.0, -1.5, 0.5, -1.0, -0.5, -2.0, -1.5, -2.0, -2.0, 0.5, -2.0, -2.0, -2.0, 0.5, -0.5, -3.0, -0.5, -2.0, -1.0, -1.5, -1.0, -2.0, -1.5, -1.5, -0.5, -1.0, -1.0, -0.5, -1.0, -2.0, -1.0, -0.5, -2.0, -2.0, -1.0, -2.0, -1.5, -1.0, -3.0, -1.0, -2.0, -1.5, -1.5, -1.0, -2.0, 0.5, -2.0, -2.0, -2.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.461792232754844, "mean_inference_ms": 5.258413436096164, "mean_action_processing_ms": 2.767958932518707, "mean_env_wait_ms": 19.026009912184605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.14062285423278809, "StateBufferConnector_ms": 0.03752613067626953, "ViewRequirementAgentConnector_ms": 0.8080413341522217}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.1, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 681.2522698641947, "num_env_steps_trained_throughput_per_sec": 681.2522698641947, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 5837.912, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5837.912, "sample_time_ms": 4880.694, "learn_time_ms": 925.952, "learn_throughput": 4319.88, "synch_weights_time_ms": 30.464}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "07611_00000", "date": "2024-09-11_17-44-19", "timestamp": 1726069459, "time_this_iter_s": 5.881540775299072, "time_total_s": 237.03346920013428, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE109120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 237.03346920013428, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 68.2125, "ram_util_percent": 90.1625, "gpu_util_percent0": 0.10375000000000001, "vram_util_percent0": 0.149078369140625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15667782202363015, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0003, "total_loss": 0.033173942426219585, "policy_loss": -0.002008535054483218, "vf_loss": 0.04377673454582691, "vf_explained_var": 0.5559524193406105, "kl": 0.002739103137037091, "entropy": 0.8594258293509484, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.27, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.3175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -0.5, -3.0, -0.5, -2.0, -1.0, -1.5, -1.0, -2.0, -1.5, -1.5, -0.5, -1.0, -1.0, -0.5, -1.0, -2.0, -1.0, -0.5, -2.0, -2.0, -1.0, -2.0, -1.5, -1.0, -3.0, -1.0, -2.0, -1.5, -1.5, -1.0, -2.0, 0.5, -2.0, -2.0, -2.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.5, -0.5, -2.0, -2.0, -2.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -3.0, -0.5, -2.0, -1.0, -2.0, -2.0, -0.5, -2.0, -3.0, -1.5, -2.0, -1.0, 0.5, -0.5, 0.5, -0.5, -2.0, -2.0, -2.0, -0.5, -2.0, -2.0, -2.0, -0.5, -2.5, 0.5, -2.0, -2.0, -0.5, -1.0, -0.5, -2.0, -2.0, -0.5, -2.0, -0.5, -3.0, -2.0, -0.5, -1.5, -2.0, -1.5, 0.5, -2.0, 0.5, -1.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.501074859265023, "mean_inference_ms": 5.276826746176237, "mean_action_processing_ms": 2.7771884241473908, "mean_env_wait_ms": 19.090958276778593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0820927619934082, "StateBufferConnector_ms": 0.0471038818359375, "ViewRequirementAgentConnector_ms": 0.6958343982696533}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.27, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 748.3252329370373, "num_env_steps_trained_throughput_per_sec": 748.3252329370373, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 5842.879, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5842.879, "sample_time_ms": 4886.541, "learn_time_ms": 925.195, "learn_throughput": 4323.413, "synch_weights_time_ms": 30.243}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "07611_00000", "date": "2024-09-11_17-44-25", "timestamp": 1726069465, "time_this_iter_s": 5.355428218841553, "time_total_s": 242.38889741897583, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE167F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 242.38889741897583, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 63.642857142857146, "ram_util_percent": 90.62857142857142, "gpu_util_percent0": 0.044285714285714296, "vram_util_percent0": 0.15018136160714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11377482283860445, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0003, "total_loss": 0.019541557761840522, "policy_loss": -0.0021106660220539196, "vf_loss": 0.030563412001356483, "vf_explained_var": 0.6601662009954452, "kl": 0.00177266393429818, "entropy": 0.891118834912777, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1780.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.35, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.3375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -2.0, -2.0, -2.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.5, -0.5, -2.0, -2.0, -2.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -3.0, -0.5, -2.0, -1.0, -2.0, -2.0, -0.5, -2.0, -3.0, -1.5, -2.0, -1.0, 0.5, -0.5, 0.5, -0.5, -2.0, -2.0, -2.0, -0.5, -2.0, -2.0, -2.0, -0.5, -2.5, 0.5, -2.0, -2.0, -0.5, -1.0, -0.5, -2.0, -2.0, -0.5, -2.0, -0.5, -3.0, -2.0, -0.5, -1.5, -2.0, -1.5, 0.5, -2.0, 0.5, -1.0, -2.0, -1.0, -3.0, -0.5, -3.0, -2.0, -1.0, -3.5, -3.0, -1.0, -1.0, -1.0, -2.0, -1.5, -3.5, -3.5, -1.0, -2.0, 0.5, -0.5, -1.0, -2.0, -0.5, 0.5, -2.0, -2.0, -0.5, -1.5, -0.5, -1.0, -2.0, -3.5, -1.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.498413412530477, "mean_inference_ms": 5.274936971648377, "mean_action_processing_ms": 2.776067297933681, "mean_env_wait_ms": 19.088967123348993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08598208427429199, "StateBufferConnector_ms": 0.0380401611328125, "ViewRequirementAgentConnector_ms": 0.6800439357757568}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.35, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 728.448353342357, "num_env_steps_trained_throughput_per_sec": 728.448353342357, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 5831.204, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5831.204, "sample_time_ms": 4865.388, "learn_time_ms": 935.303, "learn_throughput": 4276.69, "synch_weights_time_ms": 29.614}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "07611_00000", "date": "2024-09-11_17-44-30", "timestamp": 1726069470, "time_this_iter_s": 5.500371694564819, "time_total_s": 247.88926911354065, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE1F12D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 247.88926911354065, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 65.5142857142857, "ram_util_percent": 90.54285714285716, "gpu_util_percent0": 0.08714285714285716, "vram_util_percent0": 0.14679827008928573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10270437281578779, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0003, "total_loss": 0.015570420721633126, "policy_loss": -0.0023653516138438134, "vf_loss": 0.026711719296872615, "vf_explained_var": 0.6872771859169007, "kl": 0.003494987413432682, "entropy": 0.8775947451591491, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1820.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.445, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.36125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, -0.5, 0.5, -0.5, -2.0, -2.0, -2.0, -0.5, -2.0, -2.0, -2.0, -0.5, -2.5, 0.5, -2.0, -2.0, -0.5, -1.0, -0.5, -2.0, -2.0, -0.5, -2.0, -0.5, -3.0, -2.0, -0.5, -1.5, -2.0, -1.5, 0.5, -2.0, 0.5, -1.0, -2.0, -1.0, -3.0, -0.5, -3.0, -2.0, -1.0, -3.5, -3.0, -1.0, -1.0, -1.0, -2.0, -1.5, -3.5, -3.5, -1.0, -2.0, 0.5, -0.5, -1.0, -2.0, -0.5, 0.5, -2.0, -2.0, -0.5, -1.5, -0.5, -1.0, -2.0, -3.5, -1.5, -2.0, -1.0, -1.5, -2.0, -2.0, -2.0, -3.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -2.0, -2.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.0, -2.0, -1.0, -2.0, -3.0, -1.0, -2.0, -0.5, -2.0, -2.0, -2.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.487262827387202, "mean_inference_ms": 5.275689882031111, "mean_action_processing_ms": 2.7736181442623975, "mean_env_wait_ms": 19.109072951753195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08883404731750488, "StateBufferConnector_ms": 0.02892017364501953, "ViewRequirementAgentConnector_ms": 0.6648218631744385}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.445, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 738.9334284915708, "num_env_steps_trained_throughput_per_sec": 738.9334284915708, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 5809.409, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5809.409, "sample_time_ms": 4847.288, "learn_time_ms": 932.35, "learn_throughput": 4290.235, "synch_weights_time_ms": 28.86}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "07611_00000", "date": "2024-09-11_17-44-36", "timestamp": 1726069476, "time_this_iter_s": 5.422243595123291, "time_total_s": 253.31151270866394, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE109120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 253.31151270866394, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 65.25714285714287, "ram_util_percent": 90.35714285714286, "gpu_util_percent0": 0.07714285714285714, "vram_util_percent0": 0.14327566964285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11130570899695158, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0003, "total_loss": 0.01500573757220991, "policy_loss": -0.002316588331814273, "vf_loss": 0.025974654452875258, "vf_explained_var": 0.6538993909955024, "kl": 0.002876627994101, "entropy": 0.8652328178286552, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1860.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.555, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.38875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, 0.5, -1.0, -2.0, -1.0, -3.0, -0.5, -3.0, -2.0, -1.0, -3.5, -3.0, -1.0, -1.0, -1.0, -2.0, -1.5, -3.5, -3.5, -1.0, -2.0, 0.5, -0.5, -1.0, -2.0, -0.5, 0.5, -2.0, -2.0, -0.5, -1.5, -0.5, -1.0, -2.0, -3.5, -1.5, -2.0, -1.0, -1.5, -2.0, -2.0, -2.0, -3.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -2.0, -2.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.0, -2.0, -1.0, -2.0, -3.0, -1.0, -2.0, -0.5, -2.0, -2.0, -2.0, -1.0, -2.0, -2.0, -1.0, -2.0, 0.5, -0.5, -1.0, -2.0, -2.0, -1.0, -2.0, -1.0, -1.5, -2.0, -0.5, -1.5, -2.0, -2.0, 0.5, -2.0, -2.0, -2.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.0, -1.5, -3.0, -2.0, -2.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.499196491473072, "mean_inference_ms": 5.270425684343009, "mean_action_processing_ms": 2.7732166731465644, "mean_env_wait_ms": 19.089933894594015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09590792655944824, "StateBufferConnector_ms": 0.033013343811035156, "ViewRequirementAgentConnector_ms": 0.7043461799621582}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.555, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 700.3696962612921, "num_env_steps_trained_throughput_per_sec": 700.3696962612921, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 5786.1, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5786.1, "sample_time_ms": 4826.399, "learn_time_ms": 930.618, "learn_throughput": 4298.217, "synch_weights_time_ms": 28.172}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "07611_00000", "date": "2024-09-11_17-44-41", "timestamp": 1726069481, "time_this_iter_s": 5.723521709442139, "time_total_s": 259.0350344181061, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE1F2680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 259.0350344181061, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 74.44285714285714, "ram_util_percent": 90.54285714285716, "gpu_util_percent0": 0.04714285714285715, "vram_util_percent0": 0.14208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17929375506937503, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0003, "total_loss": 0.02598325380240567, "policy_loss": -0.0023115131465601736, "vf_loss": 0.03689937070012093, "vf_explained_var": 0.6208677619695664, "kl": 0.003362088813446462, "entropy": 0.8604604125022888, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1900.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.45, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.3625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -2.0, -2.0, -1.0, -2.0, -2.0, -1.0, -2.0, 0.5, -0.5, -1.0, -2.0, -2.0, -1.0, -2.0, -1.0, -1.5, -2.0, -0.5, -1.5, -2.0, -2.0, 0.5, -2.0, -2.0, -2.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.0, -1.5, -3.0, -2.0, -2.5, -1.0, -1.0, -2.0, -1.0, -2.0, -1.5, -1.5, -1.0, -2.0, -1.0, -2.0, -2.0, -2.0, -2.0, -1.0, 0.5, -2.0, -2.0, -0.5, -2.0, -2.0, -2.0, -2.0, -2.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -2.0, -0.5, -2.0, -2.0, -1.0, -0.5, -2.0, -1.0, -1.0, -2.0, -1.0, 0.5, -2.0, -0.5, -1.0, -1.0, -2.0, -1.0, -1.0, -1.5, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.5, -2.0, -1.0, -3.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.513531603746443, "mean_inference_ms": 5.272555670429003, "mean_action_processing_ms": 2.77425640472804, "mean_env_wait_ms": 19.105443082653288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.13050484657287598, "StateBufferConnector_ms": 0.040390968322753906, "ViewRequirementAgentConnector_ms": 0.7288975715637207}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.45, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 713.4785405284147, "num_env_steps_trained_throughput_per_sec": 713.4785405284147, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 5767.276, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5767.276, "sample_time_ms": 4798.917, "learn_time_ms": 939.327, "learn_throughput": 4258.368, "synch_weights_time_ms": 28.121}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "07611_00000", "date": "2024-09-11_17-44-47", "timestamp": 1726069487, "time_this_iter_s": 5.615333318710327, "time_total_s": 264.6503677368164, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE1F1F30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 264.6503677368164, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 70.87142857142858, "ram_util_percent": 90.17142857142856, "gpu_util_percent0": 0.03, "vram_util_percent0": 0.14034598214285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11563462698832154, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0003, "total_loss": 0.008095518323534634, "policy_loss": -0.002544507890706882, "vf_loss": 0.01937031131237745, "vf_explained_var": 0.7990675643086433, "kl": 0.0039538305034056975, "entropy": 0.8730285838246346, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1940.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.4, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5, -3.0, -2.0, -2.5, -1.0, -1.0, -2.0, -1.0, -2.0, -1.5, -1.5, -1.0, -2.0, -1.0, -2.0, -2.0, -2.0, -2.0, -1.0, 0.5, -2.0, -2.0, -0.5, -2.0, -2.0, -2.0, -2.0, -2.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -2.0, -0.5, -2.0, -2.0, -1.0, -0.5, -2.0, -1.0, -1.0, -2.0, -1.0, 0.5, -2.0, -0.5, -1.0, -1.0, -2.0, -1.0, -1.0, -1.5, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.5, -2.0, -1.0, -3.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, 0.5, -2.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -2.0, -2.0, -2.0, -1.0, -1.0, -3.5, -1.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.516489151607614, "mean_inference_ms": 5.272389622811533, "mean_action_processing_ms": 2.7740457626511916, "mean_env_wait_ms": 19.109296503463163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12856340408325195, "StateBufferConnector_ms": 0.04766416549682617, "ViewRequirementAgentConnector_ms": 0.6671955585479736}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.4, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 735.0628666285317, "num_env_steps_trained_throughput_per_sec": 735.0628666285317, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 5747.672, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5747.672, "sample_time_ms": 4784.378, "learn_time_ms": 934.384, "learn_throughput": 4280.897, "synch_weights_time_ms": 27.999}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "07611_00000", "date": "2024-09-11_17-44-52", "timestamp": 1726069492, "time_this_iter_s": 5.450034856796265, "time_total_s": 270.10040259361267, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE166830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 270.10040259361267, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 66.4857142857143, "ram_util_percent": 88.89999999999999, "gpu_util_percent0": 0.07142857142857142, "vram_util_percent0": 0.14111328125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10673531545326113, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0003, "total_loss": 0.01147562645637663, "policy_loss": -0.001987198433744197, "vf_loss": 0.02222760790027678, "vf_explained_var": 0.7584440052509308, "kl": 0.0022949535640691466, "entropy": 0.8764783427119255, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 1980.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.365, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.34125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -0.5, -2.0, -0.5, -2.0, -2.0, -1.0, -0.5, -2.0, -1.0, -1.0, -2.0, -1.0, 0.5, -2.0, -0.5, -1.0, -1.0, -2.0, -1.0, -1.0, -1.5, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.5, -2.0, -1.0, -3.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, 0.5, -2.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -2.0, -2.0, -2.0, -1.0, -1.0, -3.5, -1.0, -1.0, -1.0, -2.0, -2.0, -1.5, -2.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, 0.5, -0.5, -2.0, -2.5, -2.0, -1.0, -1.0, -3.0, -1.0, -2.0, -2.0, -1.0, -1.0, -2.0, 0.5, -0.5, -2.0, -2.0, -1.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.503399884065997, "mean_inference_ms": 5.271884265127918, "mean_action_processing_ms": 2.770697269714958, "mean_env_wait_ms": 19.121499830931445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1100304126739502, "StateBufferConnector_ms": 0.03740239143371582, "ViewRequirementAgentConnector_ms": 0.6280980110168457}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.365, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 777.2508458290886, "num_env_steps_trained_throughput_per_sec": 777.2508458290886, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 5678.535, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5678.535, "sample_time_ms": 4717.856, "learn_time_ms": 931.911, "learn_throughput": 4292.255, "synch_weights_time_ms": 27.857}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "07611_00000", "date": "2024-09-11_17-44-58", "timestamp": 1726069498, "time_this_iter_s": 5.1544880867004395, "time_total_s": 275.2548906803131, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10BF40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 275.2548906803131, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 57.528571428571425, "ram_util_percent": 89.01428571428572, "gpu_util_percent0": 0.005714285714285714, "vram_util_percent0": 0.13991001674107142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0982194217853248, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0003, "total_loss": 0.00996034028066788, "policy_loss": -0.0019931839640776163, "vf_loss": 0.02064987439662218, "vf_explained_var": 0.7604105040431023, "kl": 0.0022719684146068177, "entropy": 0.8696350559592247, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2020.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.435, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.35875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -1.0, -3.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, 0.5, -2.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -2.0, -2.0, -2.0, -1.0, -1.0, -3.5, -1.0, -1.0, -1.0, -2.0, -2.0, -1.5, -2.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, 0.5, -0.5, -2.0, -2.5, -2.0, -1.0, -1.0, -3.0, -1.0, -2.0, -2.0, -1.0, -1.0, -2.0, 0.5, -0.5, -2.0, -2.0, -1.0, -2.0, -1.0, -3.0, -1.0, -2.0, -1.0, -2.0, -2.0, 0.5, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -3.0, -1.0, -2.0, -3.0, -1.0, -1.0, -2.0, -2.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.501971208763797, "mean_inference_ms": 5.262727491424317, "mean_action_processing_ms": 2.7681158426335957, "mean_env_wait_ms": 19.082936681287805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09727096557617188, "StateBufferConnector_ms": 0.04136323928833008, "ViewRequirementAgentConnector_ms": 0.5878522396087646}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.435, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 766.1498817750556, "num_env_steps_trained_throughput_per_sec": 766.1498817750556, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 5627.324, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5627.324, "sample_time_ms": 4658.257, "learn_time_ms": 941.359, "learn_throughput": 4249.174, "synch_weights_time_ms": 26.797}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "07611_00000", "date": "2024-09-11_17-45-03", "timestamp": 1726069503, "time_this_iter_s": 5.229229927062988, "time_total_s": 280.4841206073761, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE166D40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 280.4841206073761, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 62.285714285714285, "ram_util_percent": 87.84285714285714, "gpu_util_percent0": 0.04285714285714286, "vram_util_percent0": 0.13896833147321427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1430588124319911, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0003, "total_loss": 0.019587749791389795, "policy_loss": -0.002052088415439357, "vf_loss": 0.030179796228185295, "vf_explained_var": 0.7201425135135651, "kl": 0.002622106233911836, "entropy": 0.8539958372712135, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2060.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.39, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.3475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -2.0, -1.0, -2.0, -1.0, -3.0, -1.0, -2.0, -1.0, -2.0, -2.0, 0.5, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -3.0, -1.0, -2.0, -3.0, -1.0, -1.0, -2.0, -2.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -2.0, -2.0, -2.0, -2.0, -1.0, -1.0, 0.5, -2.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.5, -2.0, -1.0, -2.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.0, -1.0, 0.5, -1.0, -2.0, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -0.5, -0.5, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.490608483476421, "mean_inference_ms": 5.255216648180854, "mean_action_processing_ms": 2.7628530454169935, "mean_env_wait_ms": 19.058210083735176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11418318748474121, "StateBufferConnector_ms": 0.0393064022064209, "ViewRequirementAgentConnector_ms": 0.6510012149810791}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.39, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 720.1463642047954, "num_env_steps_trained_throughput_per_sec": 720.1463642047954, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 5480.214, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5480.214, "sample_time_ms": 4518.859, "learn_time_ms": 933.002, "learn_throughput": 4287.236, "synch_weights_time_ms": 27.441}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "07611_00000", "date": "2024-09-11_17-45-09", "timestamp": 1726069509, "time_this_iter_s": 5.5644121170043945, "time_total_s": 286.0485327243805, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE166E60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 286.0485327243805, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 69.21428571428572, "ram_util_percent": 87.94285714285715, "gpu_util_percent0": 0.16, "vram_util_percent0": 0.14590890066964285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10371912140399217, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0003, "total_loss": 0.008139843226672383, "policy_loss": -0.002505237048899289, "vf_loss": 0.019056784501299263, "vf_explained_var": 0.8330769568681717, "kl": 0.002271873103609323, "entropy": 0.8411704912781716, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2100.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.36, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -2.0, -2.0, -2.0, -2.0, -1.0, -1.0, 0.5, -2.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.5, -2.0, -1.0, -2.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.0, -1.0, 0.5, -1.0, -2.0, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -0.5, -0.5, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.5, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -2.0, -2.0, -2.0, -2.0, -2.0, -1.0, -2.0, -1.0, -3.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -3.5, -1.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.49058145136543, "mean_inference_ms": 5.256405293364481, "mean_action_processing_ms": 2.762857752950857, "mean_env_wait_ms": 19.06435655732304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11115407943725586, "StateBufferConnector_ms": 0.042389631271362305, "ViewRequirementAgentConnector_ms": 0.6652655601501465}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.36, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 712.7290053732881, "num_env_steps_trained_throughput_per_sec": 712.7290053732881, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 5454.283, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5454.283, "sample_time_ms": 4497.161, "learn_time_ms": 928.721, "learn_throughput": 4306.999, "synch_weights_time_ms": 27.389}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "07611_00000", "date": "2024-09-11_17-45-14", "timestamp": 1726069514, "time_this_iter_s": 5.621232509613037, "time_total_s": 291.66976523399353, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE1F25F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 291.66976523399353, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 70.07142857142857, "ram_util_percent": 88.37142857142855, "gpu_util_percent0": 0.05857142857142857, "vram_util_percent0": 0.15049525669642858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10838091652840376, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0003, "total_loss": 0.007625615473375547, "policy_loss": -0.0027302133827106444, "vf_loss": 0.018671991489827632, "vf_explained_var": 0.809463980793953, "kl": 0.0038746621250538736, "entropy": 0.8316162988543511, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2140.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.415, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.35375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -2.0, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -0.5, -0.5, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.5, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -2.0, -2.0, -2.0, -2.0, -2.0, -1.0, -2.0, -1.0, -3.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -3.5, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -3.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -3.0, -1.0, -2.0, -1.0, -2.0, -3.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.478425693360348, "mean_inference_ms": 5.257942951442529, "mean_action_processing_ms": 2.760133400134315, "mean_env_wait_ms": 19.08083186144934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10906338691711426, "StateBufferConnector_ms": 0.05383419990539551, "ViewRequirementAgentConnector_ms": 0.6245779991149902}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -3.5, "episode_return_mean": -1.415, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 760.7115692461018, "num_env_steps_trained_throughput_per_sec": 760.7115692461018, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 5445.579, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5445.579, "sample_time_ms": 4475.6, "learn_time_ms": 940.465, "learn_throughput": 4253.215, "synch_weights_time_ms": 28.501}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "07611_00000", "date": "2024-09-11_17-45-19", "timestamp": 1726069519, "time_this_iter_s": 5.267269134521484, "time_total_s": 296.937034368515, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE166D40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 296.937034368515, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 60.01428571428572, "ram_util_percent": 88.45714285714284, "gpu_util_percent0": 0.045714285714285714, "vram_util_percent0": 0.14808872767857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10304372124373913, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0003, "total_loss": 0.009296021547197598, "policy_loss": -0.0024831366381476982, "vf_loss": 0.019958699028939007, "vf_explained_var": 0.7849742919206619, "kl": 0.00283239912978388, "entropy": 0.8179541081190109, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2180.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.48, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.37}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.5, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -2.0, -2.0, -2.0, -2.0, -2.0, -1.0, -2.0, -1.0, -3.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -3.5, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -3.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -3.0, -1.0, -2.0, -1.0, -2.0, -3.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -3.0, -1.0, -2.0, -2.0, -1.0, -3.0, -1.0, -2.0, -1.0, -3.0, -1.0, -2.0, -1.0, -2.0, -2.0, -2.0, -1.0, -2.0, 0.5, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.478950011290692, "mean_inference_ms": 5.2523710141144155, "mean_action_processing_ms": 2.7598035343612026, "mean_env_wait_ms": 19.05258961611502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10181808471679688, "StateBufferConnector_ms": 0.049280405044555664, "ViewRequirementAgentConnector_ms": 0.6463000774383545}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.48, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 763.8303204909175, "num_env_steps_trained_throughput_per_sec": 763.8303204909175, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 5420.144, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5420.144, "sample_time_ms": 4466.018, "learn_time_ms": 923.886, "learn_throughput": 4329.539, "synch_weights_time_ms": 29.226}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "07611_00000", "date": "2024-09-11_17-45-25", "timestamp": 1726069525, "time_this_iter_s": 5.249037742614746, "time_total_s": 302.18607211112976, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE1F1AB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 302.18607211112976, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 62.91428571428571, "ram_util_percent": 88.62857142857142, "gpu_util_percent0": 0.038571428571428576, "vram_util_percent0": 0.14753069196428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.143556615896523, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0003, "total_loss": 0.019604646979132667, "policy_loss": -0.0016760993843490724, "vf_loss": 0.029237034637480973, "vf_explained_var": 0.7337211161851883, "kl": 0.0017773482655684346, "entropy": 0.7956289038062095, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2220.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.48, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.37}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -2.0, -3.0, -1.0, -2.0, -2.0, -1.0, -3.0, -1.0, -2.0, -1.0, -3.0, -1.0, -2.0, -1.0, -2.0, -2.0, -2.0, -1.0, -2.0, 0.5, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -2.0, -3.0, -2.0, -2.0, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -3.0, -1.0, -2.0, 0.5, -2.0, -1.0, -1.0, -2.0, -2.0, -2.0, -3.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -2.0, -3.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.469273681984726, "mean_inference_ms": 5.2415207658767216, "mean_action_processing_ms": 2.7527720079190123, "mean_env_wait_ms": 19.009593458124417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1306147575378418, "StateBufferConnector_ms": 0.056119680404663086, "ViewRequirementAgentConnector_ms": 0.6891136169433594}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.48, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 787.1808796099364, "num_env_steps_trained_throughput_per_sec": 787.1808796099364, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 5386.965, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5386.965, "sample_time_ms": 4432.518, "learn_time_ms": 923.892, "learn_throughput": 4329.511, "synch_weights_time_ms": 29.555}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "07611_00000", "date": "2024-09-11_17-45-30", "timestamp": 1726069530, "time_this_iter_s": 5.0915892124176025, "time_total_s": 307.27766132354736, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE1F2CB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 307.27766132354736, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 66.14999999999999, "ram_util_percent": 88.53333333333335, "gpu_util_percent0": 0.05333333333333332, "vram_util_percent0": 0.14615885416666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10943717919290066, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0003, "total_loss": 0.007925378605432343, "policy_loss": -0.0016492455455590972, "vf_loss": 0.017539443587884306, "vf_explained_var": 0.8464961931109428, "kl": 0.002217741882827795, "entropy": 0.7964819833636284, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2260.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.455, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.36375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -2.0, -1.0, -2.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -2.0, -3.0, -2.0, -2.0, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -3.0, -1.0, -2.0, 0.5, -2.0, -1.0, -1.0, -2.0, -2.0, -2.0, -3.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -2.0, -3.0, -1.0, -2.0, -2.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -3.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.465125766404837, "mean_inference_ms": 5.236288705700449, "mean_action_processing_ms": 2.749405335330074, "mean_env_wait_ms": 18.99100273326574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12802815437316895, "StateBufferConnector_ms": 0.0460209846496582, "ViewRequirementAgentConnector_ms": 0.6914987564086914}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.455, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 776.9110761540873, "num_env_steps_trained_throughput_per_sec": 776.9110761540873, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 5330.698, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5330.698, "sample_time_ms": 4382.855, "learn_time_ms": 917.649, "learn_throughput": 4358.966, "synch_weights_time_ms": 29.194}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "07611_00000", "date": "2024-09-11_17-45-35", "timestamp": 1726069535, "time_this_iter_s": 5.157628059387207, "time_total_s": 312.43528938293457, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE166D40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 312.43528938293457, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 59.37142857142857, "ram_util_percent": 88.64285714285714, "gpu_util_percent0": 0.037142857142857144, "vram_util_percent0": 0.14787946428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10713139213621617, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0003, "total_loss": 0.006348260238883086, "policy_loss": -0.0018232602655189113, "vf_loss": 0.016171273263171314, "vf_explained_var": 0.8311405345797539, "kl": 0.0019409903017731267, "entropy": 0.7999752357602119, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2300.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.41, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.3525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -3.0, -1.0, -2.0, 0.5, -2.0, -1.0, -1.0, -2.0, -2.0, -2.0, -3.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -2.0, -3.0, -1.0, -2.0, -2.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -3.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -0.5, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -2.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.451065718174172, "mean_inference_ms": 5.23486124503762, "mean_action_processing_ms": 2.744940187381705, "mean_env_wait_ms": 18.993347543766898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12825870513916016, "StateBufferConnector_ms": 0.03702807426452637, "ViewRequirementAgentConnector_ms": 0.6613388061523438}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.41, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 793.7905625445635, "num_env_steps_trained_throughput_per_sec": 793.7905625445635, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 5273.975, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5273.975, "sample_time_ms": 4331.675, "learn_time_ms": 912.126, "learn_throughput": 4385.361, "synch_weights_time_ms": 29.177}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "07611_00000", "date": "2024-09-11_17-45-40", "timestamp": 1726069540, "time_this_iter_s": 5.048320293426514, "time_total_s": 317.4836096763611, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE108820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 317.4836096763611, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 65.56666666666666, "ram_util_percent": 88.64999999999999, "gpu_util_percent0": 0.023333333333333334, "vram_util_percent0": 0.14540608723958334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09931118376553058, "cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0003, "total_loss": 0.0066026358588715086, "policy_loss": -0.0024449688382446764, "vf_loss": 0.016836869018152355, "vf_explained_var": 0.8124774888157844, "kl": 0.0032508952032003434, "entropy": 0.7789264217019081, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2340.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.425, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.35625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -2.0, -3.0, -1.0, -2.0, -2.0, -2.0, -1.0, -2.0, -1.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -3.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -0.5, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -2.0, -2.0, -2.0, -3.0, -2.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -2.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.449330460734403, "mean_inference_ms": 5.225124438858558, "mean_action_processing_ms": 2.7426618826308493, "mean_env_wait_ms": 18.94995706879399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1137702465057373, "StateBufferConnector_ms": 0.031023025512695312, "ViewRequirementAgentConnector_ms": 0.6276133060455322}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -3.0, "episode_return_mean": -1.425, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 781.2264076923059, "num_env_steps_trained_throughput_per_sec": 781.2264076923059, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 5241.82, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5241.82, "sample_time_ms": 4299.666, "learn_time_ms": 912.099, "learn_throughput": 4385.491, "synch_weights_time_ms": 29.058}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "07611_00000", "date": "2024-09-11_17-45-45", "timestamp": 1726069545, "time_this_iter_s": 5.128153085708618, "time_total_s": 322.6117627620697, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE167250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 322.6117627620697, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 59.300000000000004, "ram_util_percent": 88.17142857142858, "gpu_util_percent0": 0.027142857142857142, "vram_util_percent0": 0.14449637276785715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11487280987203122, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0003, "total_loss": 0.017064777214545756, "policy_loss": -0.00234843541184091, "vf_loss": 0.02705402164719999, "vf_explained_var": 0.7563673332333565, "kl": 0.002805238098153495, "entropy": 0.7640808790922164, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2380.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.325, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.33125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -2.0, -2.0, -2.0, -3.0, -2.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -2.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.0, -2.0, -2.0, -1.0, -2.0, -1.5, -2.0, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.0, -3.0, -1.0, -1.0, -1.0, 0.5, -1.0, -3.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, 0.5, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, 0.5, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.437565878859255, "mean_inference_ms": 5.219115824361861, "mean_action_processing_ms": 2.73843628659275, "mean_env_wait_ms": 18.92437267322763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.13586044311523438, "StateBufferConnector_ms": 0.040117740631103516, "ViewRequirementAgentConnector_ms": 0.6659059524536133}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.325, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 715.225552130221, "num_env_steps_trained_throughput_per_sec": 715.225552130221, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 5286.45, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5286.45, "sample_time_ms": 4336.932, "learn_time_ms": 919.588, "learn_throughput": 4349.775, "synch_weights_time_ms": 28.931}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "07611_00000", "date": "2024-09-11_17-45-51", "timestamp": 1726069551, "time_this_iter_s": 5.601672172546387, "time_total_s": 328.2134349346161, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10BF40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 328.2134349346161, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 67.48571428571428, "ram_util_percent": 87.62857142857145, "gpu_util_percent0": 0.06857142857142857, "vram_util_percent0": 0.14627511160714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1095900546759367, "cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0003, "total_loss": 0.009006273944396525, "policy_loss": -0.0021945153846900213, "vf_loss": 0.019028556859120728, "vf_explained_var": 0.837245200574398, "kl": 0.0021814153017203353, "entropy": 0.7827767714858055, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2420.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.255, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.31375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -1.0, -1.0, -2.0, -2.0, -1.0, -2.0, -1.5, -2.0, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.0, -3.0, -1.0, -1.0, -1.0, 0.5, -1.0, -3.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, 0.5, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, 0.5, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -2.0, -2.5, 0.5, -1.0, -1.0, -2.0, -1.0, -1.0, 0.5, 0.5, -2.0, -2.0, -2.0, -2.5, -2.5, -1.0, -2.0, -2.0, -2.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.434937637786863, "mean_inference_ms": 5.218774378017482, "mean_action_processing_ms": 2.7377407006097707, "mean_env_wait_ms": 18.923591700456885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1371746063232422, "StateBufferConnector_ms": 0.03711724281311035, "ViewRequirementAgentConnector_ms": 0.6783685684204102}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.255, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 734.3271300552457, "num_env_steps_trained_throughput_per_sec": 734.3271300552457, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 5309.075, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5309.075, "sample_time_ms": 4362.33, "learn_time_ms": 916.231, "learn_throughput": 4365.713, "synch_weights_time_ms": 29.516}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "07611_00000", "date": "2024-09-11_17-45-56", "timestamp": 1726069556, "time_this_iter_s": 5.45916223526001, "time_total_s": 333.6725971698761, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE108820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 333.6725971698761, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 65.7, "ram_util_percent": 87.92857142857143, "gpu_util_percent0": 0.06571428571428571, "vram_util_percent0": 0.14878627232142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10577153898775578, "cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0003, "total_loss": 0.008091519377194345, "policy_loss": -0.0015377202566014604, "vf_loss": 0.017408372764475644, "vf_explained_var": 0.8195306777954101, "kl": 0.0017303824170539883, "entropy": 0.7779133647680283, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2460.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.21, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.3025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -1.0, -1.0, 0.5, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, 0.5, -1.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -2.0, -2.5, 0.5, -1.0, -1.0, -2.0, -1.0, -1.0, 0.5, 0.5, -2.0, -2.0, -2.0, -2.5, -2.5, -1.0, -2.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -2.0, -2.0, 0.5, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -3.0, -0.5, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.427368909264347, "mean_inference_ms": 5.222366698775786, "mean_action_processing_ms": 2.73705025323769, "mean_env_wait_ms": 18.947720834211022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.13831734657287598, "StateBufferConnector_ms": 0.03524327278137207, "ViewRequirementAgentConnector_ms": 0.6747291088104248}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.21, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 678.4057068644133, "num_env_steps_trained_throughput_per_sec": 678.4057068644133, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 5343.25, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5343.25, "sample_time_ms": 4392.461, "learn_time_ms": 920.277, "learn_throughput": 4346.516, "synch_weights_time_ms": 29.491}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "07611_00000", "date": "2024-09-11_17-46-02", "timestamp": 1726069562, "time_this_iter_s": 5.906405210494995, "time_total_s": 339.5790023803711, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE1F27A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 339.5790023803711, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 64.7875, "ram_util_percent": 87.8875, "gpu_util_percent0": 0.055, "vram_util_percent0": 0.1478118896484375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10149056632071733, "cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0003, "total_loss": 0.0037273966570865015, "policy_loss": -0.0015221413697872777, "vf_loss": 0.012978498823940754, "vf_explained_var": 0.8525919258594513, "kl": 0.001854305058918726, "entropy": 0.7728961080312728, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 2500.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -1.21, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.3025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -2.0, -2.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -2.0, -2.0, -2.5, 0.5, -1.0, -1.0, -2.0, -1.0, -1.0, 0.5, 0.5, -2.0, -2.0, -2.0, -2.5, -2.5, -1.0, -2.0, -2.0, -2.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -2.0, -2.0, 0.5, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -3.0, -0.5, -1.0, -1.0, -2.0, -2.0, -1.0, -1.0, -2.0, -1.0, -2.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -2.0, -1.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.433989851589008, "mean_inference_ms": 5.217959269247748, "mean_action_processing_ms": 2.73710526977537, "mean_env_wait_ms": 18.92248806669753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10809516906738281, "StateBufferConnector_ms": 0.04518747329711914, "ViewRequirementAgentConnector_ms": 0.6660003662109375}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -1.21, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 784.4304643864879, "num_env_steps_trained_throughput_per_sec": 784.4304643864879, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 5291.951, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5291.951, "sample_time_ms": 4340.545, "learn_time_ms": 920.36, "learn_throughput": 4346.127, "synch_weights_time_ms": 30.025}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "07611_00000", "date": "2024-09-11_17-46-08", "timestamp": 1726069568, "time_this_iter_s": 5.10840106010437, "time_total_s": 344.68740344047546, "pid": 17488, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000001E5EE10BF40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 344.68740344047546, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 65.28333333333333, "ram_util_percent": 87.86666666666667, "gpu_util_percent0": 0.06, "vram_util_percent0": 0.14737955729166666}}
