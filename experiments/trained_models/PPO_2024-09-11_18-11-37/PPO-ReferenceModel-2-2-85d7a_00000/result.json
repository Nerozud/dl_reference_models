{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6330664910376071, "cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 0.044549991562962535, "policy_loss": -0.001242387002275791, "vf_loss": 0.05866863392293453, "vf_explained_var": -0.001635301113128662, "kl": 0.002016033936160966, "entropy": 1.3279462814331056, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 5.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7062925636768341, "cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 0.045646334812045095, "policy_loss": -0.0016732010706618893, "vf_loss": 0.05889291577041149, "vf_explained_var": -0.0006761610507965088, "kl": 0.001755106022574182, "entropy": 1.1924402475357057, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 5.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7349911838769912, "cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 0.04251864217221737, "policy_loss": -0.0030352182717251707, "vf_loss": 0.05646982081234455, "vf_explained_var": -0.0014248013496398926, "kl": 0.0032675869158083513, "entropy": 1.1569480776786805, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 5.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8298140481114388, "cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 0.042415231093764307, "policy_loss": -0.002771081960236188, "vf_loss": 0.05754859074950218, "vf_explained_var": 0.007524317502975464, "kl": 0.003268903485695773, "entropy": 1.301606047153473, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 5.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -3.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.90625, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 3200, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.953125, "agent_1": -1.0, "agent_2": -0.953125, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_1_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_2_reward": [-1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.53252485063341, "mean_inference_ms": 22.537896793986125, "mean_action_processing_ms": 3.191637614416698, "mean_env_wait_ms": 23.121783894205848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07277410477399826, "StateBufferConnector_ms": 0.016486644744873047, "ViewRequirementAgentConnector_ms": 0.18584765493869781}, "num_episodes": 32, "episode_return_max": -3.5, "episode_return_min": -4.0, "episode_return_mean": -3.90625, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 460.305038633217, "num_env_steps_trained_throughput_per_sec": 460.305038633217, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 8689.89, "restore_workers_time_ms": 0.0, "training_step_time_ms": 8689.89, "sample_time_ms": 7613.029, "learn_time_ms": 1035.939, "learn_throughput": 3861.233, "synch_weights_time_ms": 40.923}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "85d7a_00000", "date": "2024-09-11_18-12-27", "timestamp": 1726071147, "time_this_iter_s": 8.72030234336853, "time_total_s": 8.72030234336853, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67D71360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.72030234336853, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 71.63333333333334, "ram_util_percent": 86.50833333333333, "gpu_util_percent0": 0.09999999999999999, "vram_util_percent0": 0.09706624348958333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49031095653772355, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 0.02730324026197195, "policy_loss": -0.0014029445650521667, "vf_loss": 0.041810760647058486, "vf_explained_var": -0.009332811832427979, "kl": 0.0013850043847924098, "entropy": 1.3243077158927918, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 15.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4963423267006874, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 0.032481631450355056, "policy_loss": -0.0005579297328949905, "vf_loss": 0.0444758590310812, "vf_explained_var": 0.0013796865940093994, "kl": 0.0009740219531522599, "entropy": 1.1533698558807373, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 15.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5435769706964493, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 0.02869419362396002, "policy_loss": -0.0007051708668257106, "vf_loss": 0.04180276580154896, "vf_explained_var": -0.019875967502593996, "kl": 0.0005023947509471327, "entropy": 1.2453641533851623, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 15.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5380595743656158, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 0.026723552495241165, "policy_loss": -0.0013052818115284026, "vf_loss": 0.04067136347293854, "vf_explained_var": 0.014125669002532959, "kl": 0.001904168385954108, "entropy": 1.2832945108413696, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 15.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -2.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.90625, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 6400, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.953125, "agent_1": -1.0, "agent_2": -0.953125, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0], "policy_agent_1_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_2_reward": [-1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.107600184972965, "mean_inference_ms": 21.62825020391409, "mean_action_processing_ms": 3.0602760768921264, "mean_env_wait_ms": 22.20799976816472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06169173866510391, "StateBufferConnector_ms": 0.016220752149820328, "ViewRequirementAgentConnector_ms": 0.18500229343771935}, "num_episodes": 32, "episode_return_max": -2.5, "episode_return_min": -4.0, "episode_return_mean": -3.90625, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 536.0789903836138, "num_env_steps_trained_throughput_per_sec": 536.0789903836138, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 8075.738, "restore_workers_time_ms": 0.0, "training_step_time_ms": 8075.738, "sample_time_ms": 7007.664, "learn_time_ms": 1026.942, "learn_throughput": 3895.06, "synch_weights_time_ms": 40.133}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "85d7a_00000", "date": "2024-09-11_18-12-48", "timestamp": 1726071168, "time_this_iter_s": 7.487619400024414, "time_total_s": 16.207921743392944, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002A9D81379A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.207921743392944, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.80769230769231, "ram_util_percent": 90.33846153846153, "gpu_util_percent0": 0.07500000000000001, "vram_util_percent0": 0.09759521484375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.29395470321178435, "cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 0.02123192884027958, "policy_loss": -0.0013724772099521943, "vf_loss": 0.03562840558588505, "vf_explained_var": -0.002772057056427002, "kl": 0.002390161272342084, "entropy": 1.3143507480621337, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 25.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.29765860438346864, "cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 0.02246754802763462, "policy_loss": -0.003040197138761869, "vf_loss": 0.03771247044205665, "vf_explained_var": 0.008290529251098633, "kl": 0.002107412262193975, "entropy": 1.2310097932815551, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 25.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3348012238740921, "cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 0.02040945179760456, "policy_loss": -9.656011916376883e-05, "vf_loss": 0.0331514697521925, "vf_explained_var": -0.010797679424285889, "kl": 0.0005538568688280065, "entropy": 1.2673150658607484, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 25.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38737945407629015, "cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 0.014585941284894943, "policy_loss": -0.0017723730736179278, "vf_loss": 0.02858519684523344, "vf_explained_var": 0.06993921995162963, "kl": 0.0019581185741117226, "entropy": 1.232478666305542, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 25.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -2.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.8802083333333335, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 9600, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": -1.0, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.921875, "agent_1": -1.0, "agent_2": -0.9583333333333334, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0], "policy_agent_1_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_2_reward": [-1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.91792696491351, "mean_inference_ms": 21.13476370140695, "mean_action_processing_ms": 3.0015653327827203, "mean_env_wait_ms": 21.7734256163194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05506575107574463, "StateBufferConnector_ms": 0.01892298460006714, "ViewRequirementAgentConnector_ms": 0.19028875976800919}, "num_episodes": 32, "episode_return_max": -2.5, "episode_return_min": -4.0, "episode_return_mean": -3.8802083333333335, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 534.8990089431272, "num_env_steps_trained_throughput_per_sec": 534.8990089431272, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 7876.508, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7876.508, "sample_time_ms": 6848.479, "learn_time_ms": 982.358, "learn_throughput": 4071.833, "synch_weights_time_ms": 44.326}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "85d7a_00000", "date": "2024-09-11_18-12-56", "timestamp": 1726071176, "time_this_iter_s": 7.517687797546387, "time_total_s": 23.72560954093933, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67DDD870>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.72560954093933, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 67.14, "ram_util_percent": 91.91, "gpu_util_percent0": 0.11000000000000001, "vram_util_percent0": 0.0965087890625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6112706884741783, "cur_kl_coeff": 0.025, "cur_lr": 0.0003, "total_loss": 0.034881418384611604, "policy_loss": -0.002783645179533778, "vf_loss": 0.05032747127115726, "vf_explained_var": 0.011047297716140747, "kl": 0.002913465905294288, "entropy": 1.2735244393348695, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 35.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7440525770187378, "cur_kl_coeff": 0.025, "cur_lr": 0.0003, "total_loss": 0.03675507791340351, "policy_loss": -0.0025437274074647576, "vf_loss": 0.050547700747847556, "vf_explained_var": 0.02501358389854431, "kl": 0.004660110696568154, "entropy": 1.1365398287773132, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 35.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6646147772669793, "cur_kl_coeff": 0.025, "cur_lr": 0.0003, "total_loss": 0.03145403116941452, "policy_loss": -0.0014036297317943536, "vf_loss": 0.04481165818870068, "vf_explained_var": -0.010697925090789795, "kl": 0.0007916819996353297, "entropy": 1.1973791480064393, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 35.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6922030791640281, "cur_kl_coeff": 0.025, "cur_lr": 0.0003, "total_loss": 0.02379002645611763, "policy_loss": -0.001116052876750473, "vf_loss": 0.03688467554748058, "vf_explained_var": 0.10098348259925842, "kl": 0.0029067882143863242, "entropy": 1.2051268696784974, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 35.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -2.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.77, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": -0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.885, "agent_1": -0.965, "agent_2": -0.92, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -2.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.0, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -2.0, -4.0, -4.0, -2.5, -3.0, -3.5, -4.0, -3.0, -3.5, -3.5, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0], "policy_agent_1_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0], "policy_agent_2_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.435075098457553, "mean_inference_ms": 20.13532307503223, "mean_action_processing_ms": 2.889541633455833, "mean_env_wait_ms": 20.730482050152233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0409468412399292, "StateBufferConnector_ms": 0.015760362148284912, "ViewRequirementAgentConnector_ms": 0.18009346723556519}, "num_episodes": 64, "episode_return_max": -2.0, "episode_return_min": -4.0, "episode_return_mean": -3.77, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 520.0713266920964, "num_env_steps_trained_throughput_per_sec": 520.0713266920964, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 7830.194, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7830.194, "sample_time_ms": 6803.475, "learn_time_ms": 981.501, "learn_throughput": 4075.389, "synch_weights_time_ms": 43.958}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "85d7a_00000", "date": "2024-09-11_18-13-04", "timestamp": 1726071184, "time_this_iter_s": 7.726402282714844, "time_total_s": 31.452011823654175, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67DDD7E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.452011823654175, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 67.4, "ram_util_percent": 91.9, "gpu_util_percent0": 0.12400000000000003, "vram_util_percent0": 0.09552001953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2577017121016979, "cur_kl_coeff": 0.0125, "cur_lr": 0.0003, "total_loss": 0.005716645950451493, "policy_loss": -0.0014221541189272102, "vf_loss": 0.01901893746107817, "vf_explained_var": -0.008676528930664062, "kl": 0.002396221701201284, "entropy": 1.191008973121643, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33162809908390045, "cur_kl_coeff": 0.0125, "cur_lr": 0.0003, "total_loss": 0.011028629913926124, "policy_loss": -0.000474649924399273, "vf_loss": 0.020474617555737495, "vf_explained_var": -0.0021490216255187987, "kl": 0.00045427861405187284, "entropy": 0.8977015733718872, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.39058062732219695, "cur_kl_coeff": 0.0125, "cur_lr": 0.0003, "total_loss": 0.012134445738047362, "policy_loss": -0.00018343810761507485, "vf_loss": 0.02419626750051975, "vf_explained_var": -0.045048415660858154, "kl": 0.0010272463341607363, "entropy": 1.1891224145889283, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.29315565824508666, "cur_kl_coeff": 0.0125, "cur_lr": 0.0003, "total_loss": 0.001448579307179898, "policy_loss": -0.0005449848984426353, "vf_loss": 0.014579739980399608, "vf_explained_var": 0.23057892322540283, "kl": 0.0004937270736263599, "entropy": 1.2592347621917725, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -2.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.77, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.93, "agent_1": -0.915, "agent_2": -0.925, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -2.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.0, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -2.0, -4.0, -4.0, -2.5, -3.0, -3.5, -4.0, -3.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -2.5, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -2.5, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_1_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5], "policy_agent_2_reward": [-1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.359738796893467, "mean_inference_ms": 20.044280681988397, "mean_action_processing_ms": 2.8830417373728174, "mean_env_wait_ms": 20.496090588262483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03720957040786743, "StateBufferConnector_ms": 0.012771368026733398, "ViewRequirementAgentConnector_ms": 0.1805775761604309}, "num_episodes": 32, "episode_return_max": -2.0, "episode_return_min": -4.0, "episode_return_mean": -3.77, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.160203552936, "num_env_steps_trained_throughput_per_sec": 549.160203552936, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 7720.925, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7720.925, "sample_time_ms": 6711.968, "learn_time_ms": 963.421, "learn_throughput": 4151.869, "synch_weights_time_ms": 44.328}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "85d7a_00000", "date": "2024-09-11_18-13-11", "timestamp": 1726071191, "time_this_iter_s": 7.319746017456055, "time_total_s": 38.77175784111023, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002A9D81379A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.77175784111023, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 71.06666666666666, "ram_util_percent": 91.88888888888889, "gpu_util_percent0": 0.14444444444444446, "vram_util_percent0": 0.09716796875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.14658509343862533, "cur_kl_coeff": 0.00625, "cur_lr": 0.0003, "total_loss": 0.006847196770831942, "policy_loss": -0.0006007710646372289, "vf_loss": 0.01772609315812588, "vf_explained_var": -0.00794491171836853, "kl": 0.001033867114165332, "entropy": 1.0284586310386659, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 55.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16007325276732445, "cur_kl_coeff": 0.00625, "cur_lr": 0.0003, "total_loss": 0.012861838936805725, "policy_loss": -0.0005392722825490637, "vf_loss": 0.02119776327162981, "vf_explained_var": -0.03291487693786621, "kl": 0.0005400853671744699, "entropy": 0.7800027370452881, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 55.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.25431668013334274, "cur_kl_coeff": 0.00625, "cur_lr": 0.0003, "total_loss": 0.015364913549274207, "policy_loss": -0.002259308694192441, "vf_loss": 0.028914820961654188, "vf_explained_var": -0.06938605308532715, "kl": 0.001503316329581139, "entropy": 1.12999929189682, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 55.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.23094683289527893, "cur_kl_coeff": 0.00625, "cur_lr": 0.0003, "total_loss": -0.002281493169721216, "policy_loss": -0.0037001480166509284, "vf_loss": 0.013813944719731807, "vf_explained_var": 0.20406538844108582, "kl": 0.0030551150241080903, "entropy": 1.241438639163971, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 55.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -2.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.745, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.935, "agent_1": -0.855, "agent_2": -0.955, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -2.0, -4.0, -4.0, -2.5, -3.0, -3.5, -4.0, -3.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -2.5, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -2.5, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -2.5, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -3.5, -2.5, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -3.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_1_reward": [-1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0], "policy_agent_2_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.35029065445434, "mean_inference_ms": 20.082227426925236, "mean_action_processing_ms": 2.883452489651234, "mean_env_wait_ms": 20.329923011800584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03797405958175659, "StateBufferConnector_ms": 0.011224150657653809, "ViewRequirementAgentConnector_ms": 0.17285597324371338}, "num_episodes": 32, "episode_return_max": -2.0, "episode_return_min": -4.0, "episode_return_mean": -3.745, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 506.0683379224879, "num_env_steps_trained_throughput_per_sec": 506.0683379224879, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 7751.449, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7751.349, "sample_time_ms": 6737.137, "learn_time_ms": 968.292, "learn_throughput": 4130.987, "synch_weights_time_ms": 44.747}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "85d7a_00000", "date": "2024-09-11_18-13-19", "timestamp": 1726071199, "time_this_iter_s": 7.938762426376343, "time_total_s": 46.71052026748657, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67DDF010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46.71052026748657, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 74.86999999999999, "ram_util_percent": 91.44, "gpu_util_percent0": 0.131, "vram_util_percent0": 0.09754638671875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1060590274631977, "cur_kl_coeff": 0.003125, "cur_lr": 0.0003, "total_loss": 0.008640569169074297, "policy_loss": -0.0003566133598724264, "vf_loss": 0.018351119197905063, "vf_explained_var": -0.0007954597473144531, "kl": 0.0004189760080407723, "entropy": 0.9355246543884277, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 65.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11235851868987083, "cur_kl_coeff": 0.003125, "cur_lr": 0.0003, "total_loss": 0.010758911166340113, "policy_loss": -0.00042840150201897134, "vf_loss": 0.017947941832244397, "vf_explained_var": -0.0012479901313781738, "kl": 0.0007425755319218297, "entropy": 0.6762950003147126, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 65.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.31746987253427505, "cur_kl_coeff": 0.003125, "cur_lr": 0.0003, "total_loss": 0.023918803222477435, "policy_loss": -0.0034408450959745097, "vf_loss": 0.03773754350841045, "vf_explained_var": -0.04623126983642578, "kl": 0.0037437067046994345, "entropy": 1.0389594316482544, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 65.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18256415277719498, "cur_kl_coeff": 0.003125, "cur_lr": 0.0003, "total_loss": 0.0010647881092154421, "policy_loss": -0.0027270930919257807, "vf_loss": 0.016377978958189487, "vf_explained_var": 0.1684614062309265, "kl": 0.0017516692729259375, "entropy": 1.2591571450233459, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 65.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": -1.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.755, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": -0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.965, "agent_1": -0.81, "agent_2": -0.98, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -2.5, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -2.5, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -2.5, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -3.5, -2.5, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -3.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -1.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_1_reward": [-1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0], "policy_agent_2_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.45807198237605, "mean_inference_ms": 20.268021637879414, "mean_action_processing_ms": 2.9120355100378514, "mean_env_wait_ms": 20.177175535357737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03471410274505615, "StateBufferConnector_ms": 0.014924347400665283, "ViewRequirementAgentConnector_ms": 0.20181971788406372}, "num_episodes": 32, "episode_return_max": -1.5, "episode_return_min": -4.0, "episode_return_mean": -3.755, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 470.5167700736677, "num_env_steps_trained_throughput_per_sec": 470.5167700736677, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 7858.57, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7858.483, "sample_time_ms": 6854.039, "learn_time_ms": 959.114, "learn_throughput": 4170.516, "synch_weights_time_ms": 44.325}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "85d7a_00000", "date": "2024-09-11_18-13-28", "timestamp": 1726071208, "time_this_iter_s": 8.52764105796814, "time_total_s": 55.23816132545471, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67E452D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.23816132545471, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 78.28181818181818, "ram_util_percent": 92.12727272727273, "gpu_util_percent0": 0.23090909090909092, "vram_util_percent0": 0.0938720703125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4401283092796803, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0003, "total_loss": 0.01841165740042925, "policy_loss": -0.0004339188732956245, "vf_loss": 0.027538525126874446, "vf_explained_var": 0.03578022122383118, "kl": 0.00040830927027855066, "entropy": 0.8693585216999054, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 75.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38250688910484315, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0003, "total_loss": 0.024497338756918906, "policy_loss": -0.00016694780515535967, "vf_loss": 0.03159941472113133, "vf_explained_var": 0.0096774160861969, "kl": 0.0008153705446602543, "entropy": 0.6936403930187225, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 75.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4732543110847473, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0003, "total_loss": 0.043087111040949824, "policy_loss": -0.0016040334470091011, "vf_loss": 0.05383625999093056, "vf_explained_var": 0.0802039623260498, "kl": 0.0022989344339293893, "entropy": 0.9148708462715149, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 75.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4508935160934925, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0003, "total_loss": 0.016807740554213524, "policy_loss": -0.0012355597838904942, "vf_loss": 0.030597934685647487, "vf_explained_var": -0.011489713191986084, "kl": 0.0032108268867887093, "entropy": 1.2559651136398315, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 75.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -1.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.67, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": -0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.975, "agent_1": -0.715, "agent_2": -0.98, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -1.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -2.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_1_reward": [-1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5], "policy_agent_2_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.58930748216212, "mean_inference_ms": 20.573420988400017, "mean_action_processing_ms": 2.9587729967266143, "mean_env_wait_ms": 19.941278029220758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036392033100128174, "StateBufferConnector_ms": 0.021942496299743652, "ViewRequirementAgentConnector_ms": 0.20878863334655762}, "num_episodes": 64, "episode_return_max": -1.5, "episode_return_min": -4.0, "episode_return_mean": -3.67, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 555.2706259927978, "num_env_steps_trained_throughput_per_sec": 555.2706259927978, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 7776.71, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7776.635, "sample_time_ms": 6767.015, "learn_time_ms": 963.832, "learn_throughput": 4150.102, "synch_weights_time_ms": 44.713}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "85d7a_00000", "date": "2024-09-11_18-13-35", "timestamp": 1726071215, "time_this_iter_s": 7.239498853683472, "time_total_s": 62.477660179138184, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67E464D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 62.477660179138184, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 68.8111111111111, "ram_util_percent": 91.96666666666667, "gpu_util_percent0": 0.07777777777777778, "vram_util_percent0": 0.0923800998263889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.27588340938091277, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0003, "total_loss": 0.0030529343988746406, "policy_loss": -0.0015193053775874432, "vf_loss": 0.01366884596645832, "vf_explained_var": 0.05985251069068909, "kl": 0.002650035913757165, "entropy": 0.9098678231239319, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 85.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.21808564886450768, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0003, "total_loss": 0.007495777029544115, "policy_loss": -0.0006406864124073764, "vf_loss": 0.015136200841516257, "vf_explained_var": -0.0013183116912841796, "kl": 0.0005944484772044234, "entropy": 0.700020170211792, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 85.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5600376904010773, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0003, "total_loss": 0.020875953324139118, "policy_loss": -0.003691157832508907, "vf_loss": 0.0331259336322546, "vf_explained_var": 0.2885954797267914, "kl": 0.0022938668796996355, "entropy": 0.8560615718364716, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 85.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2249329887330532, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0003, "total_loss": 0.0007548602672613925, "policy_loss": -0.0007273640716448426, "vf_loss": 0.013873279560357332, "vf_explained_var": 0.05173298716545105, "kl": 0.0009706669945444446, "entropy": 1.2391815185546875, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 85.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": -1.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.57, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": -0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.96, "agent_1": -0.63, "agent_2": -0.98, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -2.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -1.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0], "policy_agent_1_reward": [-0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0], "policy_agent_2_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.579271881135398, "mean_inference_ms": 20.518758384922286, "mean_action_processing_ms": 2.9514498296682756, "mean_env_wait_ms": 19.727331021393677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04210907220840454, "StateBufferConnector_ms": 0.020563721656799316, "ViewRequirementAgentConnector_ms": 0.19854092597961426}, "num_episodes": 32, "episode_return_max": -1.5, "episode_return_min": -4.0, "episode_return_mean": -3.57, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.6041338547468, "num_env_steps_trained_throughput_per_sec": 544.6041338547468, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 7728.718, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7728.651, "sample_time_ms": 6720.962, "learn_time_ms": 962.986, "learn_throughput": 4153.745, "synch_weights_time_ms": 43.747}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "85d7a_00000", "date": "2024-09-11_18-13-42", "timestamp": 1726071222, "time_this_iter_s": 7.3724400997161865, "time_total_s": 69.85010027885437, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67DDCAF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.85010027885437, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 67.5, "ram_util_percent": 92.28, "gpu_util_percent0": 0.156, "vram_util_percent0": 0.09619140625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10421141535043717, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0003, "total_loss": 0.005280205840244889, "policy_loss": -0.00011240998965149629, "vf_loss": 0.014553680922836066, "vf_explained_var": 0.04262232780456543, "kl": 0.00034547624200058634, "entropy": 0.9161199927330017, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 95.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.25356726795434953, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0003, "total_loss": 0.007011005468666553, "policy_loss": -0.003919386650522938, "vf_loss": 0.01856928560882807, "vf_explained_var": 0.014245671033859254, "kl": 0.005593912384210853, "entropy": 0.7641078472137451, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 95.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3778292864561081, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0003, "total_loss": 0.02313705924898386, "policy_loss": -0.001330964791122824, "vf_loss": 0.03159543741494417, "vf_explained_var": 0.4158852338790894, "kl": 0.0013021790626225993, "entropy": 0.712792181968689, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 95.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16718094646930695, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0003, "total_loss": 0.0012974811543244869, "policy_loss": -0.0026764757276396267, "vf_loss": 0.015297640673816204, "vf_explained_var": -0.00351330041885376, "kl": 0.003014948599229683, "entropy": 1.1324861288070678, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 95.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": -1.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.515, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": -0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.955, "agent_1": -0.58, "agent_2": -0.98, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -1.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -2.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_1_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5], "policy_agent_2_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.563036495247953, "mean_inference_ms": 20.457808238350967, "mean_action_processing_ms": 2.951027548627246, "mean_env_wait_ms": 19.496593741470534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039219558238983154, "StateBufferConnector_ms": 0.016774475574493408, "ViewRequirementAgentConnector_ms": 0.20332443714141846}, "num_episodes": 32, "episode_return_max": -1.5, "episode_return_min": -4.0, "episode_return_mean": -3.515, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 568.0284638286623, "num_env_steps_trained_throughput_per_sec": 568.0284638286623, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 7660.037, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7659.976, "sample_time_ms": 6659.071, "learn_time_ms": 956.976, "learn_throughput": 4179.833, "synch_weights_time_ms": 42.968}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "85d7a_00000", "date": "2024-09-11_18-13-49", "timestamp": 1726071229, "time_this_iter_s": 7.071943044662476, "time_total_s": 76.92204332351685, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002A9D81379A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 76.92204332351685, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 67.61111111111111, "ram_util_percent": 92.39999999999999, "gpu_util_percent0": 0.08666666666666667, "vram_util_percent0": 0.09490288628472222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17061440646648407, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0003, "total_loss": 0.008585841674357653, "policy_loss": -0.00041541895770933477, "vf_loss": 0.01775500550866127, "vf_explained_var": 0.04531503915786743, "kl": 0.00017744766928444732, "entropy": 0.875377744436264, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.27910918444395066, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0003, "total_loss": 0.0147267896682024, "policy_loss": -0.0030028570356080307, "vf_loss": 0.024944746121764182, "vf_explained_var": -0.0050847530364990234, "kl": 0.0012936215032823383, "entropy": 0.7215605854988099, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.26995738297700883, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0003, "total_loss": 0.018673654273152353, "policy_loss": -0.00154230629614176, "vf_loss": 0.026883522421121596, "vf_explained_var": 0.515804922580719, "kl": 0.0023446147208233013, "entropy": 0.6668018996715546, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1288497805595398, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0003, "total_loss": 0.004293885990045964, "policy_loss": -0.0007448040414601564, "vf_loss": 0.015254934132099152, "vf_explained_var": 0.03637189269065857, "kl": 0.000921565614407882, "entropy": 1.0216424822807313, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": -1.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.44, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": -0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.925, "agent_1": -0.55, "agent_2": -0.965, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -1.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -2.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -1.5, -3.5, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.0, -3.5, -2.0, -3.5, -3.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0], "policy_agent_1_reward": [-1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_2_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.56998642244008, "mean_inference_ms": 20.39384629030825, "mean_action_processing_ms": 2.9368446982774445, "mean_env_wait_ms": 19.25415381377953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04365253448486328, "StateBufferConnector_ms": 0.015521705150604248, "ViewRequirementAgentConnector_ms": 0.22970473766326904}, "num_episodes": 32, "episode_return_max": -1.5, "episode_return_min": -4.0, "episode_return_mean": -3.44, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 548.6911413930446, "num_env_steps_trained_throughput_per_sec": 548.6911413930446, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 7520.055, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7519.995, "sample_time_ms": 6532.996, "learn_time_ms": 942.876, "learn_throughput": 4242.339, "synch_weights_time_ms": 43.05}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "85d7a_00000", "date": "2024-09-11_18-13-57", "timestamp": 1726071237, "time_this_iter_s": 7.316352844238281, "time_total_s": 84.23839616775513, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67DDCCA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 84.23839616775513, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 72.78888888888888, "ram_util_percent": 92.38888888888889, "gpu_util_percent0": 0.08888888888888889, "vram_util_percent0": 0.09366861979166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09398254975676537, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0003, "total_loss": 0.028259107656776906, "policy_loss": -0.0003245647940275376, "vf_loss": 0.03716438300907612, "vf_explained_var": 0.036559838056564334, "kl": 0.0009415089871254168, "entropy": 0.858080518245697, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 115.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.251067803055048, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0003, "total_loss": 0.030800607800483704, "policy_loss": -0.0004752765227749478, "vf_loss": 0.03867304176092148, "vf_explained_var": 0.025897502899169922, "kl": 0.002814200373904896, "entropy": 0.7397708535194397, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 115.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4984252482652664, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0003, "total_loss": 0.02939242944121361, "policy_loss": -0.0014241085948015098, "vf_loss": 0.03752283081412315, "vf_explained_var": 0.5542856872081756, "kl": 0.0027302225324092435, "entropy": 0.6706560373306274, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 115.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43219163864850996, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0003, "total_loss": 0.011529788933694362, "policy_loss": -0.0011771052013727968, "vf_loss": 0.022061824426054956, "vf_explained_var": 0.19061108827590942, "kl": 0.00205544378295599, "entropy": 0.9355131626129151, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 115.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -1.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.185, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.83, "agent_1": -0.51, "agent_2": -0.845, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -1.5, -3.5, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.0, -3.5, -2.0, -3.5, -3.5, -3.5, -3.0, -3.5, -2.5, -2.5, -3.5, -1.5, -3.0, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -1.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -1.0, -3.5, -3.5, -3.5, -3.5, -2.0, -3.5, -3.5, -3.5, -3.5, -1.5, -3.5, -1.5, -3.5, -3.5, -1.5, -1.5, -3.0, -3.5, -3.0, -3.5, -3.5, -4.0, -3.0, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.0, -3.5, -3.5, -3.5, -3.0, -3.0, -3.5, -1.5, -3.5, -3.5, -2.0, -3.5, -3.5, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5], "policy_agent_1_reward": [-0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_2_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.599656112311111, "mean_inference_ms": 20.5471561995872, "mean_action_processing_ms": 2.9358755906458214, "mean_env_wait_ms": 18.842720608008918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043726205825805664, "StateBufferConnector_ms": 0.014546751976013184, "ViewRequirementAgentConnector_ms": 0.23111683130264282}, "num_episodes": 64, "episode_return_max": -1.0, "episode_return_min": -4.0, "episode_return_mean": -3.185, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.8406597720852, "num_env_steps_trained_throughput_per_sec": 507.8406597720852, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 7561.551, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7561.485, "sample_time_ms": 6573.368, "learn_time_ms": 943.584, "learn_throughput": 4239.156, "synch_weights_time_ms": 43.56}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "85d7a_00000", "date": "2024-09-11_18-14-05", "timestamp": 1726071245, "time_this_iter_s": 7.912263631820679, "time_total_s": 92.1506597995758, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67E45240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 92.1506597995758, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 72.64, "ram_util_percent": 92.42, "gpu_util_percent0": 0.162, "vram_util_percent0": 0.09451904296875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17171795591711997, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0003, "total_loss": 0.012027369532734155, "policy_loss": -0.00018062491071759723, "vf_loss": 0.021880093961954117, "vf_explained_var": 0.023854583501815796, "kl": 0.00015152777305047494, "entropy": 0.9672107219696044, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 125.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3107184626162052, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0003, "total_loss": 0.0164771631360054, "policy_loss": -0.0015173541785770794, "vf_loss": 0.0264873081818223, "vf_explained_var": 0.04192659258842468, "kl": 0.0026309870067052544, "entropy": 0.8493047416210174, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 125.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.23453109040856362, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0003, "total_loss": 0.010500966291874646, "policy_loss": -0.0016553216915781376, "vf_loss": 0.019452968426048756, "vf_explained_var": 0.7376354336738586, "kl": 0.0016821389495817129, "entropy": 0.7296763241291047, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 125.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15926905125379562, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0003, "total_loss": -0.0014145357141387648, "policy_loss": -0.0006300760056774379, "vf_loss": 0.009068128746002912, "vf_explained_var": 0.39369089603424073, "kl": 0.0014238704858144046, "entropy": 0.9852657496929169, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 125.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": -1.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.045, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.77, "agent_1": -0.465, "agent_2": -0.81, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -3.5, -3.5, -3.5, -3.0, -3.5, -2.5, -2.5, -3.5, -1.5, -3.0, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -1.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -1.0, -3.5, -3.5, -3.5, -3.5, -2.0, -3.5, -3.5, -3.5, -3.5, -1.5, -3.5, -1.5, -3.5, -3.5, -1.5, -1.5, -3.0, -3.5, -3.0, -3.5, -3.5, -4.0, -3.0, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.0, -3.5, -3.5, -3.5, -3.0, -3.0, -3.5, -1.5, -3.5, -3.5, -2.0, -3.5, -3.5, -2.0, -3.5, -3.5, -3.5, -3.0, -3.5, -2.5, -3.5, -3.5, -3.0, -1.5, -3.5, -2.0, -3.0, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -2.0, -2.5, -2.0, -2.0, -3.0, -3.5, -1.5, -3.0, -3.5, -3.0, -3.0, -3.0, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0], "policy_agent_1_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_2_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.623537089400292, "mean_inference_ms": 20.6543467059608, "mean_action_processing_ms": 2.941836637123332, "mean_env_wait_ms": 18.7695076700646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04222136735916138, "StateBufferConnector_ms": 0.016294538974761963, "ViewRequirementAgentConnector_ms": 0.19733017683029175}, "num_episodes": 32, "episode_return_max": -1.0, "episode_return_min": -4.0, "episode_return_mean": -3.045, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 519.0176193648589, "num_env_steps_trained_throughput_per_sec": 519.0176193648589, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 7584.433, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7584.367, "sample_time_ms": 6594.064, "learn_time_ms": 947.38, "learn_throughput": 4222.173, "synch_weights_time_ms": 42.052}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "85d7a_00000", "date": "2024-09-11_18-14-13", "timestamp": 1726071253, "time_this_iter_s": 7.733238935470581, "time_total_s": 99.88389873504639, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67E46EF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 99.88389873504639, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 73.61, "ram_util_percent": 91.63, "gpu_util_percent0": 0.151, "vram_util_percent0": 0.09693603515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2544718474149704, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0003, "total_loss": 0.015134331677109003, "policy_loss": -0.002182239234025474, "vf_loss": 0.026396096870303153, "vf_explained_var": 0.10052470564842224, "kl": 0.0017353451886947368, "entropy": 0.9079569816589356, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.268354506790638, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0003, "total_loss": 0.022890904545783998, "policy_loss": -0.0005964304466033355, "vf_loss": 0.03217257633805275, "vf_explained_var": 0.12768856883049012, "kl": 0.0007606275488797109, "entropy": 0.8685278475284577, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2076622262597084, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0003, "total_loss": 0.009598955232650041, "policy_loss": -0.0035470013470330743, "vf_loss": 0.02099399548023939, "vf_explained_var": 0.7442468166351318, "kl": 0.0039972559367015496, "entropy": 0.7848137378692627, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16462312638759613, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0003, "total_loss": -0.002921308984514326, "policy_loss": -0.002048761058540549, "vf_loss": 0.009391632303595543, "vf_explained_var": 0.46758872270584106, "kl": 0.0029126408844604157, "entropy": 1.0264251828193665, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": -1.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.96, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.735, "agent_1": -0.455, "agent_2": -0.77, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.5, -1.5, -3.5, -1.5, -3.5, -3.5, -1.5, -1.5, -3.0, -3.5, -3.0, -3.5, -3.5, -4.0, -3.0, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.0, -3.5, -3.5, -3.5, -3.0, -3.0, -3.5, -1.5, -3.5, -3.5, -2.0, -3.5, -3.5, -2.0, -3.5, -3.5, -3.5, -3.0, -3.5, -2.5, -3.5, -3.5, -3.0, -1.5, -3.5, -2.0, -3.0, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -2.0, -2.5, -2.0, -2.0, -3.0, -3.5, -1.5, -3.0, -3.5, -3.0, -3.0, -3.0, -3.5, -2.0, -3.5, -3.0, -1.5, -3.0, -3.5, -2.5, -2.5, -3.5, -3.0, -3.0, -3.0, -3.5, -3.0, -3.0, -2.5, -1.5, -3.5, -3.0, -1.5, -2.5, -2.0, -3.5, -3.0, -3.5, -3.0, -1.5, -3.0, -3.5, -3.0, -3.5, -3.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5], "policy_agent_1_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_2_reward": [-1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.637392693348577, "mean_inference_ms": 20.67702888011454, "mean_action_processing_ms": 2.952859979393551, "mean_env_wait_ms": 18.757417338175088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04179036617279053, "StateBufferConnector_ms": 0.012292623519897461, "ViewRequirementAgentConnector_ms": 0.19896531105041504}, "num_episodes": 32, "episode_return_max": -1.5, "episode_return_min": -4.0, "episode_return_mean": -2.96, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 530.1666870383893, "num_env_steps_trained_throughput_per_sec": 530.1666870383893, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 7569.788, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7569.721, "sample_time_ms": 6582.218, "learn_time_ms": 944.089, "learn_throughput": 4236.887, "synch_weights_time_ms": 42.444}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "85d7a_00000", "date": "2024-09-11_18-14-20", "timestamp": 1726071260, "time_this_iter_s": 7.572859525680542, "time_total_s": 107.45675826072693, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67DDCCA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 107.45675826072693, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 69.88, "ram_util_percent": 91.25, "gpu_util_percent0": 0.166, "vram_util_percent0": 0.09718017578125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3118362456560135, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0003, "total_loss": 0.020113725773990156, "policy_loss": -0.0007333493624173571, "vf_loss": 0.029449288547039033, "vf_explained_var": 0.10936076641082763, "kl": 0.0016898046094866003, "entropy": 0.8602236092090607, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 145.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.23732163906097412, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0003, "total_loss": 0.02148826066404581, "policy_loss": -0.0003014991465761341, "vf_loss": 0.03050766158849001, "vf_explained_var": 0.20227482914924622, "kl": 0.00020614209006453166, "entropy": 0.8717905938625335, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 145.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.24426183551549913, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0003, "total_loss": 0.009752559382468462, "policy_loss": -0.00471640404430218, "vf_loss": 0.022621783055365087, "vf_explained_var": 0.7229225695133209, "kl": 0.004271075980796013, "entropy": 0.8152872502803803, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 145.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.128972327709198, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0003, "total_loss": -0.0006092369076213799, "policy_loss": -0.0014471813781710807, "vf_loss": 0.01240468118339777, "vf_explained_var": 0.4123588025569916, "kl": 0.0016037723216868471, "entropy": 1.1566758275032043, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 145.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": -1.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.83, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.68, "agent_1": -0.46, "agent_2": -0.69, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -3.5, -3.5, -2.0, -3.5, -3.5, -3.5, -3.0, -3.5, -2.5, -3.5, -3.5, -3.0, -1.5, -3.5, -2.0, -3.0, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -2.0, -2.5, -2.0, -2.0, -3.0, -3.5, -1.5, -3.0, -3.5, -3.0, -3.0, -3.0, -3.5, -2.0, -3.5, -3.0, -1.5, -3.0, -3.5, -2.5, -2.5, -3.5, -3.0, -3.0, -3.0, -3.5, -3.0, -3.0, -2.5, -1.5, -3.5, -3.0, -1.5, -2.5, -2.0, -3.5, -3.0, -3.5, -3.0, -1.5, -3.0, -3.5, -3.0, -3.5, -3.0, -3.0, -1.5, -3.5, -3.5, -3.0, -3.5, -3.0, -2.0, -2.5, -3.5, -1.5, -2.5, -3.5, -3.0, -3.0, -3.0, -3.5, -1.5, -3.5, -2.0, -1.5, -2.0, -2.5, -3.0, -3.0, -2.5, -3.0, -3.0, -3.5, -1.5, -2.5, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0], "policy_agent_1_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_2_reward": [0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.700504086227722, "mean_inference_ms": 20.757051449619354, "mean_action_processing_ms": 2.9604765143235947, "mean_env_wait_ms": 18.773967919783832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05085831880569458, "StateBufferConnector_ms": 0.015461266040802002, "ViewRequirementAgentConnector_ms": 0.2215195894241333}, "num_episodes": 32, "episode_return_max": -1.5, "episode_return_min": -3.5, "episode_return_mean": -2.83, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.8349292600141, "num_env_steps_trained_throughput_per_sec": 467.8349292600141, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 7696.405, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7696.339, "sample_time_ms": 6699.34, "learn_time_ms": 954.053, "learn_throughput": 4192.641, "synch_weights_time_ms": 41.976}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "85d7a_00000", "date": "2024-09-11_18-14-29", "timestamp": 1726071269, "time_this_iter_s": 8.579695463180542, "time_total_s": 116.03645372390747, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67E47A30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116.03645372390747, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 85.49999999999999, "ram_util_percent": 91.69, "gpu_util_percent0": 0.205, "vram_util_percent0": 0.0997802734375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09306536316871643, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0003, "total_loss": 0.04046754315495491, "policy_loss": -0.0007166519830207107, "vf_loss": 0.04895381219685078, "vf_explained_var": 0.03160297274589539, "kl": 0.001705915962520521, "entropy": 0.7769629299640656, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 155.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4751983880996704, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0003, "total_loss": 0.03491484634578228, "policy_loss": -0.0002050606729426363, "vf_loss": 0.04301913306117058, "vf_explained_var": 0.22546865940093994, "kl": 6.848067973805883e-05, "entropy": 0.7899227559566497, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 155.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.35937730967998505, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0003, "total_loss": 0.0311918206512928, "policy_loss": -0.003739883051457582, "vf_loss": 0.043768494948744775, "vf_explained_var": 0.5613275468349457, "kl": 0.004676192667830037, "entropy": 0.8836821973323822, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 155.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45462859272956846, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0003, "total_loss": 0.0099005077034235, "policy_loss": -0.002672819633517065, "vf_loss": 0.024589498154819013, "vf_explained_var": 0.21128435134887696, "kl": 0.004166965533295297, "entropy": 1.2016195416450501, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 155.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.635, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.695, "agent_1": -0.43, "agent_2": -0.51, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.0, -3.5, -3.0, -3.0, -1.5, -3.5, -3.5, -3.0, -3.5, -3.0, -2.0, -2.5, -3.5, -1.5, -2.5, -3.5, -3.0, -3.0, -3.0, -3.5, -1.5, -3.5, -2.0, -1.5, -2.0, -2.5, -3.0, -3.0, -2.5, -3.0, -3.0, -3.5, -1.5, -2.5, -2.0, -3.0, -3.0, -1.5, -3.5, -1.5, -3.5, -2.0, -1.5, -3.0, -3.0, -2.0, -3.5, -2.0, -2.5, -0.5, -2.0, -2.5, -2.5, -1.5, -1.5, -3.0, -3.5, -3.5, -2.5, -2.5, -2.0, -0.5, -2.0, -2.5, -3.0, -2.0, -3.5, -2.0, -1.5, -3.0, -1.5, -3.5, -2.5, -3.0, -2.5, -3.5, -2.0, -2.0, -3.5, -3.5, -1.5, -3.5, -3.5, -2.5, -2.0, -3.0, -3.5, -3.5, -3.0, -1.5, -3.5, -3.5, -3.0, -3.5, -3.0, -1.5, -1.5, -3.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0], "policy_agent_1_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_2_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.74938241558843, "mean_inference_ms": 20.845552094692277, "mean_action_processing_ms": 2.9733506090327024, "mean_env_wait_ms": 18.783913283232497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04026830196380615, "StateBufferConnector_ms": 0.02259230613708496, "ViewRequirementAgentConnector_ms": 0.19376933574676514}, "num_episodes": 64, "episode_return_max": -0.5, "episode_return_min": -3.5, "episode_return_mean": -2.635, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 554.6636705891003, "num_env_steps_trained_throughput_per_sec": 554.6636705891003, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 7627.156, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7627.115, "sample_time_ms": 6639.426, "learn_time_ms": 945.465, "learn_throughput": 4230.722, "synch_weights_time_ms": 41.25}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "85d7a_00000", "date": "2024-09-11_18-14-36", "timestamp": 1726071276, "time_this_iter_s": 7.237952709197998, "time_total_s": 123.27440643310547, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67E46D40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 123.27440643310547, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 64.58, "ram_util_percent": 91.86999999999999, "gpu_util_percent0": 0.034, "vram_util_percent0": 0.09796142578125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1423347882926464, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0003, "total_loss": 0.02066461183130741, "policy_loss": -0.00035119205203955063, "vf_loss": 0.02852364704012871, "vf_explained_var": 0.07761808633804321, "kl": 0.00020242731261532754, "entropy": 0.7507841408252716, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 165.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15234705954790115, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0003, "total_loss": 0.016048441268503667, "policy_loss": -0.0004925113308502204, "vf_loss": 0.023771730810403825, "vf_explained_var": 0.2124464452266693, "kl": 0.000143918439277968, "entropy": 0.7230779886245727, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 165.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2400909423828125, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0003, "total_loss": 0.02516444642096758, "policy_loss": -0.0010574906046258547, "vf_loss": 0.03562092185020447, "vf_explained_var": 0.49847401976585387, "kl": 0.00026274227872704616, "entropy": 0.9398986339569092, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 165.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1793828159570694, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0003, "total_loss": -0.0007081712028593756, "policy_loss": -0.0009846672328421846, "vf_loss": 0.01233186973258853, "vf_explained_var": 0.2043381631374359, "kl": 0.0009816390702326316, "entropy": 1.2055376291275024, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 165.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.575, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.73, "agent_1": -0.34, "agent_2": -0.505, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -1.5, -2.5, -2.0, -3.0, -3.0, -1.5, -3.5, -1.5, -3.5, -2.0, -1.5, -3.0, -3.0, -2.0, -3.5, -2.0, -2.5, -0.5, -2.0, -2.5, -2.5, -1.5, -1.5, -3.0, -3.5, -3.5, -2.5, -2.5, -2.0, -0.5, -2.0, -2.5, -3.0, -2.0, -3.5, -2.0, -1.5, -3.0, -1.5, -3.5, -2.5, -3.0, -2.5, -3.5, -2.0, -2.0, -3.5, -3.5, -1.5, -3.5, -3.5, -2.5, -2.0, -3.0, -3.5, -3.5, -3.0, -1.5, -3.5, -3.5, -3.0, -3.5, -3.0, -1.5, -1.5, -3.5, -3.5, -2.5, -1.5, -1.5, -0.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -2.5, -3.5, -2.5, -1.0, -1.5, -2.0, -3.5, -2.5, -3.5, -3.0, -3.5, -1.5, -3.5, -0.5, -1.5, -3.5, -2.5, -3.5, -3.5, -3.5, -0.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0], "policy_agent_1_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -0.5], "policy_agent_2_reward": [-1.0, 0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.755090453708537, "mean_inference_ms": 20.84056082667845, "mean_action_processing_ms": 2.9721613972832266, "mean_env_wait_ms": 18.77628083250967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0305863618850708, "StateBufferConnector_ms": 0.024320006370544434, "ViewRequirementAgentConnector_ms": 0.18738406896591187}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -3.5, "episode_return_mean": -2.575, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.5430561856691, "num_env_steps_trained_throughput_per_sec": 502.5430561856691, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 7572.978, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7572.937, "sample_time_ms": 6577.692, "learn_time_ms": 953.0, "learn_throughput": 4197.272, "synch_weights_time_ms": 41.171}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "85d7a_00000", "date": "2024-09-11_18-14-44", "timestamp": 1726071284, "time_this_iter_s": 7.991051912307739, "time_total_s": 131.2654583454132, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67E44F70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 131.2654583454132, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 73.63000000000001, "ram_util_percent": 91.63999999999999, "gpu_util_percent0": 0.123, "vram_util_percent0": 0.0959228515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.055782800540328026, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0003, "total_loss": 0.020784923620522023, "policy_loss": -0.00018227288446723833, "vf_loss": 0.02843710593879223, "vf_explained_var": 0.07146828174591065, "kl": 0.0005118384200613946, "entropy": 0.7469910383224487, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 175.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.14765382781624795, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0003, "total_loss": 0.018106883578002452, "policy_loss": -0.0007344333818764426, "vf_loss": 0.025710486993193626, "vf_explained_var": 0.26399689316749575, "kl": 0.0002907862561187358, "entropy": 0.6869171440601349, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 175.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2800678417086601, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0003, "total_loss": 0.021621924825012684, "policy_loss": -0.004234718522366165, "vf_loss": 0.03536243513226509, "vf_explained_var": 0.5250177085399628, "kl": 0.0038355180566213678, "entropy": 0.950579559803009, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 175.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10745376795530319, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0003, "total_loss": 0.002265223755966872, "policy_loss": -0.0002630986544318148, "vf_loss": 0.014753742050379515, "vf_explained_var": 0.05855618119239807, "kl": 0.001043745160131948, "entropy": 1.222542130947113, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 175.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.73, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.795, "agent_1": -0.335, "agent_2": -0.6, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5, -3.0, -2.0, -3.5, -2.0, -1.5, -3.0, -1.5, -3.5, -2.5, -3.0, -2.5, -3.5, -2.0, -2.0, -3.5, -3.5, -1.5, -3.5, -3.5, -2.5, -2.0, -3.0, -3.5, -3.5, -3.0, -1.5, -3.5, -3.5, -3.0, -3.5, -3.0, -1.5, -1.5, -3.5, -3.5, -2.5, -1.5, -1.5, -0.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -2.5, -3.5, -2.5, -1.0, -1.5, -2.0, -3.5, -2.5, -3.5, -3.0, -3.5, -1.5, -3.5, -0.5, -1.5, -3.5, -2.5, -3.5, -3.5, -3.5, -0.5, -3.5, -3.0, -3.5, -3.5, -2.5, -3.0, -3.5, -3.5, -2.0, -2.5, -0.5, -0.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.5, -1.5, -3.5, -1.5, -2.5, -1.5, -2.5, -3.0, -3.5, -3.5, -3.5, -1.5, -3.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0], "policy_agent_1_reward": [-0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_2_reward": [-0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.759832608716323, "mean_inference_ms": 20.853374114233947, "mean_action_processing_ms": 2.9769413134870977, "mean_env_wait_ms": 18.80572320454648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029650986194610596, "StateBufferConnector_ms": 0.018825292587280273, "ViewRequirementAgentConnector_ms": 0.18425464630126953}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -3.5, "episode_return_mean": -2.73, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 519.5890477353323, "num_env_steps_trained_throughput_per_sec": 519.5890477353323, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 7622.448, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7622.407, "sample_time_ms": 6638.869, "learn_time_ms": 942.231, "learn_throughput": 4245.244, "synch_weights_time_ms": 40.293}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "85d7a_00000", "date": "2024-09-11_18-14-52", "timestamp": 1726071292, "time_this_iter_s": 7.724744558334351, "time_total_s": 138.99020290374756, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67E47A30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 138.99020290374756, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 71.75999999999999, "ram_util_percent": 91.71000000000001, "gpu_util_percent0": 0.11300000000000002, "vram_util_percent0": 0.09627685546875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10240573212504386, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0003, "total_loss": 0.02307127732783556, "policy_loss": -0.0003746842533473682, "vf_loss": 0.031091774813830853, "vf_explained_var": 0.11575199365615844, "kl": 0.0005621551152216852, "entropy": 0.7645812571048737, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 185.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13806456848978996, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0003, "total_loss": 0.02052736785262823, "policy_loss": -0.0006802275023801485, "vf_loss": 0.02896743267774582, "vf_explained_var": 0.27613686919212344, "kl": 0.0009980813423680957, "entropy": 0.7759838223457336, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 185.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.22245950400829315, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0003, "total_loss": 0.029597919061779977, "policy_loss": -0.00311371653660899, "vf_loss": 0.04184890314936638, "vf_explained_var": 0.3441543638706207, "kl": 0.0018592293992696796, "entropy": 0.9137268722057342, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 185.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09043534509837628, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0003, "total_loss": 1.7950106848729774e-05, "policy_loss": -0.00076483725788421, "vf_loss": 0.012953643500804902, "vf_explained_var": 0.25211862921714784, "kl": 0.0007217867731014848, "entropy": 1.2170857071876526, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 185.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.735, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.765, "agent_1": -0.29, "agent_2": -0.68, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5, -1.5, -3.5, -3.5, -2.5, -1.5, -1.5, -0.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -2.5, -3.5, -2.5, -1.0, -1.5, -2.0, -3.5, -2.5, -3.5, -3.0, -3.5, -1.5, -3.5, -0.5, -1.5, -3.5, -2.5, -3.5, -3.5, -3.5, -0.5, -3.5, -3.0, -3.5, -3.5, -2.5, -3.0, -3.5, -3.5, -2.0, -2.5, -0.5, -0.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.5, -1.5, -3.5, -1.5, -2.5, -1.5, -2.5, -3.0, -3.5, -3.5, -3.5, -1.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -1.5, -3.5, -3.5, -2.0, -3.5, -2.5, -3.5, -3.5, -0.5, -3.5, -3.5, -3.5, -1.5, -3.0, -3.5, -2.5, -3.0, -3.5, -2.5, -3.0, -2.0, -3.5, -2.5, -0.5, -3.5, -2.5, -1.5, -3.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5], "policy_agent_1_reward": [-0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5], "policy_agent_2_reward": [0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.772081422190755, "mean_inference_ms": 20.845766791447172, "mean_action_processing_ms": 2.97241352107168, "mean_env_wait_ms": 18.787392344667055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029252171516418457, "StateBufferConnector_ms": 0.019301772117614746, "ViewRequirementAgentConnector_ms": 0.18190425634384155}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -3.5, "episode_return_mean": -2.735, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 560.0073513996048, "num_env_steps_trained_throughput_per_sec": 560.0073513996048, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 7602.246, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7602.205, "sample_time_ms": 6625.469, "learn_time_ms": 935.361, "learn_throughput": 4276.426, "synch_weights_time_ms": 40.261}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "85d7a_00000", "date": "2024-09-11_18-14-59", "timestamp": 1726071299, "time_this_iter_s": 7.173351764678955, "time_total_s": 146.1635546684265, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67DDD630>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 146.1635546684265, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 67.95555555555556, "ram_util_percent": 91.52222222222221, "gpu_util_percent0": 0.061111111111111116, "vram_util_percent0": 0.09502495659722222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3133830137550831, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0003, "total_loss": 0.038611780107021335, "policy_loss": 4.2483758807065894e-05, "vf_loss": 0.04662427864968777, "vf_explained_var": 0.10455005168914795, "kl": 0.00059379828217061, "entropy": 0.8054983377456665, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 195.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4667925640940666, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0003, "total_loss": 0.03515669666230679, "policy_loss": -0.0005398125496867579, "vf_loss": 0.044056490436196326, "vf_explained_var": 0.26497923731803896, "kl": 0.0003044543009309564, "entropy": 0.8359982967376709, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 195.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4842283517122269, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0003, "total_loss": 0.05323199816048145, "policy_loss": -0.000641639487730572, "vf_loss": 0.0628863450139761, "vf_explained_var": 0.2934632897377014, "kl": 0.002017223841539817, "entropy": 0.9012707829475403, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 195.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3217986524105072, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0003, "total_loss": 0.008626610646024347, "policy_loss": -0.0006170884134917287, "vf_loss": 0.02106393240392208, "vf_explained_var": 0.228044730424881, "kl": 0.0003668288250992191, "entropy": 1.1820233941078186, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 195.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.805, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.75, "agent_1": -0.355, "agent_2": -0.7, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -1.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -1.5, -3.5, -3.5, -2.0, -3.5, -2.5, -3.5, -3.5, -0.5, -3.5, -3.5, -3.5, -1.5, -3.0, -3.5, -2.5, -3.0, -3.5, -2.5, -3.0, -2.0, -3.5, -2.5, -0.5, -3.5, -2.5, -1.5, -3.0, -3.0, -3.5, -2.5, -1.5, -3.5, -3.5, -3.5, -3.0, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -1.5, -3.5, -2.0, -3.5, -2.0, -2.0, -2.5, -2.0, -3.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -2.5, -1.5, -3.5, -2.0, -3.0, -3.0, -3.5, -0.5, -2.0, -3.0, -2.0, -1.5, -1.5, -2.5, -2.5, -3.0, -3.5, -3.5, -2.5, -2.5, -3.5, -3.5, -3.5, -3.5, -1.0, -3.5, -1.5, -2.0, -2.5, -3.5, -3.5, -3.0, -1.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5], "policy_agent_1_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_2_reward": [-1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -1.0, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.732520968284874, "mean_inference_ms": 20.75865387422977, "mean_action_processing_ms": 2.9631473025492063, "mean_env_wait_ms": 18.71211453697382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035771965980529785, "StateBufferConnector_ms": 0.017324090003967285, "ViewRequirementAgentConnector_ms": 0.1775749921798706}, "num_episodes": 64, "episode_return_max": -0.5, "episode_return_min": -3.5, "episode_return_mean": -2.805, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.5188319195594, "num_env_steps_trained_throughput_per_sec": 546.5188319195594, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 7629.961, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7629.92, "sample_time_ms": 6656.358, "learn_time_ms": 932.416, "learn_throughput": 4289.929, "synch_weights_time_ms": 40.131}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "85d7a_00000", "date": "2024-09-11_18-15-07", "timestamp": 1726071307, "time_this_iter_s": 7.348016738891602, "time_total_s": 153.51157140731812, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC1A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 153.51157140731812, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 69.26666666666667, "ram_util_percent": 91.4, "gpu_util_percent0": 0.06444444444444446, "vram_util_percent0": 0.09505208333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1152607686817646, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0003, "total_loss": 0.017982777580618857, "policy_loss": -0.0005057764391494856, "vf_loss": 0.027144835516810416, "vf_explained_var": 0.06787829399108887, "kl": 0.00028908967369716264, "entropy": 0.8656280696392059, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 205.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17977129817008972, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0003, "total_loss": 0.016453320812433957, "policy_loss": -0.0013393696409366384, "vf_loss": 0.02573627755045891, "vf_explained_var": 0.16128819584846496, "kl": 0.0005929893638040084, "entropy": 0.7943586707115173, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 205.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.14237018227577208, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0003, "total_loss": 0.026823212020099164, "policy_loss": -0.0018175559406699905, "vf_loss": 0.0377324640750885, "vf_explained_var": 0.2745578944683075, "kl": 0.0009061497806214902, "entropy": 0.9091699063777924, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 205.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16654252111911774, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0003, "total_loss": -0.0019304249435663223, "policy_loss": -0.0006597833125852048, "vf_loss": 0.010664847306907177, "vf_explained_var": 0.2826912999153137, "kl": 0.000635189816057391, "entropy": 1.1935490012168883, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 205.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.845, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.78, "agent_1": -0.365, "agent_2": -0.7, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -2.5, -1.5, -3.0, -3.0, -3.5, -2.5, -1.5, -3.5, -3.5, -3.5, -3.0, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -1.5, -3.5, -2.0, -3.5, -2.0, -2.0, -2.5, -2.0, -3.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -2.5, -1.5, -3.5, -2.0, -3.0, -3.0, -3.5, -0.5, -2.0, -3.0, -2.0, -1.5, -1.5, -2.5, -2.5, -3.0, -3.5, -3.5, -2.5, -2.5, -3.5, -3.5, -3.5, -3.5, -1.0, -3.5, -1.5, -2.0, -2.5, -3.5, -3.5, -3.0, -1.5, -3.5, -3.5, -3.0, -3.5, -2.0, -3.5, -3.5, -2.0, -2.5, -3.5, -3.0, -1.5, -2.5, -2.5, -3.5, -2.5, -3.0, -3.5, -3.5, -2.0, -3.5, -3.0, -3.5, -2.5, -2.5, -2.5, -3.5, -3.5, -3.5, -2.5, -3.0, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0], "policy_agent_1_reward": [-0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5], "policy_agent_2_reward": [-1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.712874170400728, "mean_inference_ms": 20.710850070632823, "mean_action_processing_ms": 2.958331640668672, "mean_env_wait_ms": 18.68720257463164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050286054611206055, "StateBufferConnector_ms": 0.01631760597229004, "ViewRequirementAgentConnector_ms": 0.1915789246559143}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -3.5, "episode_return_mean": -2.845, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 538.9573409047454, "num_env_steps_trained_throughput_per_sec": 538.9573409047454, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 7643.127, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7643.086, "sample_time_ms": 6654.934, "learn_time_ms": 947.407, "learn_throughput": 4222.052, "synch_weights_time_ms": 39.643}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "85d7a_00000", "date": "2024-09-11_18-15-14", "timestamp": 1726071314, "time_this_iter_s": 7.446930885314941, "time_total_s": 160.95850229263306, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC23B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 160.95850229263306, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 65.69, "ram_util_percent": 91.22, "gpu_util_percent0": 0.06300000000000001, "vram_util_percent0": 0.0952392578125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.25115221329033377, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0003, "total_loss": 0.021563786640763284, "policy_loss": -0.0001290861742226923, "vf_loss": 0.030630378611385824, "vf_explained_var": 0.042601919174194335, "kl": 0.0005230187614870374, "entropy": 0.8937505900859832, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 215.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2630890145897865, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0003, "total_loss": 0.020000816881656648, "policy_loss": -0.0012906241815471731, "vf_loss": 0.029352733679115773, "vf_explained_var": 0.26493157148361207, "kl": 0.0016485063348227413, "entropy": 0.8061293840408326, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 215.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10886583961546421, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0003, "total_loss": 0.030474568903446197, "policy_loss": -0.000790532081737183, "vf_loss": 0.040204678848385814, "vf_explained_var": 0.2942644476890564, "kl": 0.0015311239141738043, "entropy": 0.8939578592777252, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 215.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.14382429122924806, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0003, "total_loss": -0.001643547831554315, "policy_loss": -0.0014789661937356867, "vf_loss": 0.01166629595682025, "vf_explained_var": 0.22969044446945192, "kl": 0.0014383422319951932, "entropy": 1.1830877184867858, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 215.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.74, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": -0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.755, "agent_1": -0.36, "agent_2": -0.625, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.5, -3.5, -2.5, -1.5, -3.5, -2.0, -3.0, -3.0, -3.5, -0.5, -2.0, -3.0, -2.0, -1.5, -1.5, -2.5, -2.5, -3.0, -3.5, -3.5, -2.5, -2.5, -3.5, -3.5, -3.5, -3.5, -1.0, -3.5, -1.5, -2.0, -2.5, -3.5, -3.5, -3.0, -1.5, -3.5, -3.5, -3.0, -3.5, -2.0, -3.5, -3.5, -2.0, -2.5, -3.5, -3.0, -1.5, -2.5, -2.5, -3.5, -2.5, -3.0, -3.5, -3.5, -2.0, -3.5, -3.0, -3.5, -2.5, -2.5, -2.5, -3.5, -3.5, -3.5, -2.5, -3.0, -3.5, -1.5, -3.5, -3.5, -2.5, -2.5, -3.5, -2.5, -3.5, -2.0, -2.5, -3.5, -3.0, -3.5, -3.5, -0.5, -1.5, -1.5, -1.5, -3.0, -3.5, -2.0, -2.5, -2.5, -2.5, -3.0, -3.5, -2.0, -3.5, -1.5, -3.5, -0.5, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0], "policy_agent_1_reward": [-0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5], "policy_agent_2_reward": [-1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.706441249735976, "mean_inference_ms": 20.694203937957603, "mean_action_processing_ms": 2.9610347499700604, "mean_env_wait_ms": 18.721611591413645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.054414451122283936, "StateBufferConnector_ms": 0.01553201675415039, "ViewRequirementAgentConnector_ms": 0.19791096448898315}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -3.5, "episode_return_mean": -2.74, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.5282533790978, "num_env_steps_trained_throughput_per_sec": 486.5282533790978, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 7677.624, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7677.589, "sample_time_ms": 6692.513, "learn_time_ms": 945.055, "learn_throughput": 4232.559, "synch_weights_time_ms": 39.019}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "85d7a_00000", "date": "2024-09-11_18-15-22", "timestamp": 1726071322, "time_this_iter_s": 8.252994298934937, "time_total_s": 169.211496591568, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67DDD630>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 169.211496591568, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 77.41000000000001, "ram_util_percent": 91.55999999999999, "gpu_util_percent0": 0.11600000000000002, "vram_util_percent0": 0.09552001953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2331998750567436, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0003, "total_loss": 0.026027039624750614, "policy_loss": -0.0007709754587267526, "vf_loss": 0.03575468249619007, "vf_explained_var": 0.13232044577598573, "kl": 0.00018692074809223413, "entropy": 0.8956666588783264, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2174116626381874, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0003, "total_loss": 0.020812922902405263, "policy_loss": -0.0019061805731325876, "vf_loss": 0.03215212896466255, "vf_explained_var": 0.39415786862373353, "kl": 0.002105349720659433, "entropy": 0.9433025896549225, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12530763521790506, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0003, "total_loss": 0.029517990350723267, "policy_loss": -0.0004204652661428554, "vf_loss": 0.03871461413800716, "vf_explained_var": 0.32030311822891233, "kl": 0.0004825155876460485, "entropy": 0.8776158630847931, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10123802237212658, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0003, "total_loss": 0.0015449537197127939, "policy_loss": 4.069387141498737e-05, "vf_loss": 0.013292920030653476, "vf_explained_var": 0.19554481506347657, "kl": 0.0008796633428573841, "entropy": 1.1788660168647767, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.755, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": -0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.74, "agent_1": -0.395, "agent_2": -0.62, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.5, -3.0, -1.5, -3.5, -3.5, -3.0, -3.5, -2.0, -3.5, -3.5, -2.0, -2.5, -3.5, -3.0, -1.5, -2.5, -2.5, -3.5, -2.5, -3.0, -3.5, -3.5, -2.0, -3.5, -3.0, -3.5, -2.5, -2.5, -2.5, -3.5, -3.5, -3.5, -2.5, -3.0, -3.5, -1.5, -3.5, -3.5, -2.5, -2.5, -3.5, -2.5, -3.5, -2.0, -2.5, -3.5, -3.0, -3.5, -3.5, -0.5, -1.5, -1.5, -1.5, -3.0, -3.5, -2.0, -2.5, -2.5, -2.5, -3.0, -3.5, -2.0, -3.5, -1.5, -3.5, -0.5, -3.5, -3.0, -2.5, -3.0, -1.5, -2.5, -2.0, -3.5, -2.5, -1.5, -1.5, -1.5, -3.5, -2.0, -3.5, -3.0, -3.5, -3.5, -3.0, -4.0, -2.5, -2.0, -3.0, -2.5, -3.0, -3.5, -3.5, -2.5, -3.5, -3.0, -3.0, -1.5, -1.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5], "policy_agent_1_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5], "policy_agent_2_reward": [-1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.717939062516871, "mean_inference_ms": 20.6782131842173, "mean_action_processing_ms": 2.9569927214479548, "mean_env_wait_ms": 18.72783821641824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05839359760284424, "StateBufferConnector_ms": 0.016452014446258545, "ViewRequirementAgentConnector_ms": 0.1987619400024414}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -2.755, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 539.2475701708682, "num_env_steps_trained_throughput_per_sec": 539.2475701708682, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 7648.712, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7648.677, "sample_time_ms": 6666.719, "learn_time_ms": 941.772, "learn_throughput": 4247.314, "synch_weights_time_ms": 39.185}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "85d7a_00000", "date": "2024-09-11_18-15-30", "timestamp": 1726071330, "time_this_iter_s": 7.442103624343872, "time_total_s": 176.65360021591187, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67E46C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176.65360021591187, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 65.84, "ram_util_percent": 91.69, "gpu_util_percent0": 0.09200000000000001, "vram_util_percent0": 0.096728515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15133631303906442, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0003, "total_loss": 0.04189435578882694, "policy_loss": -0.002053763273264053, "vf_loss": 0.05217705070972443, "vf_explained_var": 0.11443566083908081, "kl": 0.002406253549906978, "entropy": 0.8228932917118073, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 235.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32646972835063937, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0003, "total_loss": 0.0301162239164114, "policy_loss": -0.004050478574936278, "vf_loss": 0.04447505734860897, "vf_explained_var": 0.4640126347541809, "kl": 0.004678321899336879, "entropy": 1.030835497379303, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 235.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09717971980571746, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0003, "total_loss": 0.04309545792639256, "policy_loss": -0.0008994289672045852, "vf_loss": 0.0526457991451025, "vf_explained_var": 0.28199037313461306, "kl": 0.0007814581748789351, "entropy": 0.8650912821292878, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 235.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3550535723567009, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0003, "total_loss": 0.010858464054763317, "policy_loss": -0.0006267920343816513, "vf_loss": 0.02351240310817957, "vf_explained_var": 0.13139784932136536, "kl": 0.0004006755554655683, "entropy": 1.2027146697044373, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 235.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.245, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.56, "agent_1": -0.275, "agent_2": -0.41, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5, -3.5, -0.5, -3.5, -3.0, -2.5, -3.0, -1.5, -2.5, -2.0, -3.5, -2.5, -1.5, -1.5, -1.5, -3.5, -2.0, -3.5, -3.0, -3.5, -3.5, -3.0, -4.0, -2.5, -2.0, -3.0, -2.5, -3.0, -3.5, -3.5, -2.5, -3.5, -3.0, -3.0, -1.5, -1.5, -1.5, -2.0, -2.0, -3.5, -1.5, -1.5, -3.0, -1.5, -1.0, -3.0, -1.5, -2.5, -2.5, -2.5, -2.5, -3.0, -2.0, -2.0, -2.5, -2.5, -0.5, -0.5, -1.5, -3.0, -0.5, -0.5, -1.5, -3.5, -2.5, -1.5, -2.0, -1.5, -1.5, -2.5, -3.0, -2.0, -1.5, -3.0, -0.5, -1.5, -1.5, -1.5, -2.5, -3.0, -1.5, -3.5, -3.0, -3.0, -1.5, -2.0, -0.5, -0.5, -2.0, -2.0, -3.5, -1.5, -1.0, -3.0, -3.0, -1.5, -2.5, -2.5, -1.5, -3.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5], "policy_agent_1_reward": [-0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5], "policy_agent_2_reward": [0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.698628990923138, "mean_inference_ms": 20.621433872873766, "mean_action_processing_ms": 2.951381823508427, "mean_env_wait_ms": 18.723294799531956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035526931285858154, "StateBufferConnector_ms": 0.018249809741973877, "ViewRequirementAgentConnector_ms": 0.18950968980789185}, "num_episodes": 64, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -2.245, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 563.6369390335913, "num_env_steps_trained_throughput_per_sec": 563.6369390335913, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 7603.909, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7603.874, "sample_time_ms": 6624.761, "learn_time_ms": 939.833, "learn_throughput": 4256.076, "synch_weights_time_ms": 38.379}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "85d7a_00000", "date": "2024-09-11_18-15-37", "timestamp": 1726071337, "time_this_iter_s": 7.127421140670776, "time_total_s": 183.78102135658264, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67E464D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 183.78102135658264, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 66.83333333333333, "ram_util_percent": 91.54444444444444, "gpu_util_percent0": 0.06666666666666668, "vram_util_percent0": 0.096923828125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3108246050775051, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0003, "total_loss": 0.02399147264659405, "policy_loss": -0.0007037669727651518, "vf_loss": 0.032915851846337316, "vf_explained_var": 0.11279147863388062, "kl": 0.00037315205172490097, "entropy": 0.8220611870288849, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 245.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.23319303691387178, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0003, "total_loss": 0.02747713904827833, "policy_loss": -0.0016731457224523183, "vf_loss": 0.03884528130292893, "vf_explained_var": 0.25710641741752627, "kl": 0.0006762098309991416, "entropy": 0.9694995939731598, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 245.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19623128846287727, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0003, "total_loss": 0.0252632237970829, "policy_loss": -0.0006406337839507614, "vf_loss": 0.03420871049165726, "vf_explained_var": 0.39495251774787904, "kl": 0.0009330776458227775, "entropy": 0.8304850161075592, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 245.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16942064836621284, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0003, "total_loss": -0.0007803742642863654, "policy_loss": -0.00032399892807006837, "vf_loss": 0.012052325718104839, "vf_explained_var": 0.11129981279373169, "kl": 0.0012829538410187523, "entropy": 1.2508702397346496, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 245.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.49, "agent_1": -0.22, "agent_2": -0.305, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -3.0, -1.5, -1.5, -1.5, -2.0, -2.0, -3.5, -1.5, -1.5, -3.0, -1.5, -1.0, -3.0, -1.5, -2.5, -2.5, -2.5, -2.5, -3.0, -2.0, -2.0, -2.5, -2.5, -0.5, -0.5, -1.5, -3.0, -0.5, -0.5, -1.5, -3.5, -2.5, -1.5, -2.0, -1.5, -1.5, -2.5, -3.0, -2.0, -1.5, -3.0, -0.5, -1.5, -1.5, -1.5, -2.5, -3.0, -1.5, -3.5, -3.0, -3.0, -1.5, -2.0, -0.5, -0.5, -2.0, -2.0, -3.5, -1.5, -1.0, -3.0, -3.0, -1.5, -2.5, -2.5, -1.5, -3.0, -3.0, -3.0, -2.0, -2.0, -1.5, -2.0, -1.5, -2.5, -3.0, -0.5, -2.5, -2.0, -2.0, -2.5, -0.5, -1.5, -0.5, -3.5, -1.5, -1.0, -3.0, -1.5, -1.5, -2.5, -1.5, -2.5, -3.0, -1.0, -0.5, -3.5, -1.5, -2.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0], "policy_agent_1_reward": [-0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5], "policy_agent_2_reward": [-1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.69220381646684, "mean_inference_ms": 20.602881209796898, "mean_action_processing_ms": 2.949775895243927, "mean_env_wait_ms": 18.738035506578225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03751051425933838, "StateBufferConnector_ms": 0.013793885707855225, "ViewRequirementAgentConnector_ms": 0.19253301620483398}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -3.5, "episode_return_mean": -2.015, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.9320371438212, "num_env_steps_trained_throughput_per_sec": 497.9320371438212, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 7552.229, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7552.194, "sample_time_ms": 6580.822, "learn_time_ms": 932.104, "learn_throughput": 4291.366, "synch_weights_time_ms": 38.365}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "85d7a_00000", "date": "2024-09-11_18-15-45", "timestamp": 1726071345, "time_this_iter_s": 8.061607599258423, "time_total_s": 191.84262895584106, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC1000>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 191.84262895584106, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 73.68, "ram_util_percent": 91.61999999999999, "gpu_util_percent0": 0.12599999999999997, "vram_util_percent0": 0.097314453125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09760155156254768, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0003, "total_loss": 0.024945116229355337, "policy_loss": -0.0002792062954540597, "vf_loss": 0.032923778519034386, "vf_explained_var": 0.20496873259544374, "kl": 0.0002430736969472491, "entropy": 0.7699455559253693, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 255.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1815582297742367, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0003, "total_loss": 0.02516636122018099, "policy_loss": -0.0028870815782283898, "vf_loss": 0.03673917353153229, "vf_explained_var": 0.27217535972595214, "kl": 0.001570612761861412, "entropy": 0.8685731291770935, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 255.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.20230870246887206, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0003, "total_loss": 0.02686693537980318, "policy_loss": -0.0016379928274545819, "vf_loss": 0.036651361361145975, "vf_explained_var": 0.37624231576919553, "kl": 0.0007912013345048763, "entropy": 0.814643383026123, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 255.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12773821055889129, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0003, "total_loss": -0.0006858743086922914, "policy_loss": -2.330188845007797e-05, "vf_loss": 0.011885469313710928, "vf_explained_var": 0.21679531335830687, "kl": 0.000551997144066263, "entropy": 1.2548041820526123, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 255.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.085, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.49, "agent_1": -0.24, "agent_2": -0.355, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5, -1.5, -2.0, -1.5, -1.5, -2.5, -3.0, -2.0, -1.5, -3.0, -0.5, -1.5, -1.5, -1.5, -2.5, -3.0, -1.5, -3.5, -3.0, -3.0, -1.5, -2.0, -0.5, -0.5, -2.0, -2.0, -3.5, -1.5, -1.0, -3.0, -3.0, -1.5, -2.5, -2.5, -1.5, -3.0, -3.0, -3.0, -2.0, -2.0, -1.5, -2.0, -1.5, -2.5, -3.0, -0.5, -2.5, -2.0, -2.0, -2.5, -0.5, -1.5, -0.5, -3.5, -1.5, -1.0, -3.0, -1.5, -1.5, -2.5, -1.5, -2.5, -3.0, -1.0, -0.5, -3.5, -1.5, -2.5, -1.5, -1.5, -3.5, -3.0, -1.5, -3.5, -3.0, -2.0, -3.0, -3.0, -1.5, -1.5, -2.5, -3.0, -0.5, -3.0, -2.0, -0.5, -3.5, -1.5, -3.0, -3.5, -1.5, -3.0, -1.0, -2.5, -3.0, -2.5, -3.5, -0.5, -0.5, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5], "policy_agent_1_reward": [-0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5], "policy_agent_2_reward": [-0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.691909527736987, "mean_inference_ms": 20.603152684814585, "mean_action_processing_ms": 2.9537481871146496, "mean_env_wait_ms": 18.786599257640752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03519904613494873, "StateBufferConnector_ms": 0.011090278625488281, "ViewRequirementAgentConnector_ms": 0.1914542317390442}, "num_episodes": 32, "episode_return_max": -0.5, "episode_return_min": -3.5, "episode_return_mean": -2.085, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 525.1097146550422, "num_env_steps_trained_throughput_per_sec": 525.1097146550422, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 7592.817, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7592.817, "sample_time_ms": 6622.619, "learn_time_ms": 931.108, "learn_throughput": 4295.956, "synch_weights_time_ms": 38.192}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "85d7a_00000", "date": "2024-09-11_18-15-53", "timestamp": 1726071353, "time_this_iter_s": 7.64648699760437, "time_total_s": 199.48911595344543, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67E46C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 199.48911595344543, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 69.33, "ram_util_percent": 91.82000000000001, "gpu_util_percent0": 0.11300000000000002, "vram_util_percent0": 0.10015869140625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.06412797085940838, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0003, "total_loss": 0.031239002011716366, "policy_loss": -0.00032012205556384286, "vf_loss": 0.03915095254778862, "vf_explained_var": 0.12310147285461426, "kl": 0.000171677525713676, "entropy": 0.759182870388031, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 265.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3792913734912872, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0003, "total_loss": 0.024130527675151826, "policy_loss": -0.003741165454266593, "vf_loss": 0.03703813664615154, "vf_explained_var": 0.2500292122364044, "kl": 0.0028244915898540056, "entropy": 0.9166443645954132, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 265.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13549408912658692, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0003, "total_loss": 0.022752116061747076, "policy_loss": -0.0011812757929874351, "vf_loss": 0.031987279653549194, "vf_explained_var": 0.44910715222358705, "kl": 0.0007819597651177901, "entropy": 0.8053888499736785, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 265.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11087052002549172, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0003, "total_loss": -0.00026020360573966175, "policy_loss": -0.0007850708314435905, "vf_loss": 0.013021309208124877, "vf_explained_var": 0.18744053244590758, "kl": 0.0006996280626481166, "entropy": 1.2496442198753357, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 265.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.115, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.445, "agent_1": -0.255, "agent_2": -0.415, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5, -2.5, -1.5, -3.0, -3.0, -3.0, -2.0, -2.0, -1.5, -2.0, -1.5, -2.5, -3.0, -0.5, -2.5, -2.0, -2.0, -2.5, -0.5, -1.5, -0.5, -3.5, -1.5, -1.0, -3.0, -1.5, -1.5, -2.5, -1.5, -2.5, -3.0, -1.0, -0.5, -3.5, -1.5, -2.5, -1.5, -1.5, -3.5, -3.0, -1.5, -3.5, -3.0, -2.0, -3.0, -3.0, -1.5, -1.5, -2.5, -3.0, -0.5, -3.0, -2.0, -0.5, -3.5, -1.5, -3.0, -3.5, -1.5, -3.0, -1.0, -2.5, -3.0, -2.5, -3.5, -0.5, -0.5, -2.0, -3.5, -1.5, -3.5, -1.5, -3.5, -0.5, -1.5, -1.5, -3.0, -2.0, -2.0, -1.5, -3.5, -3.0, -1.0, -3.5, -2.0, -0.5, -3.0, 0.5, -1.5, -0.5, -2.0, -3.5, -2.5, -0.5, -3.0, -3.5, -3.0, -3.0, -1.5, -1.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5], "policy_agent_1_reward": [-0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5], "policy_agent_2_reward": [-0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.7136399589898, "mean_inference_ms": 20.62648211782057, "mean_action_processing_ms": 2.953630361835593, "mean_env_wait_ms": 18.824558517411084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04118770360946655, "StateBufferConnector_ms": 0.008801460266113281, "ViewRequirementAgentConnector_ms": 0.20744609832763672}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -2.115, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.44012173586145, "num_env_steps_trained_throughput_per_sec": 490.44012173586145, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 7612.459, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7612.459, "sample_time_ms": 6636.438, "learn_time_ms": 937.162, "learn_throughput": 4268.206, "synch_weights_time_ms": 37.948}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "85d7a_00000", "date": "2024-09-11_18-16-01", "timestamp": 1726071361, "time_this_iter_s": 8.186480283737183, "time_total_s": 207.67559623718262, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC0EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 207.67559623718262, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 76.4, "ram_util_percent": 91.98, "gpu_util_percent0": 0.23500000000000001, "vram_util_percent0": 0.0988037109375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.39102874919772146, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0003, "total_loss": 0.04411689005792141, "policy_loss": -0.0009572473207299481, "vf_loss": 0.052533111348748204, "vf_explained_var": 0.15065455436706543, "kl": 0.00048659067526841683, "entropy": 0.7458971560001373, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 275.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5871696561574936, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0003, "total_loss": 0.05492001324892044, "policy_loss": -0.0010701093255192974, "vf_loss": 0.06420861929655075, "vf_explained_var": 0.14534536004066467, "kl": 0.0006424285871617031, "entropy": 0.8218498587608337, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 275.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1318386010825634, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0003, "total_loss": 0.043630388006567954, "policy_loss": -0.0008553993859095499, "vf_loss": 0.05235113389790058, "vf_explained_var": 0.2568938910961151, "kl": 0.0018410794655210339, "entropy": 0.7865344822406769, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 275.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.31267078071832655, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0003, "total_loss": 0.009713397175073624, "policy_loss": -0.0010337206681697354, "vf_loss": 0.02297248598188162, "vf_explained_var": 0.08557782769203186, "kl": 0.002087708042017766, "entropy": 1.222536814212799, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 275.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.075, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.43, "agent_1": -0.155, "agent_2": -0.49, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -0.5, -0.5, -2.0, -3.5, -1.5, -3.5, -1.5, -3.5, -0.5, -1.5, -1.5, -3.0, -2.0, -2.0, -1.5, -3.5, -3.0, -1.0, -3.5, -2.0, -0.5, -3.0, 0.5, -1.5, -0.5, -2.0, -3.5, -2.5, -0.5, -3.0, -3.5, -3.0, -3.0, -1.5, -1.5, -0.5, -2.5, -3.0, -2.5, -2.5, -1.0, -2.0, -3.5, -2.5, -2.0, -0.5, -1.0, -2.0, -2.0, 0.5, -3.5, -1.5, -3.5, -3.5, -3.0, -3.0, -1.5, -0.5, -3.5, -2.0, -2.5, -1.5, -0.5, -3.5, -3.5, -3.5, -1.5, -3.0, -1.5, -0.5, -2.5, -1.5, -3.5, -1.5, -0.5, -2.0, -3.5, -1.0, -2.0, -3.0, -3.5, -1.5, -3.5, -1.5, -3.5, -0.5, 0.5, -2.0, -3.5, -3.0, -1.5, -1.5, -1.5, -3.0, -0.5, -3.5, -2.5, -0.5, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5], "policy_agent_1_reward": [-0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5], "policy_agent_2_reward": [-1.0, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.744455914934274, "mean_inference_ms": 20.679656926950205, "mean_action_processing_ms": 2.9609290689761965, "mean_env_wait_ms": 18.87251083561378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042131006717681885, "StateBufferConnector_ms": 0.01451200246810913, "ViewRequirementAgentConnector_ms": 0.21673256158828735}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -2.075, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.10065485007584, "num_env_steps_trained_throughput_per_sec": 503.10065485007584, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 7637.69, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7637.69, "sample_time_ms": 6662.885, "learn_time_ms": 936.046, "learn_throughput": 4273.296, "synch_weights_time_ms": 37.845}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "85d7a_00000", "date": "2024-09-11_18-16-09", "timestamp": 1726071369, "time_this_iter_s": 7.982186794281006, "time_total_s": 215.65778303146362, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC3490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 215.65778303146362, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 75.55, "ram_util_percent": 92.17999999999999, "gpu_util_percent0": 0.14500000000000002, "vram_util_percent0": 0.10419921875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19942560717463492, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0003, "total_loss": 0.02052559722214937, "policy_loss": -0.0010112770985870156, "vf_loss": 0.030597850494086743, "vf_explained_var": 0.2244991898536682, "kl": 0.002071245155457291, "entropy": 0.906097674369812, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 285.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4423381358385086, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0003, "total_loss": 0.028574775345623492, "policy_loss": -0.002363173400226515, "vf_loss": 0.03955838233232498, "vf_explained_var": 0.2811656892299652, "kl": 0.003941591102193343, "entropy": 0.8620434820652008, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 285.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12964936010539532, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0003, "total_loss": 0.025584144145250322, "policy_loss": -0.0006712551869668459, "vf_loss": 0.03376855477690697, "vf_explained_var": 0.45079897046089173, "kl": 0.0005516234719863178, "entropy": 0.7513157069683075, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 285.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16729389503598213, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0003, "total_loss": -0.0007574521281640045, "policy_loss": -0.0007542075971286976, "vf_loss": 0.012062258925288916, "vf_explained_var": 0.07329722046852112, "kl": 0.0006307672661932884, "entropy": 1.206550419330597, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 285.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.02, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.44, "agent_1": -0.12, "agent_2": -0.46, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -3.0, -1.5, -1.5, -0.5, -2.5, -3.0, -2.5, -2.5, -1.0, -2.0, -3.5, -2.5, -2.0, -0.5, -1.0, -2.0, -2.0, 0.5, -3.5, -1.5, -3.5, -3.5, -3.0, -3.0, -1.5, -0.5, -3.5, -2.0, -2.5, -1.5, -0.5, -3.5, -3.5, -3.5, -1.5, -3.0, -1.5, -0.5, -2.5, -1.5, -3.5, -1.5, -0.5, -2.0, -3.5, -1.0, -2.0, -3.0, -3.5, -1.5, -3.5, -1.5, -3.5, -0.5, 0.5, -2.0, -3.5, -3.0, -1.5, -1.5, -1.5, -3.0, -0.5, -3.5, -2.5, -0.5, -2.0, -3.5, -0.5, -3.0, -0.5, -3.0, -2.0, -0.5, -3.5, -2.0, -0.5, -2.0, -1.5, -1.5, -3.5, -1.5, -0.5, -2.0, -0.5, -1.5, -3.0, -2.0, -0.5, -3.5, -3.0, -3.0, -2.0, -2.5, -2.0, -0.5, -0.5, -1.5, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_1_reward": [-0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5], "policy_agent_2_reward": [-1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.74533028724527, "mean_inference_ms": 20.68136759251221, "mean_action_processing_ms": 2.9626353799652803, "mean_env_wait_ms": 18.882502326062358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036941349506378174, "StateBufferConnector_ms": 0.01601487398147583, "ViewRequirementAgentConnector_ms": 0.19262629747390747}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -2.02, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.0002749635179, "num_env_steps_trained_throughput_per_sec": 544.0002749635179, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 7658.707, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7658.707, "sample_time_ms": 6685.682, "learn_time_ms": 934.282, "learn_throughput": 4281.362, "synch_weights_time_ms": 37.829}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "85d7a_00000", "date": "2024-09-11_18-16-17", "timestamp": 1726071377, "time_this_iter_s": 7.380398750305176, "time_total_s": 223.0381817817688, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0CD30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 223.0381817817688, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 65.89, "ram_util_percent": 92.15, "gpu_util_percent0": 0.07200000000000002, "vram_util_percent0": 0.10478515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3146724686026573, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0003, "total_loss": 0.02828551009297371, "policy_loss": -0.0007261371472850441, "vf_loss": 0.038275690749287605, "vf_explained_var": 0.07121714353561401, "kl": 0.00040469395462423564, "entropy": 0.9264043152332306, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 295.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.502779233455658, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0003, "total_loss": 0.026247802190482616, "policy_loss": -0.003911008323484566, "vf_loss": 0.03977112360298633, "vf_explained_var": 0.27154417634010314, "kl": 0.004496766927331919, "entropy": 0.9612314283847809, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 295.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18260327428579332, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0003, "total_loss": 0.027313057519495487, "policy_loss": -0.0008253786908426264, "vf_loss": 0.03562483452260494, "vf_explained_var": 0.4047408103942871, "kl": 0.0010554064843745436, "entropy": 0.7486400663852691, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 295.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13208719864487647, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0003, "total_loss": -8.149570203386246e-06, "policy_loss": -0.0005883482233912218, "vf_loss": 0.012629630416631699, "vf_explained_var": 0.122443687915802, "kl": 0.0005885466853214893, "entropy": 1.2049431324005127, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 295.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.89, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.32, "agent_1": -0.205, "agent_2": -0.365, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.5, -3.5, -1.5, -3.0, -1.5, -0.5, -2.5, -1.5, -3.5, -1.5, -0.5, -2.0, -3.5, -1.0, -2.0, -3.0, -3.5, -1.5, -3.5, -1.5, -3.5, -0.5, 0.5, -2.0, -3.5, -3.0, -1.5, -1.5, -1.5, -3.0, -0.5, -3.5, -2.5, -0.5, -2.0, -3.5, -0.5, -3.0, -0.5, -3.0, -2.0, -0.5, -3.5, -2.0, -0.5, -2.0, -1.5, -1.5, -3.5, -1.5, -0.5, -2.0, -0.5, -1.5, -3.0, -2.0, -0.5, -3.5, -3.0, -3.0, -2.0, -2.5, -2.0, -0.5, -0.5, -1.5, -2.0, -2.5, -3.0, -1.5, -2.0, -2.0, -3.0, -3.0, -3.0, -0.5, -3.0, -2.0, -1.5, -2.0, -1.5, -0.5, -2.0, -3.0, -0.5, -1.5, -3.0, 0.5, -0.5, -0.5, -0.5, -1.5, -0.5, -2.0, -0.5, -3.0, -3.0, 0.5, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5], "policy_agent_1_reward": [-0.5, -0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5], "policy_agent_2_reward": [-1.0, -1.0, -1.0, 0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.745357687034236, "mean_inference_ms": 20.685426650264034, "mean_action_processing_ms": 2.966915435632875, "mean_env_wait_ms": 18.922173382273147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034781575202941895, "StateBufferConnector_ms": 0.015251994132995605, "ViewRequirementAgentConnector_ms": 0.20090436935424805}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.89, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.2026253236404, "num_env_steps_trained_throughput_per_sec": 479.2026253236404, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 7761.522, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7761.522, "sample_time_ms": 6778.868, "learn_time_ms": 942.349, "learn_throughput": 4244.711, "synch_weights_time_ms": 39.29}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "85d7a_00000", "date": "2024-09-11_18-16-25", "timestamp": 1726071385, "time_this_iter_s": 8.382364988327026, "time_total_s": 231.42054677009583, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC2560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 231.42054677009583, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 78.60000000000001, "ram_util_percent": 92.11, "gpu_util_percent0": 0.12600000000000003, "vram_util_percent0": 0.10335693359375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3042428225278854, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0003, "total_loss": 0.01756309438496828, "policy_loss": -0.0017015136420013733, "vf_loss": 0.027369215711951257, "vf_explained_var": 0.12627519965171813, "kl": 0.0015495638557695202, "entropy": 0.8104605257511139, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 305.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.21186220943927764, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0003, "total_loss": 0.025747396796941758, "policy_loss": -0.0023911464086268097, "vf_loss": 0.03720232918858528, "vf_explained_var": 0.2733523190021515, "kl": 0.0024450069373415317, "entropy": 0.9063784897327423, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 305.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2685233198106289, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0003, "total_loss": 0.02121445760130882, "policy_loss": -0.0009513178046290704, "vf_loss": 0.0295869180932641, "vf_explained_var": 0.3772163450717926, "kl": 0.001397840352001367, "entropy": 0.7421142578125, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 305.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.08843839317560195, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0003, "total_loss": 0.001093987122294493, "policy_loss": -0.0008460747234494192, "vf_loss": 0.013649739045649766, "vf_explained_var": 0.10737518072128296, "kl": 0.0011160690417455043, "entropy": 1.1709677577018738, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 305.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.555, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.2, "agent_1": -0.15, "agent_2": -0.205, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -2.5, -0.5, -2.0, -3.5, -0.5, -3.0, -0.5, -3.0, -2.0, -0.5, -3.5, -2.0, -0.5, -2.0, -1.5, -1.5, -3.5, -1.5, -0.5, -2.0, -0.5, -1.5, -3.0, -2.0, -0.5, -3.5, -3.0, -3.0, -2.0, -2.5, -2.0, -0.5, -0.5, -1.5, -2.0, -2.5, -3.0, -1.5, -2.0, -2.0, -3.0, -3.0, -3.0, -0.5, -3.0, -2.0, -1.5, -2.0, -1.5, -0.5, -2.0, -3.0, -0.5, -1.5, -3.0, 0.5, -0.5, -0.5, -0.5, -1.5, -0.5, -2.0, -0.5, -3.0, -3.0, 0.5, -1.0, -0.5, -2.0, -0.5, -2.0, -1.0, -2.0, -0.5, -1.5, 0.5, -2.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.5, -1.5, -2.0, -2.0, -2.5, -1.5, 0.5, -0.5, -1.5, 0.5, -2.0, -0.5, 0.5, -1.5, -2.0, -1.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5], "policy_agent_1_reward": [-0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, -0.5], "policy_agent_2_reward": [-1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.757710134794019, "mean_inference_ms": 20.694947268492164, "mean_action_processing_ms": 2.966637598921433, "mean_env_wait_ms": 18.938878596018025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03582578897476196, "StateBufferConnector_ms": 0.012270450592041016, "ViewRequirementAgentConnector_ms": 0.20752722024917603}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.555, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 511.7735689330325, "num_env_steps_trained_throughput_per_sec": 511.7735689330325, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 7800.944, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7800.944, "sample_time_ms": 6817.839, "learn_time_ms": 942.468, "learn_throughput": 4244.176, "synch_weights_time_ms": 39.722}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "85d7a_00000", "date": "2024-09-11_18-16-33", "timestamp": 1726071393, "time_this_iter_s": 7.840226888656616, "time_total_s": 239.26077365875244, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC3F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 239.26077365875244, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 72.3, "ram_util_percent": 92.34, "gpu_util_percent0": 0.10900000000000001, "vram_util_percent0": 0.1082275390625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.39694424867630007, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0003, "total_loss": 0.051858674734830856, "policy_loss": -0.0014417728583794088, "vf_loss": 0.060400808602571486, "vf_explained_var": 0.14503021240234376, "kl": 0.0019729119823750805, "entropy": 0.7100363790988922, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46473623663187025, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0003, "total_loss": 0.06031986139714718, "policy_loss": -0.00020086463300685863, "vf_loss": 0.06961256116628647, "vf_explained_var": 0.22537220716476442, "kl": 0.00047444102965528147, "entropy": 0.9091834306716919, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.536623165011406, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0003, "total_loss": 0.057724705711007115, "policy_loss": -0.00022422739588279228, "vf_loss": 0.06548151597380639, "vf_explained_var": 0.23203007578849794, "kl": 0.00022494608128909022, "entropy": 0.7532583832740783, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3292647324502468, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0003, "total_loss": 0.010536808893084526, "policy_loss": -0.0009408475227246527, "vf_loss": 0.02288705576211214, "vf_explained_var": 0.08878456354141236, "kl": 0.0009956203757610638, "entropy": 1.1409398317337036, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.63, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.22, "agent_1": -0.205, "agent_2": -0.205, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -3.0, 0.5, -1.0, -0.5, -2.0, -0.5, -2.0, -1.0, -2.0, -0.5, -1.5, 0.5, -2.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -1.5, -1.5, -2.0, -2.0, -2.5, -1.5, 0.5, -0.5, -1.5, 0.5, -2.0, -0.5, 0.5, -1.5, -2.0, -1.5, -2.0, -1.5, -3.0, -1.5, -3.0, -0.5, -0.5, -2.0, -3.0, -1.5, -2.0, -2.0, -1.5, -3.0, -2.0, -0.5, -1.5, -2.0, -2.5, -1.5, -2.0, -1.5, -3.5, -3.5, -1.5, -2.5, -2.0, -2.0, -3.5, -2.0, -2.0, -3.0, -2.0, -2.0, -0.5, -2.5, -3.0, -2.0, -2.0, -1.5, -0.5, -3.5, -3.0, -1.5, -1.5, -1.5, -1.5, -2.0, -2.5, -1.5, -1.5, -2.0, -1.5, -3.0, -0.5, -1.5, -0.5, -0.5, -1.5, -3.5, -0.5, -2.0, -2.0, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5], "policy_agent_1_reward": [-0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5], "policy_agent_2_reward": [-1.0, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.793006458769339, "mean_inference_ms": 20.76720384000219, "mean_action_processing_ms": 2.977515938592229, "mean_env_wait_ms": 19.022996089080173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044408977031707764, "StateBufferConnector_ms": 0.011716306209564209, "ViewRequirementAgentConnector_ms": 0.22199761867523193}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.63, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 465.25891490272477, "num_env_steps_trained_throughput_per_sec": 465.25891490272477, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 7838.528, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7838.528, "sample_time_ms": 6854.359, "learn_time_ms": 942.601, "learn_throughput": 4243.575, "synch_weights_time_ms": 40.553}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "85d7a_00000", "date": "2024-09-11_18-16-42", "timestamp": 1726071402, "time_this_iter_s": 8.626368045806885, "time_total_s": 247.88714170455933, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC0D30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 247.88714170455933, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 77.58181818181818, "ram_util_percent": 92.28181818181817, "gpu_util_percent0": 0.13, "vram_util_percent0": 0.11018510298295454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4244189314544201, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0003, "total_loss": 0.020458981208503247, "policy_loss": -0.0006892216988489963, "vf_loss": 0.028750529885292052, "vf_explained_var": 0.22142696380615234, "kl": 0.00032810729026095943, "entropy": 0.7602326989173889, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 325.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4271623805165291, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0003, "total_loss": 0.024993025325238706, "policy_loss": -0.001952325830643531, "vf_loss": 0.035531746223568916, "vf_explained_var": 0.3260100960731506, "kl": 0.0017034154968314397, "entropy": 0.8586393356323242, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 325.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1411658428609371, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0003, "total_loss": 0.029533091001212597, "policy_loss": -0.0010626422591940355, "vf_loss": 0.037949318811297414, "vf_explained_var": 0.33465503454208373, "kl": 0.002627734940688242, "entropy": 0.735358464717865, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 325.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2965883955359459, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0003, "total_loss": -0.0026988237630575897, "policy_loss": -0.003020974143419153, "vf_loss": 0.012167833000421523, "vf_explained_var": 0.0800759494304657, "kl": 0.00534534803009592, "entropy": 1.1845682501792907, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 325.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.705, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.21, "agent_1": -0.335, "agent_2": -0.16, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.5, -2.0, -1.5, -2.0, -1.5, -3.0, -1.5, -3.0, -0.5, -0.5, -2.0, -3.0, -1.5, -2.0, -2.0, -1.5, -3.0, -2.0, -0.5, -1.5, -2.0, -2.5, -1.5, -2.0, -1.5, -3.5, -3.5, -1.5, -2.5, -2.0, -2.0, -3.5, -2.0, -2.0, -3.0, -2.0, -2.0, -0.5, -2.5, -3.0, -2.0, -2.0, -1.5, -0.5, -3.5, -3.0, -1.5, -1.5, -1.5, -1.5, -2.0, -2.5, -1.5, -1.5, -2.0, -1.5, -3.0, -0.5, -1.5, -0.5, -0.5, -1.5, -3.5, -0.5, -2.0, -2.0, -1.0, -1.0, -0.5, -2.0, -1.5, -0.5, 0.5, -3.0, -0.5, -0.5, -1.5, -1.0, -0.5, -3.5, -0.5, -1.5, -0.5, -1.0, -3.0, -1.0, -1.5, -1.5, -2.0, -1.5, -3.5, -2.0, -0.5, -0.5, -1.5, -2.0, -0.5, -3.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -0.5, 0.5, -1.0, 0.5], "policy_agent_1_reward": [0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5], "policy_agent_2_reward": [0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.808344017073066, "mean_inference_ms": 20.793179495477, "mean_action_processing_ms": 2.9809137731003603, "mean_env_wait_ms": 19.062991380042508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04432094097137451, "StateBufferConnector_ms": 0.014700055122375488, "ViewRequirementAgentConnector_ms": 0.2533619999885559}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.705, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.00831195767915, "num_env_steps_trained_throughput_per_sec": 503.00831195767915, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 7891.969, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7891.969, "sample_time_ms": 6904.161, "learn_time_ms": 945.901, "learn_throughput": 4228.771, "synch_weights_time_ms": 40.993}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "85d7a_00000", "date": "2024-09-11_18-16-50", "timestamp": 1726071410, "time_this_iter_s": 7.976928949356079, "time_total_s": 255.8640706539154, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC2200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 255.8640706539154, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 73.73, "ram_util_percent": 92.35000000000001, "gpu_util_percent0": 0.093, "vram_util_percent0": 0.11204833984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13287888914346696, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0003, "total_loss": 0.033204679191112516, "policy_loss": -0.0006225250645002234, "vf_loss": 0.041236643493175504, "vf_explained_var": 0.21294507384300232, "kl": 0.0002858587062291917, "entropy": 0.7409440279006958, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 335.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.21835440546274185, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0003, "total_loss": 0.03243267741054297, "policy_loss": -0.0008421361570071894, "vf_loss": 0.042164496332407, "vf_explained_var": 0.3369133293628693, "kl": 0.0007216639303806005, "entropy": 0.8889684975147247, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 335.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17965314090251921, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0003, "total_loss": 0.024845986813306808, "policy_loss": -0.00019645690168346164, "vf_loss": 0.0324271634221077, "vf_explained_var": 0.4026622951030731, "kl": 0.00042526488796283956, "entropy": 0.7384719967842102, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 335.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18431259840726852, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0003, "total_loss": -0.001578028069343418, "policy_loss": -0.0014230892928935646, "vf_loss": 0.01188412131741643, "vf_explained_var": 0.15383377075195312, "kl": 0.0019751575870031956, "entropy": 1.2039060235023498, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 335.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.755, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.215, "agent_1": -0.3, "agent_2": -0.24, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -2.0, -2.0, -3.0, -2.0, -2.0, -0.5, -2.5, -3.0, -2.0, -2.0, -1.5, -0.5, -3.5, -3.0, -1.5, -1.5, -1.5, -1.5, -2.0, -2.5, -1.5, -1.5, -2.0, -1.5, -3.0, -0.5, -1.5, -0.5, -0.5, -1.5, -3.5, -0.5, -2.0, -2.0, -1.0, -1.0, -0.5, -2.0, -1.5, -0.5, 0.5, -3.0, -0.5, -0.5, -1.5, -1.0, -0.5, -3.5, -0.5, -1.5, -0.5, -1.0, -3.0, -1.0, -1.5, -1.5, -2.0, -1.5, -3.5, -2.0, -0.5, -0.5, -1.5, -2.0, -0.5, -3.5, -0.5, -0.5, -1.5, -1.5, -3.0, -2.5, -2.0, -2.0, -0.5, -3.0, -3.5, -1.5, -2.0, -2.0, -3.5, -2.0, -1.5, -2.0, -2.0, -3.5, -2.0, -1.5, -1.5, -2.5, -2.0, -2.0, -3.0, -0.5, -3.0, -0.5, -3.0, -2.0, -1.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5], "policy_agent_1_reward": [-1.0, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5], "policy_agent_2_reward": [-1.0, 0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.80934217675027, "mean_inference_ms": 20.797008726298785, "mean_action_processing_ms": 2.984266921692695, "mean_env_wait_ms": 19.09898647079571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040569007396698, "StateBufferConnector_ms": 0.018854498863220215, "ViewRequirementAgentConnector_ms": 0.24772530794143677}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.755, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 514.0844518006605, "num_env_steps_trained_throughput_per_sec": 514.0844518006605, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 7960.375, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7960.375, "sample_time_ms": 6977.972, "learn_time_ms": 940.203, "learn_throughput": 4254.401, "synch_weights_time_ms": 41.286}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "85d7a_00000", "date": "2024-09-11_18-16-58", "timestamp": 1726071418, "time_this_iter_s": 7.806426286697388, "time_total_s": 263.6704969406128, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67E46DD0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 263.6704969406128, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 71.27000000000001, "ram_util_percent": 92.25000000000001, "gpu_util_percent0": 0.099, "vram_util_percent0": 0.10499267578125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15981214940547944, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0003, "total_loss": 0.02648060005158186, "policy_loss": -0.000508692020594026, "vf_loss": 0.033884284645318986, "vf_explained_var": 0.21502699255943297, "kl": 0.00030980167480265663, "entropy": 0.6894993126392365, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 345.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2117862232029438, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0003, "total_loss": 0.03246479984372854, "policy_loss": -0.001229918094122695, "vf_loss": 0.043282844871282575, "vf_explained_var": 0.35422128438949585, "kl": 0.00285607454534329, "entropy": 0.9588126957416534, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 345.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18912742286920547, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0003, "total_loss": 0.022755142673850058, "policy_loss": -0.0014356784409756073, "vf_loss": 0.03180113025009632, "vf_explained_var": 0.3723590075969696, "kl": 0.0013025636199017754, "entropy": 0.7610309779644012, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 345.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12732942774891853, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0003, "total_loss": 0.0011388106633603457, "policy_loss": -0.0009318092663306743, "vf_loss": 0.01392090367153287, "vf_explained_var": 0.11906262040138245, "kl": 0.002949057021760382, "entropy": 1.1850284576416015, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 345.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.235, "agent_1": -0.26, "agent_2": -0.2, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -2.0, -2.0, -1.0, -1.0, -0.5, -2.0, -1.5, -0.5, 0.5, -3.0, -0.5, -0.5, -1.5, -1.0, -0.5, -3.5, -0.5, -1.5, -0.5, -1.0, -3.0, -1.0, -1.5, -1.5, -2.0, -1.5, -3.5, -2.0, -0.5, -0.5, -1.5, -2.0, -0.5, -3.5, -0.5, -0.5, -1.5, -1.5, -3.0, -2.5, -2.0, -2.0, -0.5, -3.0, -3.5, -1.5, -2.0, -2.0, -3.5, -2.0, -1.5, -2.0, -2.0, -3.5, -2.0, -1.5, -1.5, -2.5, -2.0, -2.0, -3.0, -0.5, -3.0, -0.5, -3.0, -2.0, -1.5, -0.5, -0.5, -2.5, -1.5, -0.5, -2.0, -1.5, -0.5, -1.5, -1.5, -0.5, -1.0, -3.0, -1.5, -0.5, -3.0, -3.0, -3.0, -2.0, -3.0, -2.0, -0.5, -1.5, -2.0, -2.0, -2.0, -1.5, -3.0, -0.5, -2.0, -3.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_1_reward": [0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5], "policy_agent_2_reward": [0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.826677911660925, "mean_inference_ms": 20.80060684781037, "mean_action_processing_ms": 2.983399999850613, "mean_env_wait_ms": 19.11928296255319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041326165199279785, "StateBufferConnector_ms": 0.021791934967041016, "ViewRequirementAgentConnector_ms": 0.24503469467163086}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.695, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.65400373060004, "num_env_steps_trained_throughput_per_sec": 503.65400373060004, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 7951.249, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7951.249, "sample_time_ms": 6962.702, "learn_time_ms": 946.762, "learn_throughput": 4224.927, "synch_weights_time_ms": 40.97}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "85d7a_00000", "date": "2024-09-11_18-17-06", "timestamp": 1726071426, "time_this_iter_s": 7.972729444503784, "time_total_s": 271.6432263851166, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0D240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 271.6432263851166, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 74.39, "ram_util_percent": 92.25, "gpu_util_percent0": 0.131, "vram_util_percent0": 0.103076171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2717438668012619, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0003, "total_loss": 0.04482258707284927, "policy_loss": -0.001184580726112472, "vf_loss": 0.05298628993332386, "vf_explained_var": 0.19993311166763306, "kl": 0.0004350585910287919, "entropy": 0.6979122579097747, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 355.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38170586377382276, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0003, "total_loss": 0.054739906638860705, "policy_loss": -0.0004305351276343572, "vf_loss": 0.06442162096500396, "vf_explained_var": 0.22836827039718627, "kl": 0.0003568411702872254, "entropy": 0.9251175642013549, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 355.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3097988158464432, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0003, "total_loss": 0.046471713855862615, "policy_loss": -0.0013822347380482824, "vf_loss": 0.055592363327741624, "vf_explained_var": 0.260581248998642, "kl": 0.001467590031461441, "entropy": 0.7738416910171508, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 355.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3385449297726154, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0003, "total_loss": 0.0120514796115458, "policy_loss": 0.0001189899576274911, "vf_loss": 0.02380805294960737, "vf_explained_var": 0.06999324560165406, "kl": 0.0005090967781143263, "entropy": 1.1875561594963073, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 355.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.68, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.265, "agent_1": -0.265, "agent_2": -0.15, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -3.0, -2.0, -1.5, -0.5, -0.5, -2.5, -1.5, -0.5, -2.0, -1.5, -0.5, -1.5, -1.5, -0.5, -1.0, -3.0, -1.5, -0.5, -3.0, -3.0, -3.0, -2.0, -3.0, -2.0, -0.5, -1.5, -2.0, -2.0, -2.0, -1.5, -3.0, -0.5, -2.0, -3.0, -2.0, -2.5, -2.5, -2.0, -1.5, -2.0, -3.5, -1.5, -1.5, -1.5, -2.0, -0.5, -3.0, -0.5, -3.0, -3.5, -1.5, -2.0, -0.5, -0.5, -2.5, -3.0, -0.5, -2.0, -1.0, -3.0, -1.5, -0.5, 0.5, -1.5, -1.0, -2.5, -2.0, -1.5, -2.5, -2.0, -1.5, 0.5, -3.0, 0.5, -1.5, -1.5, -1.5, -2.5, -3.0, -1.5, -1.5, -0.5, -2.0, -2.5, -2.0, 0.5, -1.5, -0.5, -2.5, -1.0, -1.5, -2.0, -0.5, -2.0, -2.5, -0.5, -2.0, -2.0, -2.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -1.0], "policy_agent_1_reward": [-0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5], "policy_agent_2_reward": [0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.8308994155325, "mean_inference_ms": 20.81478517250516, "mean_action_processing_ms": 2.9894214904185255, "mean_env_wait_ms": 19.160932737444206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038523197174072266, "StateBufferConnector_ms": 0.019449830055236816, "ViewRequirementAgentConnector_ms": 0.20493781566619873}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.68, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 513.9433010541967, "num_env_steps_trained_throughput_per_sec": 513.9433010541967, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 7967.799, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7967.799, "sample_time_ms": 6982.05, "learn_time_ms": 943.768, "learn_throughput": 4238.33, "synch_weights_time_ms": 41.167}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "85d7a_00000", "date": "2024-09-11_18-17-13", "timestamp": 1726071433, "time_this_iter_s": 7.814743518829346, "time_total_s": 279.4579699039459, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC2200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 279.4579699039459, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 73.57000000000001, "ram_util_percent": 92.41, "gpu_util_percent0": 0.174, "vram_util_percent0": 0.1052001953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09579201191663742, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0003, "total_loss": 0.027561159431934358, "policy_loss": -0.0009396468132763403, "vf_loss": 0.03665395602583885, "vf_explained_var": 0.24377921223640442, "kl": 0.001036856882228676, "entropy": 0.8153150200843811, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 365.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2831565022468567, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0003, "total_loss": 0.027400222420692445, "policy_loss": -0.0013859941351256565, "vf_loss": 0.038060910254716876, "vf_explained_var": 0.412047278881073, "kl": 0.001899250026417576, "entropy": 0.927469527721405, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 365.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19768295735120772, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0003, "total_loss": 0.02479311916977167, "policy_loss": -0.0006716336050772043, "vf_loss": 0.033356087654829024, "vf_explained_var": 0.38803213834762573, "kl": 0.0010199788400200305, "entropy": 0.7891333043575287, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 365.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.20380297899246216, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0003, "total_loss": -0.001570973769412376, "policy_loss": -0.0009215692665748065, "vf_loss": 0.011491455137729645, "vf_explained_var": 0.1345938563346863, "kl": 0.001019165972047631, "entropy": 1.214085876941681, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 365.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.665, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.23, "agent_1": -0.235, "agent_2": -0.2, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -2.0, -3.0, -2.0, -2.5, -2.5, -2.0, -1.5, -2.0, -3.5, -1.5, -1.5, -1.5, -2.0, -0.5, -3.0, -0.5, -3.0, -3.5, -1.5, -2.0, -0.5, -0.5, -2.5, -3.0, -0.5, -2.0, -1.0, -3.0, -1.5, -0.5, 0.5, -1.5, -1.0, -2.5, -2.0, -1.5, -2.5, -2.0, -1.5, 0.5, -3.0, 0.5, -1.5, -1.5, -1.5, -2.5, -3.0, -1.5, -1.5, -0.5, -2.0, -2.5, -2.0, 0.5, -1.5, -0.5, -2.5, -1.0, -1.5, -2.0, -0.5, -2.0, -2.5, -0.5, -2.0, -2.0, -2.5, -1.0, -3.0, -3.0, -2.0, -2.0, -2.0, -1.5, -1.5, -1.5, -1.5, -3.0, -3.0, -2.0, -1.5, -2.0, -1.0, -2.0, -0.5, -2.0, 0.5, -1.0, -2.0, -2.0, -3.0, -2.0, -0.5, 0.5, -0.5, -3.0, -0.5, -0.5, -3.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_1_reward": [0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5], "policy_agent_2_reward": [0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.83635515950202, "mean_inference_ms": 20.843867666067023, "mean_action_processing_ms": 2.9939167042505073, "mean_env_wait_ms": 19.200387716372106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499007225036621, "StateBufferConnector_ms": 0.015914201736450195, "ViewRequirementAgentConnector_ms": 0.2059517502784729}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.665, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.6137537267238, "num_env_steps_trained_throughput_per_sec": 467.6137537267238, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 8007.612, "restore_workers_time_ms": 0.0, "training_step_time_ms": 8007.612, "sample_time_ms": 7035.404, "learn_time_ms": 930.396, "learn_throughput": 4299.246, "synch_weights_time_ms": 41.012}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "85d7a_00000", "date": "2024-09-11_18-17-22", "timestamp": 1726071442, "time_this_iter_s": 8.583462238311768, "time_total_s": 288.0414321422577, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC1990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 288.0414321422577, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 75.80909090909091, "ram_util_percent": 92.47272727272727, "gpu_util_percent0": 0.07909090909090909, "vram_util_percent0": 0.10268332741477272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.07495733723044395, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0003, "total_loss": 0.029270475544035435, "policy_loss": -0.0005393350594204094, "vf_loss": 0.03707481324672699, "vf_explained_var": 0.26696069836616515, "kl": 0.0006618773146328749, "entropy": 0.7265001773834229, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 375.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.14177020117640496, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0003, "total_loss": 0.02866316642612219, "policy_loss": -0.0003535307177571667, "vf_loss": 0.038835125416517256, "vf_explained_var": 0.37743807435035703, "kl": 0.0005116896445542807, "entropy": 0.9818429529666901, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 375.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13180314153432846, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0003, "total_loss": 0.02069366816431284, "policy_loss": -0.001750029867793046, "vf_loss": 0.03028996232897043, "vf_explained_var": 0.39447854161262513, "kl": 0.000589791769743897, "entropy": 0.7846262514591217, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 375.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18539862483739852, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0003, "total_loss": -0.0011228083210880868, "policy_loss": -0.001771263678529067, "vf_loss": 0.012742476537823677, "vf_explained_var": 0.10428193807601929, "kl": 0.0017893481493956643, "entropy": 1.2094021677970885, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 375.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.675, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.2, "agent_1": -0.225, "agent_2": -0.25, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5, -1.0, -2.5, -2.0, -1.5, -2.5, -2.0, -1.5, 0.5, -3.0, 0.5, -1.5, -1.5, -1.5, -2.5, -3.0, -1.5, -1.5, -0.5, -2.0, -2.5, -2.0, 0.5, -1.5, -0.5, -2.5, -1.0, -1.5, -2.0, -0.5, -2.0, -2.5, -0.5, -2.0, -2.0, -2.5, -1.0, -3.0, -3.0, -2.0, -2.0, -2.0, -1.5, -1.5, -1.5, -1.5, -3.0, -3.0, -2.0, -1.5, -2.0, -1.0, -2.0, -0.5, -2.0, 0.5, -1.0, -2.0, -2.0, -3.0, -2.0, -0.5, 0.5, -0.5, -3.0, -0.5, -0.5, -3.0, 0.5, -0.5, -0.5, -2.0, -0.5, -2.0, -1.5, -2.0, -1.0, -3.5, -2.0, -3.0, -2.0, -1.5, -0.5, -0.5, -2.0, -3.5, -2.0, -2.0, -3.0, -3.0, -0.5, -2.5, -0.5, -3.0, -3.0, -0.5, -3.0, -3.0, -3.0, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_1_reward": [-0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5], "policy_agent_2_reward": [0.5, -1.0, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.842283111244571, "mean_inference_ms": 20.877217221856462, "mean_action_processing_ms": 3.0008535999826584, "mean_env_wait_ms": 19.254258554718646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03490513563156128, "StateBufferConnector_ms": 0.01459348201751709, "ViewRequirementAgentConnector_ms": 0.19289404153823853}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.675, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 477.6239328045271, "num_env_steps_trained_throughput_per_sec": 477.6239328045271, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 8050.021, "restore_workers_time_ms": 0.0, "training_step_time_ms": 8050.021, "sample_time_ms": 7055.143, "learn_time_ms": 952.506, "learn_throughput": 4199.45, "synch_weights_time_ms": 41.573}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "85d7a_00000", "date": "2024-09-11_18-17-31", "timestamp": 1726071451, "time_this_iter_s": 8.403069257736206, "time_total_s": 296.4445013999939, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC2C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 296.4445013999939, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 72.99090909090908, "ram_util_percent": 92.51818181818183, "gpu_util_percent0": 0.1509090909090909, "vram_util_percent0": 0.1063232421875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19393147602677346, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0003, "total_loss": 0.022173361293971537, "policy_loss": -0.0010313600275367208, "vf_loss": 0.029640921205282212, "vf_explained_var": 0.23294329643249512, "kl": 0.0006704229972456233, "entropy": 0.6436200141906738, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 385.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1505079947412014, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0003, "total_loss": 0.026223548874258994, "policy_loss": -0.0018061880487948655, "vf_loss": 0.038025906682014464, "vf_explained_var": 0.3747318506240845, "kl": 0.0009370959593979933, "entropy": 0.9996171534061432, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 385.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1267218567430973, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0003, "total_loss": 0.022801715508103372, "policy_loss": -0.0010492983406948041, "vf_loss": 0.03144930675625801, "vf_explained_var": 0.36810621023178103, "kl": 0.0005690011616025003, "entropy": 0.7598293662071228, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 385.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1819652333855629, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0003, "total_loss": 0.001004566099436488, "policy_loss": -0.0010212460714683403, "vf_loss": 0.014006692636758088, "vf_explained_var": 0.0871644914150238, "kl": 0.0008912522051105042, "entropy": 1.198088002204895, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 385.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.7, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.235, "agent_1": -0.2, "agent_2": -0.265, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -2.0, -2.0, -2.5, -1.0, -3.0, -3.0, -2.0, -2.0, -2.0, -1.5, -1.5, -1.5, -1.5, -3.0, -3.0, -2.0, -1.5, -2.0, -1.0, -2.0, -0.5, -2.0, 0.5, -1.0, -2.0, -2.0, -3.0, -2.0, -0.5, 0.5, -0.5, -3.0, -0.5, -0.5, -3.0, 0.5, -0.5, -0.5, -2.0, -0.5, -2.0, -1.5, -2.0, -1.0, -3.5, -2.0, -3.0, -2.0, -1.5, -0.5, -0.5, -2.0, -3.5, -2.0, -2.0, -3.0, -3.0, -0.5, -2.5, -0.5, -3.0, -3.0, -0.5, -3.0, -3.0, -3.0, -0.5, -2.0, -0.5, -2.0, 0.5, -2.0, -0.5, -1.5, -3.5, -1.0, -0.5, -2.0, -0.5, -1.5, -3.5, -1.5, -3.0, -1.5, -0.5, -3.0, -1.0, -0.5, -1.5, -2.0, -1.5, -3.0, -3.5, -2.0, -1.0, -2.0, 0.5, -2.0, -3.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5], "policy_agent_1_reward": [-0.5, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5], "policy_agent_2_reward": [0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.855985568260364, "mean_inference_ms": 20.911860850135668, "mean_action_processing_ms": 3.004081941605963, "mean_env_wait_ms": 19.298213611629517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0308341383934021, "StateBufferConnector_ms": 0.01540905237197876, "ViewRequirementAgentConnector_ms": 0.19658881425857544}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.7, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 521.657152565325, "num_env_steps_trained_throughput_per_sec": 521.657152565325, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 8081.515, "restore_workers_time_ms": 0.0, "training_step_time_ms": 8081.515, "sample_time_ms": 7086.003, "learn_time_ms": 953.212, "learn_throughput": 4196.336, "synch_weights_time_ms": 41.495}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "85d7a_00000", "date": "2024-09-11_18-17-38", "timestamp": 1726071458, "time_this_iter_s": 7.692132472991943, "time_total_s": 304.13663387298584, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC25F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 304.13663387298584, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 71.32000000000001, "ram_util_percent": 92.56, "gpu_util_percent0": 0.14100000000000001, "vram_util_percent0": 0.103271484375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17041559219360353, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0003, "total_loss": 0.03720114044845104, "policy_loss": -0.0009311373406035272, "vf_loss": 0.044861385598778725, "vf_explained_var": 0.21355396509170532, "kl": 0.0008797024443992996, "entropy": 0.6729106187820435, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 395.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1555632844567299, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0003, "total_loss": 0.03885349817574024, "policy_loss": -0.001295516835671151, "vf_loss": 0.05042437091469765, "vf_explained_var": 0.32181228399276735, "kl": 0.002216046385728987, "entropy": 1.0275356888771057, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 395.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.20768858939409257, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0003, "total_loss": 0.04152553454041481, "policy_loss": -0.001077898660878418, "vf_loss": 0.050362075492739675, "vf_explained_var": 0.2868440687656403, "kl": 0.0020793744051843532, "entropy": 0.775864326953888, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 395.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3546957455575466, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0003, "total_loss": 0.010637692175805569, "policy_loss": -0.0018233246442378003, "vf_loss": 0.024622564017772675, "vf_explained_var": 0.05471634864807129, "kl": 0.004669619867854635, "entropy": 1.2161545395851134, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 395.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.38, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.145, "agent_1": -0.135, "agent_2": -0.1, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -3.0, -3.0, -0.5, -2.0, -0.5, -2.0, 0.5, -2.0, -0.5, -1.5, -3.5, -1.0, -0.5, -2.0, -0.5, -1.5, -3.5, -1.5, -3.0, -1.5, -0.5, -3.0, -1.0, -0.5, -1.5, -2.0, -1.5, -3.0, -3.5, -2.0, -1.0, -2.0, 0.5, -2.0, -3.0, -2.5, -3.0, -2.0, -0.5, -2.0, -2.0, -0.5, -1.0, -1.5, 0.5, -3.0, -0.5, -2.0, -2.0, 0.5, -0.5, -0.5, -3.0, 0.5, 0.5, -0.5, -1.0, -1.5, -0.5, 0.5, -0.5, -2.0, -1.5, -2.0, -1.5, -2.0, -2.0, -1.0, -2.0, -0.5, -3.5, -0.5, -0.5, -1.0, -0.5, -2.0, -0.5, -0.5, -0.5, -0.5, -2.0, -1.5, -2.5, 0.5, -0.5, -0.5, -2.0, -2.0, -3.0, -1.0, -1.5, -2.0, -0.5, -0.5, -0.5, -1.5, -1.5, -1.5, 0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5], "policy_agent_1_reward": [-0.5, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5], "policy_agent_2_reward": [-1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.83896329425768, "mean_inference_ms": 20.898882214505456, "mean_action_processing_ms": 3.002937322271192, "mean_env_wait_ms": 19.29177327538371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03709977865219116, "StateBufferConnector_ms": 0.015402615070343018, "ViewRequirementAgentConnector_ms": 0.17709296941757202}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.38, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 557.0503043782355, "num_env_steps_trained_throughput_per_sec": 557.0503043782355, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 7964.863, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7964.863, "sample_time_ms": 6973.921, "learn_time_ms": 950.305, "learn_throughput": 4209.176, "synch_weights_time_ms": 39.933}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "85d7a_00000", "date": "2024-09-11_18-17-46", "timestamp": 1726071466, "time_this_iter_s": 7.2099363803863525, "time_total_s": 311.3465702533722, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0DCF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 311.3465702533722, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 67.47777777777779, "ram_util_percent": 92.55555555555556, "gpu_util_percent0": 0.07, "vram_util_percent0": 0.1011962890625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3565764054656029, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0003, "total_loss": 0.027149051241576672, "policy_loss": -0.000397461511875008, "vf_loss": 0.03490501567721367, "vf_explained_var": 0.12179373502731324, "kl": 0.0002356291141040856, "entropy": 0.7358503580093384, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2828559711575508, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0003, "total_loss": 0.02426263950765133, "policy_loss": -0.0008345519738213625, "vf_loss": 0.034746238961815834, "vf_explained_var": 0.44861161708831787, "kl": 0.0004785011090007174, "entropy": 0.9649048745632172, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15831435546278955, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0003, "total_loss": 0.024786047451198102, "policy_loss": -0.0003280447695942712, "vf_loss": 0.03275355063378811, "vf_explained_var": 0.4186471998691559, "kl": 0.00043431408312244457, "entropy": 0.7639460444450379, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18477929681539534, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0003, "total_loss": -0.003184929443523288, "policy_loss": -0.0018414499554637587, "vf_loss": 0.011098322086036205, "vf_explained_var": 0.146341472864151, "kl": 0.001862700690253405, "entropy": 1.2441802859306335, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.17, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.055, "agent_1": -0.085, "agent_2": -0.03, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, 0.5, -2.0, -3.0, -2.5, -3.0, -2.0, -0.5, -2.0, -2.0, -0.5, -1.0, -1.5, 0.5, -3.0, -0.5, -2.0, -2.0, 0.5, -0.5, -0.5, -3.0, 0.5, 0.5, -0.5, -1.0, -1.5, -0.5, 0.5, -0.5, -2.0, -1.5, -2.0, -1.5, -2.0, -2.0, -1.0, -2.0, -0.5, -3.5, -0.5, -0.5, -1.0, -0.5, -2.0, -0.5, -0.5, -0.5, -0.5, -2.0, -1.5, -2.5, 0.5, -0.5, -0.5, -2.0, -2.0, -3.0, -1.0, -1.5, -2.0, -0.5, -0.5, -0.5, -1.5, -1.5, -1.5, 0.5, 0.5, -2.5, -0.5, -3.0, -2.0, -3.0, -3.5, -3.0, -0.5, -2.0, -0.5, -1.0, -2.0, -1.0, -2.0, -1.5, -2.0, 0.5, -0.5, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -1.5, -0.5, -0.5, 0.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5], "policy_agent_1_reward": [0.5, 0.5, -1.0, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_2_reward": [-1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.833201360841718, "mean_inference_ms": 20.87333373098676, "mean_action_processing_ms": 2.999001552076787, "mean_env_wait_ms": 19.276559485835413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053218960762023926, "StateBufferConnector_ms": 0.016734838485717773, "ViewRequirementAgentConnector_ms": 0.19068008661270142}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.17, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 531.3471629191661, "num_env_steps_trained_throughput_per_sec": 531.3471629191661, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 7936.071, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7936.071, "sample_time_ms": 6960.988, "learn_time_ms": 934.967, "learn_throughput": 4278.228, "synch_weights_time_ms": 39.412}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "85d7a_00000", "date": "2024-09-11_18-17-53", "timestamp": 1726071473, "time_this_iter_s": 7.553065061569214, "time_total_s": 318.8996353149414, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC2C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 318.8996353149414, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 66.53, "ram_util_percent": 92.62, "gpu_util_percent0": 0.101, "vram_util_percent0": 0.1060546875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.14024126306176185, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0003, "total_loss": 0.023474232479929923, "policy_loss": -0.001091252289370459, "vf_loss": 0.030873955599963664, "vf_explained_var": 0.21435371041297913, "kl": 0.0005475437515087833, "entropy": 0.6308471083641052, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 415.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.14703921526670455, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0003, "total_loss": 0.024758117087185384, "policy_loss": -0.0013665970099282277, "vf_loss": 0.036000045388936995, "vf_explained_var": 0.39029889106750487, "kl": 0.0020286564011257726, "entropy": 0.9875332534313201, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 415.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18652236759662627, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0003, "total_loss": 0.029317470267415047, "policy_loss": -0.0003331697669636924, "vf_loss": 0.03729560971260071, "vf_explained_var": 0.3574854671955109, "kl": 0.0004213045658161718, "entropy": 0.7644969701766968, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 415.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13164650797843933, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0003, "total_loss": 0.00017155051973531953, "policy_loss": -0.0006119302546721883, "vf_loss": 0.012856461107730865, "vf_explained_var": 0.06397412419319153, "kl": 0.0012695109006017446, "entropy": 1.2072981476783753, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 415.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.21, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.06, "agent_1": -0.19, "agent_2": 0.04, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -1.5, -2.0, -2.0, -1.0, -2.0, -0.5, -3.5, -0.5, -0.5, -1.0, -0.5, -2.0, -0.5, -0.5, -0.5, -0.5, -2.0, -1.5, -2.5, 0.5, -0.5, -0.5, -2.0, -2.0, -3.0, -1.0, -1.5, -2.0, -0.5, -0.5, -0.5, -1.5, -1.5, -1.5, 0.5, 0.5, -2.5, -0.5, -3.0, -2.0, -3.0, -3.5, -3.0, -0.5, -2.0, -0.5, -1.0, -2.0, -1.0, -2.0, -1.5, -2.0, 0.5, -0.5, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -1.5, -0.5, -0.5, 0.5, -0.5, -1.5, -0.5, -0.5, -0.5, -0.5, -2.0, -1.5, -3.5, 0.5, -1.5, -2.0, -0.5, -2.0, -2.0, -0.5, -0.5, -2.0, -0.5, -0.5, -1.5, -2.0, -2.0, -3.0, -2.5, -1.5, -0.5, -0.5, -0.5, -0.5, -2.0, -3.0, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5], "policy_agent_1_reward": [0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5], "policy_agent_2_reward": [-1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.820125552096425, "mean_inference_ms": 20.84601392455023, "mean_action_processing_ms": 2.997078244106985, "mean_env_wait_ms": 19.266065822200567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05992293357849121, "StateBufferConnector_ms": 0.020236194133758545, "ViewRequirementAgentConnector_ms": 0.1852617859840393}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.21, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 561.6872429636832, "num_env_steps_trained_throughput_per_sec": 561.6872429636832, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 7788.474, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7788.474, "sample_time_ms": 6826.116, "learn_time_ms": 922.902, "learn_throughput": 4334.154, "synch_weights_time_ms": 38.752}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "85d7a_00000", "date": "2024-09-11_18-18-00", "timestamp": 1726071480, "time_this_iter_s": 7.1450817584991455, "time_total_s": 326.04471707344055, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0C310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 326.04471707344055, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 66.28888888888889, "ram_util_percent": 92.58888888888889, "gpu_util_percent0": 0.06555555555555556, "vram_util_percent0": 0.0991482204861111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1348998501896858, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0003, "total_loss": 0.026896987296640872, "policy_loss": -0.0015207589640340302, "vf_loss": 0.03382041752338409, "vf_explained_var": 0.2242500901222229, "kl": 0.0004761642041557934, "entropy": 0.5402668595314026, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 425.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.27716376483440397, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0003, "total_loss": 0.013500378653407096, "policy_loss": -0.0013772940588751225, "vf_loss": 0.02458483073860407, "vf_explained_var": 0.45440751910209654, "kl": 0.001104362624755595, "entropy": 0.9707156777381897, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 425.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11726246401667595, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0003, "total_loss": 0.021337675116956233, "policy_loss": -0.0007788517938024597, "vf_loss": 0.029380768164992334, "vf_explained_var": 0.39703386425971987, "kl": 0.0002898852396356233, "entropy": 0.7264241993427276, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 425.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11611327528953552, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0003, "total_loss": 0.0009211273575147061, "policy_loss": -0.0013873336557480797, "vf_loss": 0.014396525919437408, "vf_explained_var": 0.04230251908302307, "kl": 0.0006316225646514795, "entropy": 1.2088064908981324, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 425.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.155, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.02, "agent_1": -0.205, "agent_2": 0.03, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5, -1.5, -1.5, 0.5, 0.5, -2.5, -0.5, -3.0, -2.0, -3.0, -3.5, -3.0, -0.5, -2.0, -0.5, -1.0, -2.0, -1.0, -2.0, -1.5, -2.0, 0.5, -0.5, -0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -1.5, -0.5, -0.5, 0.5, -0.5, -1.5, -0.5, -0.5, -0.5, -0.5, -2.0, -1.5, -3.5, 0.5, -1.5, -2.0, -0.5, -2.0, -2.0, -0.5, -0.5, -2.0, -0.5, -0.5, -1.5, -2.0, -2.0, -3.0, -2.5, -1.5, -0.5, -0.5, -0.5, -0.5, -2.0, -3.0, -0.5, -3.5, -3.0, 0.5, -0.5, -2.5, -0.5, -2.0, -2.0, -1.0, 0.5, -2.0, 0.5, -2.0, -1.5, -3.0, -0.5, -0.5, -0.5, 0.5, -2.0, -2.0, -0.5, -1.0, 0.5, -1.5, -0.5, -1.5, -0.5, -2.0, -1.0, -0.5, 0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_1_reward": [-0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5], "policy_agent_2_reward": [0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.815438829349286, "mean_inference_ms": 20.817192863226765, "mean_action_processing_ms": 2.991550153175432, "mean_env_wait_ms": 19.23587566906187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052431583404541016, "StateBufferConnector_ms": 0.01744741201400757, "ViewRequirementAgentConnector_ms": 0.18905222415924072}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.155, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.8549107432821, "num_env_steps_trained_throughput_per_sec": 544.8549107432821, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 7727.399, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7727.399, "sample_time_ms": 6760.752, "learn_time_ms": 927.761, "learn_throughput": 4311.455, "synch_weights_time_ms": 38.083}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "85d7a_00000", "date": "2024-09-11_18-18-08", "timestamp": 1726071488, "time_this_iter_s": 7.3699164390563965, "time_total_s": 333.41463351249695, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0F370>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 333.41463351249695, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 70.25555555555556, "ram_util_percent": 92.55555555555554, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.09779188368055555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.147439906001091, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0003, "total_loss": 0.038249483332037926, "policy_loss": -0.0006460682713623101, "vf_loss": 0.04378718435764313, "vf_explained_var": 0.2164182186126709, "kl": 0.001088859840092482, "entropy": 0.4891632288694382, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 435.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4921595096588135, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0003, "total_loss": 0.04724301137030125, "policy_loss": -0.0020398521122842795, "vf_loss": 0.059293079748749734, "vf_explained_var": 0.39296325445175173, "kl": 0.0006852769165561767, "entropy": 1.0010220289230347, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 435.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17853121161460878, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0003, "total_loss": 0.042040057480335236, "policy_loss": -0.0013321012815140421, "vf_loss": 0.05057060830295086, "vf_explained_var": 0.3106798708438873, "kl": 0.0019783879151873407, "entropy": 0.7198448836803436, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 435.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.31404055207967757, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0003, "total_loss": 0.011451831366866828, "policy_loss": -0.0006131946486675588, "vf_loss": 0.024547708220779896, "vf_explained_var": 0.06167855262756348, "kl": 0.0010393823920821887, "entropy": 1.2482680439949037, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 435.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.19, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.015, "agent_1": -0.155, "agent_2": -0.02, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -2.0, -3.0, -0.5, -3.5, -3.0, 0.5, -0.5, -2.5, -0.5, -2.0, -2.0, -1.0, 0.5, -2.0, 0.5, -2.0, -1.5, -3.0, -0.5, -0.5, -0.5, 0.5, -2.0, -2.0, -0.5, -1.0, 0.5, -1.5, -0.5, -1.5, -0.5, -2.0, -1.0, -0.5, 0.5, -2.0, -2.0, -0.5, -2.0, -0.5, 0.5, -1.5, -2.5, -0.5, -2.0, -1.5, -3.0, 0.5, 0.5, -2.0, -0.5, -1.5, -0.5, -3.0, -0.5, -1.5, -0.5, -2.0, -2.0, -2.5, -0.5, -3.0, -1.5, -3.0, -1.5, -1.5, -3.0, -0.5, -1.5, -0.5, -0.5, -2.0, -0.5, -0.5, -0.5, -1.5, 0.5, -2.0, -2.0, 0.5, -1.5, -0.5, -2.0, -1.5, -1.0, -1.5, -0.5, -0.5, -0.5, -0.5, -2.0, -3.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5], "policy_agent_1_reward": [-0.5, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5], "policy_agent_2_reward": [0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.815205690312602, "mean_inference_ms": 20.815841539778685, "mean_action_processing_ms": 2.991713951102288, "mean_env_wait_ms": 19.22732932866884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04297935962677002, "StateBufferConnector_ms": 0.019996464252471924, "ViewRequirementAgentConnector_ms": 0.20819246768951416}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.19, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 474.15377979521577, "num_env_steps_trained_throughput_per_sec": 474.15377979521577, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 7792.925, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7792.925, "sample_time_ms": 6810.675, "learn_time_ms": 943.774, "learn_throughput": 4238.302, "synch_weights_time_ms": 37.673}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "85d7a_00000", "date": "2024-09-11_18-18-16", "timestamp": 1726071496, "time_this_iter_s": 8.46542501449585, "time_total_s": 341.8800585269928, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC0C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 341.8800585269928, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 77.47272727272727, "ram_util_percent": 92.68181818181819, "gpu_util_percent0": 0.22272727272727275, "vram_util_percent0": 0.11051802201704546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12674957662820815, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0003, "total_loss": 0.02927253246307373, "policy_loss": -0.00039061373190634184, "vf_loss": 0.03625171482563019, "vf_explained_var": 0.22890738844871522, "kl": 0.0003008992433024105, "entropy": 0.658856850862503, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 445.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16851462796330452, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0003, "total_loss": 0.026287634670734406, "policy_loss": -0.0014332962200569455, "vf_loss": 0.03667961172759533, "vf_explained_var": 0.4150147378444672, "kl": 0.001387724460073514, "entropy": 0.895868057012558, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 445.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2031744472682476, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0003, "total_loss": 0.0235670231282711, "policy_loss": -0.0007954637166335488, "vf_loss": 0.031430868245661256, "vf_explained_var": 0.4072008728981018, "kl": 0.001413364985296539, "entropy": 0.7068383455276489, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 445.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18094948828220367, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0003, "total_loss": -0.0017375521041685716, "policy_loss": -0.0012454499602426949, "vf_loss": 0.01215143660083413, "vf_explained_var": 0.08254179358482361, "kl": 0.001093825068892329, "entropy": 1.2643538475036622, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 445.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.23, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.085, "agent_1": -0.095, "agent_2": -0.05, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -1.0, -0.5, 0.5, -2.0, -2.0, -0.5, -2.0, -0.5, 0.5, -1.5, -2.5, -0.5, -2.0, -1.5, -3.0, 0.5, 0.5, -2.0, -0.5, -1.5, -0.5, -3.0, -0.5, -1.5, -0.5, -2.0, -2.0, -2.5, -0.5, -3.0, -1.5, -3.0, -1.5, -1.5, -3.0, -0.5, -1.5, -0.5, -0.5, -2.0, -0.5, -0.5, -0.5, -1.5, 0.5, -2.0, -2.0, 0.5, -1.5, -0.5, -2.0, -1.5, -1.0, -1.5, -0.5, -0.5, -0.5, -0.5, -2.0, -3.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.5, -2.0, -1.5, -1.0, 0.5, -1.0, -0.5, -2.0, -1.5, -2.0, -2.0, -0.5, 0.5, -2.5, 0.5, -2.5, -1.5, -3.0, -2.0, -1.0, -3.0, -0.5, -0.5, 0.5, -0.5, -0.5, -1.0, -2.0, -0.5, -2.0, -2.0, -2.0, -3.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5], "policy_agent_1_reward": [-0.5, 0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5], "policy_agent_2_reward": [-1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.818402445974431, "mean_inference_ms": 20.820364693659926, "mean_action_processing_ms": 2.9921165753117656, "mean_env_wait_ms": 19.236998673830932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03984004259109497, "StateBufferConnector_ms": 0.018754303455352783, "ViewRequirementAgentConnector_ms": 0.2205926775932312}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.23, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 544.1122715180303, "num_env_steps_trained_throughput_per_sec": 544.1122715180303, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 7733.871, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7733.871, "sample_time_ms": 6759.456, "learn_time_ms": 936.085, "learn_throughput": 4273.115, "synch_weights_time_ms": 37.426}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "85d7a_00000", "date": "2024-09-11_18-18-24", "timestamp": 1726071504, "time_this_iter_s": 7.384119987487793, "time_total_s": 349.2641785144806, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC0EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 349.2641785144806, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 69.73333333333332, "ram_util_percent": 92.64444444444445, "gpu_util_percent0": 0.08555555555555555, "vram_util_percent0": 0.10686577690972222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1880244269967079, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0003, "total_loss": 0.02543230839073658, "policy_loss": -0.0013711816771319718, "vf_loss": 0.031750664301216605, "vf_explained_var": 0.30651767253875734, "kl": 0.0011603673505760526, "entropy": 0.49471744894981384, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 455.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1618291661143303, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0003, "total_loss": 0.025060621649026872, "policy_loss": -0.0002493037023668876, "vf_loss": 0.0347899854183197, "vf_explained_var": 0.42269682288169863, "kl": 0.00016811224559205585, "entropy": 0.9480059266090393, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 455.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17588770911097526, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0003, "total_loss": 0.01958440188318491, "policy_loss": -0.0007602153622428886, "vf_loss": 0.027496172674000265, "vf_explained_var": 0.3930259346961975, "kl": 0.000827561413825606, "entropy": 0.7151556193828583, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 455.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.14096814766526222, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0003, "total_loss": 0.00015068112625158392, "policy_loss": -0.0003229437652407796, "vf_loss": 0.013144981767982244, "vf_explained_var": 0.06755037903785706, "kl": 0.000606150078601786, "entropy": 1.2671356797218323, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 455.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.17, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.095, "agent_1": -0.05, "agent_2": -0.025, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -1.5, -1.5, -3.0, -0.5, -1.5, -0.5, -0.5, -2.0, -0.5, -0.5, -0.5, -1.5, 0.5, -2.0, -2.0, 0.5, -1.5, -0.5, -2.0, -1.5, -1.0, -1.5, -0.5, -0.5, -0.5, -0.5, -2.0, -3.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.5, -2.0, -1.5, -1.0, 0.5, -1.0, -0.5, -2.0, -1.5, -2.0, -2.0, -0.5, 0.5, -2.5, 0.5, -2.5, -1.5, -3.0, -2.0, -1.0, -3.0, -0.5, -0.5, 0.5, -0.5, -0.5, -1.0, -2.0, -0.5, -2.0, -2.0, -2.0, -3.0, -1.0, -0.5, -2.0, -0.5, -0.5, 0.5, -3.0, -3.5, 0.5, -0.5, -2.0, -2.5, -1.5, -0.5, 0.5, -1.0, 0.5, -0.5, -3.0, -3.5, -0.5, -0.5, -2.0, -0.5, -2.0, -0.5, -1.0, -1.5, -0.5, -0.5, -1.0, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5], "policy_agent_1_reward": [-0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_2_reward": [-1.0, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.802247350740899, "mean_inference_ms": 20.799294494495907, "mean_action_processing_ms": 2.9914110482338354, "mean_env_wait_ms": 19.22855070954178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030474424362182617, "StateBufferConnector_ms": 0.01790916919708252, "ViewRequirementAgentConnector_ms": 0.21373975276947021}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.17, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 553.4604506680994, "num_env_steps_trained_throughput_per_sec": 553.4604506680994, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 7678.301, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7678.301, "sample_time_ms": 6689.211, "learn_time_ms": 950.627, "learn_throughput": 4207.751, "synch_weights_time_ms": 37.546}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "85d7a_00000", "date": "2024-09-11_18-18-31", "timestamp": 1726071511, "time_this_iter_s": 7.258669137954712, "time_total_s": 356.5228476524353, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC17E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 356.5228476524353, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 63.30999999999999, "ram_util_percent": 92.47999999999999, "gpu_util_percent0": 0.07700000000000001, "vram_util_percent0": 0.10238037109375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12092206627130508, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0003, "total_loss": 0.02023363169282675, "policy_loss": -0.0010104749670972525, "vf_loss": 0.025900384038686754, "vf_explained_var": 0.24685223698616027, "kl": 0.0005358424423320685, "entropy": 0.4656277000904083, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19499588161706924, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0003, "total_loss": 0.017095476295799016, "policy_loss": -0.0007245593106745219, "vf_loss": 0.02727101929485798, "vf_explained_var": 0.4914116203784943, "kl": 0.00036420670503503063, "entropy": 0.9450984597206116, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1134318932890892, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0003, "total_loss": 0.02355938795953989, "policy_loss": -0.0016082741913123755, "vf_loss": 0.03223187290132046, "vf_explained_var": 0.3727035760879517, "kl": 0.0009830791519561898, "entropy": 0.7064212203025818, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10270779579877853, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0003, "total_loss": 0.0012798776078852825, "policy_loss": -0.0007298362696019467, "vf_loss": 0.014864380285143853, "vf_explained_var": 0.01789391040802002, "kl": 0.0005697550979675726, "entropy": 1.285466456413269, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.125, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.045, "agent_1": -0.04, "agent_2": -0.04, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -0.5, -0.5, -1.5, -2.0, -1.5, -1.0, 0.5, -1.0, -0.5, -2.0, -1.5, -2.0, -2.0, -0.5, 0.5, -2.5, 0.5, -2.5, -1.5, -3.0, -2.0, -1.0, -3.0, -0.5, -0.5, 0.5, -0.5, -0.5, -1.0, -2.0, -0.5, -2.0, -2.0, -2.0, -3.0, -1.0, -0.5, -2.0, -0.5, -0.5, 0.5, -3.0, -3.5, 0.5, -0.5, -2.0, -2.5, -1.5, -0.5, 0.5, -1.0, 0.5, -0.5, -3.0, -3.5, -0.5, -0.5, -2.0, -0.5, -2.0, -0.5, -1.0, -1.5, -0.5, -0.5, -1.0, -0.5, -1.5, -0.5, -1.5, -2.0, 0.5, 0.5, -1.5, 0.5, -1.0, -0.5, -0.5, -2.0, -3.0, -0.5, -1.0, -1.5, -0.5, -0.5, -1.5, 0.5, -3.0, -2.0, -2.0, -0.5, -0.5, -2.0, -2.0, 0.5, -1.5, -2.0, 0.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5], "policy_agent_1_reward": [0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5], "policy_agent_2_reward": [0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.797744901136902, "mean_inference_ms": 20.770570141508518, "mean_action_processing_ms": 2.9858996498894657, "mean_env_wait_ms": 19.201079571129796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02787315845489502, "StateBufferConnector_ms": 0.013618946075439453, "ViewRequirementAgentConnector_ms": 0.19628959894180298}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.125, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.3943291141087, "num_env_steps_trained_throughput_per_sec": 546.3943291141087, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 7554.966, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7554.966, "sample_time_ms": 6565.662, "learn_time_ms": 950.867, "learn_throughput": 4206.688, "synch_weights_time_ms": 37.621}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "85d7a_00000", "date": "2024-09-11_18-18-38", "timestamp": 1726071518, "time_this_iter_s": 7.34714937210083, "time_total_s": 363.86999702453613, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0E3B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 363.86999702453613, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 71.06666666666668, "ram_util_percent": 92.4, "gpu_util_percent0": 0.09777777777777778, "vram_util_percent0": 0.10272894965277778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2563316151499748, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0003, "total_loss": 0.03839595317840576, "policy_loss": -0.0011360223923475132, "vf_loss": 0.04472527988255024, "vf_explained_var": 0.281667560338974, "kl": 0.0012414984079441639, "entropy": 0.5193301916122437, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 475.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.24065224304795266, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0003, "total_loss": 0.04130323082208633, "policy_loss": -0.0007858757358917501, "vf_loss": 0.05173380859196186, "vf_explained_var": 0.3959504783153534, "kl": 0.0014884680826071418, "entropy": 0.964470386505127, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 475.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09178511649370194, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0003, "total_loss": 0.03360712341964245, "policy_loss": -0.000336934245831344, "vf_loss": 0.04055726267397404, "vf_explained_var": 0.37901833057403567, "kl": 0.0006385556240275037, "entropy": 0.6613205015659332, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 475.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3530277296900749, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0003, "total_loss": 0.009647007659077644, "policy_loss": -0.0028105983838031534, "vf_loss": 0.02524174489080906, "vf_explained_var": 0.009916961193084717, "kl": 0.003134139529811364, "entropy": 1.2784140467643739, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 475.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.01, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.01, "agent_1": 0.01, "agent_2": -0.01, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -0.5, -1.0, -0.5, -1.5, -0.5, -1.5, -2.0, 0.5, 0.5, -1.5, 0.5, -1.0, -0.5, -0.5, -2.0, -3.0, -0.5, -1.0, -1.5, -0.5, -0.5, -1.5, 0.5, -3.0, -2.0, -2.0, -0.5, -0.5, -2.0, -2.0, 0.5, -1.5, -2.0, 0.5, -0.5, -0.5, -0.5, -0.5, -2.0, -0.5, 0.5, -2.0, -2.0, -0.5, -1.5, -3.0, 0.5, 0.5, -3.0, 0.5, -2.0, -0.5, 0.5, -0.5, -1.0, -2.0, 0.5, -0.5, -0.5, 0.5, -1.0, -2.0, -3.5, -0.5, -2.0, 0.5, -1.0, -2.0, -0.5, -3.0, -2.0, -1.0, 0.5, -1.5, 0.5, -0.5, -1.5, 0.5, -2.0, 0.5, -0.5, -1.5, -0.5, -2.0, -0.5, -3.0, -1.5, -0.5, -1.5, -1.5, -2.0, -2.0, -1.5, -0.5, -1.0, -1.5, -2.0, -0.5, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5], "policy_agent_1_reward": [0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5], "policy_agent_2_reward": [0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.78470101841135, "mean_inference_ms": 20.735581744819232, "mean_action_processing_ms": 2.981821191321142, "mean_env_wait_ms": 19.172803480579265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0349196195602417, "StateBufferConnector_ms": 0.020092368125915527, "ViewRequirementAgentConnector_ms": 0.19096022844314575}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.01, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 529.8306913195668, "num_env_steps_trained_throughput_per_sec": 529.8306913195668, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 7472.445, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7472.445, "sample_time_ms": 6504.401, "learn_time_ms": 929.953, "learn_throughput": 4301.291, "synch_weights_time_ms": 37.274}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "85d7a_00000", "date": "2024-09-11_18-18-46", "timestamp": 1726071526, "time_this_iter_s": 7.574302434921265, "time_total_s": 371.4442994594574, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0F490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 371.4442994594574, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 69.61, "ram_util_percent": 92.52, "gpu_util_percent0": 0.16299999999999998, "vram_util_percent0": 0.10611572265625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11720997095108032, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0003, "total_loss": 0.02489258497953415, "policy_loss": -0.001350601829471998, "vf_loss": 0.032982119172811505, "vf_explained_var": 0.3165955662727356, "kl": 0.001129544917785097, "entropy": 0.6738930463790893, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 485.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13908499032258986, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0003, "total_loss": 0.023425067588686944, "policy_loss": -0.0015416288248161435, "vf_loss": 0.0340944442898035, "vf_explained_var": 0.5262490272521972, "kl": 0.0011947194140020656, "entropy": 0.9127748131752014, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 485.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2389146663248539, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0003, "total_loss": 0.020157619006931783, "policy_loss": -0.0011045665217579881, "vf_loss": 0.027814292721450327, "vf_explained_var": 0.5248617231845856, "kl": 0.001102050448622549, "entropy": 0.6552108585834503, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 485.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18953026458621025, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0003, "total_loss": -0.0009331996312539559, "policy_loss": -0.000525890477683788, "vf_loss": 0.012206762097775936, "vf_explained_var": 0.02808529734611511, "kl": 0.0008384842163650319, "entropy": 1.2614071369171143, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 485.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.05, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.06, "agent_1": 0.05, "agent_2": -0.04, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5, -2.0, 0.5, -0.5, -0.5, -0.5, -0.5, -2.0, -0.5, 0.5, -2.0, -2.0, -0.5, -1.5, -3.0, 0.5, 0.5, -3.0, 0.5, -2.0, -0.5, 0.5, -0.5, -1.0, -2.0, 0.5, -0.5, -0.5, 0.5, -1.0, -2.0, -3.5, -0.5, -2.0, 0.5, -1.0, -2.0, -0.5, -3.0, -2.0, -1.0, 0.5, -1.5, 0.5, -0.5, -1.5, 0.5, -2.0, 0.5, -0.5, -1.5, -0.5, -2.0, -0.5, -3.0, -1.5, -0.5, -1.5, -1.5, -2.0, -2.0, -1.5, -0.5, -1.0, -1.5, -2.0, -0.5, -1.0, -3.5, -2.0, -2.5, 0.5, 0.5, -0.5, -0.5, -2.0, -3.0, -2.5, -2.0, -2.5, -2.0, -1.5, 0.5, -0.5, -0.5, -0.5, -2.0, 0.5, -2.0, -0.5, 0.5, -0.5, -1.5, 0.5, -0.5, -2.0, -3.0, 0.5, 0.5, -1.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5], "policy_agent_1_reward": [-0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5], "policy_agent_2_reward": [0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.783076322522968, "mean_inference_ms": 20.72931362802058, "mean_action_processing_ms": 2.9808656267148694, "mean_env_wait_ms": 19.17502874895261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03393357992172241, "StateBufferConnector_ms": 0.020957767963409424, "ViewRequirementAgentConnector_ms": 0.20722007751464844}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.05, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 524.6354070085785, "num_env_steps_trained_throughput_per_sec": 524.6354070085785, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 7468.092, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7468.092, "sample_time_ms": 6497.621, "learn_time_ms": 931.775, "learn_throughput": 4292.884, "synch_weights_time_ms": 37.884}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "85d7a_00000", "date": "2024-09-11_18-18-54", "timestamp": 1726071534, "time_this_iter_s": 7.6489715576171875, "time_total_s": 379.0932710170746, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC17E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 379.0932710170746, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 75.51111111111112, "ram_util_percent": 92.53333333333335, "gpu_util_percent0": 0.1088888888888889, "vram_util_percent0": 0.1050075954861111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15509090647101403, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0003, "total_loss": 0.02342464607208967, "policy_loss": -0.0015119244155357592, "vf_loss": 0.03023039996623993, "vf_explained_var": 0.32439987659454345, "kl": 0.0011137801309814676, "entropy": 0.5293830394744873, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.21273492500185967, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0003, "total_loss": 0.017487275414168835, "policy_loss": -0.00031560063539757264, "vf_loss": 0.027226512692868708, "vf_explained_var": 0.5239070057868958, "kl": 0.0007702627441176446, "entropy": 0.9423634290695191, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.14389732331037522, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0003, "total_loss": 0.015394993312656879, "policy_loss": -0.0015507126785905712, "vf_loss": 0.023757262527942656, "vf_explained_var": 0.4511509597301483, "kl": 0.001264620222900703, "entropy": 0.6811554610729218, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13720106333494186, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0003, "total_loss": 0.0007211540442767728, "policy_loss": -8.795905432634754e-05, "vf_loss": 0.013566999789327383, "vf_explained_var": 0.004647976160049439, "kl": 0.000576399230521929, "entropy": 1.2757886886596679, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -1.02, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.08, "agent_1": 0.09, "agent_2": -0.03, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -2.0, 0.5, -1.0, -2.0, -0.5, -3.0, -2.0, -1.0, 0.5, -1.5, 0.5, -0.5, -1.5, 0.5, -2.0, 0.5, -0.5, -1.5, -0.5, -2.0, -0.5, -3.0, -1.5, -0.5, -1.5, -1.5, -2.0, -2.0, -1.5, -0.5, -1.0, -1.5, -2.0, -0.5, -1.0, -3.5, -2.0, -2.5, 0.5, 0.5, -0.5, -0.5, -2.0, -3.0, -2.5, -2.0, -2.5, -2.0, -1.5, 0.5, -0.5, -0.5, -0.5, -2.0, 0.5, -2.0, -0.5, 0.5, -0.5, -1.5, 0.5, -0.5, -2.0, -3.0, 0.5, 0.5, -1.5, -1.5, -1.5, -1.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -3.0, -0.5, -0.5, -2.0, -2.0, -1.5, 0.5, 0.5, -2.0, -0.5, -3.0, -0.5, -0.5, -0.5, -0.5, -0.5, -3.0, -2.0, -1.0, 0.5, 0.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5], "policy_agent_1_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_2_reward": [0.5, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.76976971347763, "mean_inference_ms": 20.71215173769443, "mean_action_processing_ms": 2.9809484215702913, "mean_env_wait_ms": 19.16930803075888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03565174341201782, "StateBufferConnector_ms": 0.019328713417053223, "ViewRequirementAgentConnector_ms": 0.19943034648895264}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -1.02, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 580.3401336754104, "num_env_steps_trained_throughput_per_sec": 580.3401336754104, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 7439.275, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7439.275, "sample_time_ms": 6475.284, "learn_time_ms": 925.086, "learn_throughput": 4323.922, "synch_weights_time_ms": 37.991}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "85d7a_00000", "date": "2024-09-11_18-19-01", "timestamp": 1726071541, "time_this_iter_s": 6.922458648681641, "time_total_s": 386.0157296657562, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0E950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 386.0157296657562, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 65.28888888888888, "ram_util_percent": 92.61111111111111, "gpu_util_percent0": 0.060000000000000005, "vram_util_percent0": 0.1062961154513889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17871128618717194, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0003, "total_loss": 0.019380662590265274, "policy_loss": -0.0006333767107207678, "vf_loss": 0.02408379428088665, "vf_explained_var": 0.30787125825881956, "kl": 0.0002564863223597058, "entropy": 0.4069754868745804, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 505.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10875526815652847, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0003, "total_loss": 0.017219135724008083, "policy_loss": -0.0007534212869359181, "vf_loss": 0.02723416667431593, "vf_explained_var": 0.4679879367351532, "kl": 0.0002617922520585125, "entropy": 0.9261610031127929, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 505.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15921632945537567, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0003, "total_loss": 0.02659782636910677, "policy_loss": -0.0003559850680176169, "vf_loss": 0.033943013101816175, "vf_explained_var": 0.3452086567878723, "kl": 0.0005298150197631912, "entropy": 0.6989201068878174, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 505.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1185636579990387, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0003, "total_loss": 0.0006585822105989791, "policy_loss": -0.0013512211844044942, "vf_loss": 0.014734105300158262, "vf_explained_var": 0.019708150625228883, "kl": 0.0010507774060897646, "entropy": 1.2724302649497985, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 505.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -0.98, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.03, "agent_1": 0.045, "agent_2": 0.005, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5, -2.0, -0.5, -1.0, -3.5, -2.0, -2.5, 0.5, 0.5, -0.5, -0.5, -2.0, -3.0, -2.5, -2.0, -2.5, -2.0, -1.5, 0.5, -0.5, -0.5, -0.5, -2.0, 0.5, -2.0, -0.5, 0.5, -0.5, -1.5, 0.5, -0.5, -2.0, -3.0, 0.5, 0.5, -1.5, -1.5, -1.5, -1.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -3.0, -0.5, -0.5, -2.0, -2.0, -1.5, 0.5, 0.5, -2.0, -0.5, -3.0, -0.5, -0.5, -0.5, -0.5, -0.5, -3.0, -2.0, -1.0, 0.5, 0.5, -0.5, -0.5, -1.5, -0.5, -1.5, -0.5, 0.5, -0.5, -2.0, -0.5, -1.5, -1.0, -3.0, 0.5, -2.0, -1.0, -2.0, 0.5, -2.0, 0.5, -0.5, -0.5, 0.5, -2.0, -3.5, -0.5, -3.0, -3.5, 0.5, 0.5, -0.5, -1.0, 0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_1_reward": [-0.5, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5], "policy_agent_2_reward": [0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.769340320032809, "mean_inference_ms": 20.686815486772726, "mean_action_processing_ms": 2.975769299295836, "mean_env_wait_ms": 19.14155668200841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0348210334777832, "StateBufferConnector_ms": 0.014055073261260986, "ViewRequirementAgentConnector_ms": 0.19848334789276123}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -0.98, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.108205353205, "num_env_steps_trained_throughput_per_sec": 550.108205353205, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 7413.602, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7413.602, "sample_time_ms": 6450.837, "learn_time_ms": 923.479, "learn_throughput": 4331.446, "synch_weights_time_ms": 38.372}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "85d7a_00000", "date": "2024-09-11_18-19-08", "timestamp": 1726071548, "time_this_iter_s": 7.297540664672852, "time_total_s": 393.3132703304291, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0DA20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 393.3132703304291, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 63.19999999999999, "ram_util_percent": 92.17999999999998, "gpu_util_percent0": 0.05800000000000001, "vram_util_percent0": 0.1063232421875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11482401788234711, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0003, "total_loss": 0.028443891555070877, "policy_loss": -0.0020892060448659323, "vf_loss": 0.03474067226052284, "vf_explained_var": 0.3149239122867584, "kl": 0.0007939488072679524, "entropy": 0.4207573652267456, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 515.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09832081869244576, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0003, "total_loss": 0.031179941445589065, "policy_loss": -0.0016719827501219698, "vf_loss": 0.04205488860607147, "vf_explained_var": 0.37403934001922606, "kl": 0.0009183721623230668, "entropy": 0.9202963650226593, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 515.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.20886694639921188, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0003, "total_loss": 0.04159062169492245, "policy_loss": -0.0002441577419631358, "vf_loss": 0.048523548245429995, "vf_explained_var": 0.3124677538871765, "kl": 0.0008002489717000572, "entropy": 0.6688769459724426, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 515.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.31035867631435393, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0003, "total_loss": 0.010756495874375105, "policy_loss": -0.0016900497541428195, "vf_loss": 0.02498946860432625, "vf_explained_var": 0.006962615251541138, "kl": 0.0031461857797694393, "entropy": 1.2542922019958496, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 515.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -0.785, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.09, "agent_1": -0.02, "agent_2": 0.145, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.5, -0.5, -0.5, -1.5, -0.5, -1.5, -0.5, 0.5, -0.5, -2.0, -0.5, -1.5, -1.0, -3.0, 0.5, -2.0, -1.0, -2.0, 0.5, -2.0, 0.5, -0.5, -0.5, 0.5, -2.0, -3.5, -0.5, -3.0, -3.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -1.5, -2.0, -1.0, -3.0, -0.5, -1.5, -0.5, -1.0, 0.5, -0.5, -0.5, -1.5, 0.5, -2.5, -2.5, -1.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -3.0, 0.5, 0.5, -1.5, -0.5, 0.5, -2.0, 0.5, -0.5, -0.5, -1.5, -2.0, -1.0, 0.5, -2.0, -0.5, -2.0, -0.5, -0.5, -2.0, -1.5, 0.5, -2.0, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -2.0, -1.5, -0.5, 0.5, -1.5, -0.5, 0.5, -0.5, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5], "policy_agent_1_reward": [0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5], "policy_agent_2_reward": [-1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.743844383473428, "mean_inference_ms": 20.628780933969566, "mean_action_processing_ms": 2.9696173240673653, "mean_env_wait_ms": 19.08461679309564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03764587640762329, "StateBufferConnector_ms": 0.013000965118408203, "ViewRequirementAgentConnector_ms": 0.1808537244796753}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -0.785, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 578.188662354644, "num_env_steps_trained_throughput_per_sec": 578.188662354644, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 7393.277, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7393.277, "sample_time_ms": 6432.68, "learn_time_ms": 921.852, "learn_throughput": 4339.094, "synch_weights_time_ms": 37.933}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "85d7a_00000", "date": "2024-09-11_18-19-15", "timestamp": 1726071555, "time_this_iter_s": 6.952960252761841, "time_total_s": 400.2662305831909, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0F520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 400.2662305831909, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 64.65555555555555, "ram_util_percent": 91.93333333333334, "gpu_util_percent0": 0.061111111111111116, "vram_util_percent0": 0.10624186197916667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.24891792088747025, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0003, "total_loss": 0.0174016147851944, "policy_loss": -0.0005307787363562966, "vf_loss": 0.022509237565100194, "vf_explained_var": 0.4382480800151825, "kl": 0.0006723931423039175, "entropy": 0.45768446028232573, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 525.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13326796889305115, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0003, "total_loss": 0.022092280723154546, "policy_loss": -0.0011917870241632046, "vf_loss": 0.031803859770298, "vf_explained_var": 0.527751111984253, "kl": 0.0005924055353830227, "entropy": 0.851979261636734, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 525.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1443315327167511, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0003, "total_loss": 0.02405490316450596, "policy_loss": -0.0014271501579514734, "vf_loss": 0.031803546473383904, "vf_explained_var": 0.5374556541442871, "kl": 0.0011984497058733722, "entropy": 0.6321493566036225, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 525.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1797887586057186, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0003, "total_loss": -0.0009764455058757449, "policy_loss": -0.0006425286496323679, "vf_loss": 0.012222756911069155, "vf_explained_var": 0.03334641456604004, "kl": 0.0007639084258698858, "entropy": 1.2556673765182496, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 525.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -0.76, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.08, "agent_1": -0.025, "agent_2": 0.185, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -0.5, -1.0, 0.5, 0.5, -0.5, -1.5, -2.0, -1.0, -3.0, -0.5, -1.5, -0.5, -1.0, 0.5, -0.5, -0.5, -1.5, 0.5, -2.5, -2.5, -1.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -3.0, 0.5, 0.5, -1.5, -0.5, 0.5, -2.0, 0.5, -0.5, -0.5, -1.5, -2.0, -1.0, 0.5, -2.0, -0.5, -2.0, -0.5, -0.5, -2.0, -1.5, 0.5, -2.0, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -2.0, -1.5, -0.5, 0.5, -1.5, -0.5, 0.5, -0.5, -2.0, 0.5, 0.5, -0.5, -3.0, -0.5, -1.5, -1.5, -2.0, -0.5, -0.5, -0.5, -1.5, 0.5, -0.5, -1.5, -0.5, -2.0, 0.5, -0.5, -1.5, 0.5, 0.5, -3.0, 0.5, -2.0, -2.0, -1.5, -0.5, -3.0, -1.5, -0.5, 0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5], "policy_agent_1_reward": [0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5], "policy_agent_2_reward": [0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.731906371095455, "mean_inference_ms": 20.604286639458063, "mean_action_processing_ms": 2.966362360645709, "mean_env_wait_ms": 19.0622411185322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03353852033615112, "StateBufferConnector_ms": 0.018773376941680908, "ViewRequirementAgentConnector_ms": 0.18306535482406616}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -0.76, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 563.4639018813649, "num_env_steps_trained_throughput_per_sec": 563.4639018813649, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 7369.032, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7369.032, "sample_time_ms": 6417.919, "learn_time_ms": 912.405, "learn_throughput": 4384.016, "synch_weights_time_ms": 37.894}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "85d7a_00000", "date": "2024-09-11_18-19-22", "timestamp": 1726071562, "time_this_iter_s": 7.131734609603882, "time_total_s": 407.3979651927948, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0E9E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 407.3979651927948, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 65.55555555555556, "ram_util_percent": 91.84444444444443, "gpu_util_percent0": 0.060000000000000005, "vram_util_percent0": 0.1062961154513889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18882564157247544, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0003, "total_loss": 0.012583332229405641, "policy_loss": -0.0008393599257033202, "vf_loss": 0.017015520110726358, "vf_explained_var": 0.5094890475273133, "kl": 0.00038547274180018577, "entropy": 0.35928278863430024, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 535.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12033712491393089, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0003, "total_loss": 0.026153661124408246, "policy_loss": -0.0006182433848152868, "vf_loss": 0.035413925722241404, "vf_explained_var": 0.4572620093822479, "kl": 0.0005792910491436487, "entropy": 0.8642022013664246, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 535.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18017569854855536, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0003, "total_loss": 0.01890019290149212, "policy_loss": -0.001028867037348391, "vf_loss": 0.0263170575723052, "vf_explained_var": 0.43142434358596804, "kl": 0.0014326845554023747, "entropy": 0.6387998819351196, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 535.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19037903994321823, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0003, "total_loss": -0.00041230736242141574, "policy_loss": -0.0016123236244311556, "vf_loss": 0.01364414943382144, "vf_explained_var": -0.00027945637702941895, "kl": 0.001433639648348617, "entropy": 1.2444133400917052, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 535.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -0.8, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.025, "agent_1": 0.005, "agent_2": 0.22, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.5, -0.5, 0.5, -2.0, 0.5, -0.5, -0.5, -1.5, -2.0, -1.0, 0.5, -2.0, -0.5, -2.0, -0.5, -0.5, -2.0, -1.5, 0.5, -2.0, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -2.0, -1.5, -0.5, 0.5, -1.5, -0.5, 0.5, -0.5, -2.0, 0.5, 0.5, -0.5, -3.0, -0.5, -1.5, -1.5, -2.0, -0.5, -0.5, -0.5, -1.5, 0.5, -0.5, -1.5, -0.5, -2.0, 0.5, -0.5, -1.5, 0.5, 0.5, -3.0, 0.5, -2.0, -2.0, -1.5, -0.5, -3.0, -1.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -1.5, -1.0, -3.0, -2.0, -2.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -2.0, 0.5, -2.0, -0.5, -2.0, 0.5, -1.5, -2.0, -2.0, -1.5, -1.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5], "policy_agent_1_reward": [0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_2_reward": [0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.715232602682303, "mean_inference_ms": 20.580982622049447, "mean_action_processing_ms": 2.9650829481873755, "mean_env_wait_ms": 19.047943574682204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027320802211761475, "StateBufferConnector_ms": 0.016571879386901855, "ViewRequirementAgentConnector_ms": 0.18000829219818115}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -0.8, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 575.5131286791957, "num_env_steps_trained_throughput_per_sec": 575.5131286791957, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 7220.455, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7220.455, "sample_time_ms": 6282.715, "learn_time_ms": 899.329, "learn_throughput": 4447.761, "synch_weights_time_ms": 37.597}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "85d7a_00000", "date": "2024-09-11_18-19-29", "timestamp": 1726071569, "time_this_iter_s": 6.980153560638428, "time_total_s": 414.3781187534332, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0F250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 414.3781187534332, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 64.26666666666668, "ram_util_percent": 91.83333333333331, "gpu_util_percent0": 0.061111111111111116, "vram_util_percent0": 0.10649956597222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11329688653349876, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0003, "total_loss": 0.010662498977035284, "policy_loss": -6.95191618433455e-05, "vf_loss": 0.013627146370708942, "vf_explained_var": 0.5249793052673339, "kl": 0.00010119800017491798, "entropy": 0.2895128756761551, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 545.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12219419702887535, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0003, "total_loss": 0.01743692010641098, "policy_loss": -0.0015187036666247876, "vf_loss": 0.027478283271193504, "vf_explained_var": 0.4442588448524475, "kl": 0.000861360242288356, "entropy": 0.8522660672664643, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 545.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12726953253149986, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0003, "total_loss": 0.023140806704759598, "policy_loss": -0.0006521213752421317, "vf_loss": 0.030367060191929342, "vf_explained_var": 0.3045751929283142, "kl": 0.0004209213813737733, "entropy": 0.6574132680892945, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 545.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.0921851247549057, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0003, "total_loss": 0.0017865329282358289, "policy_loss": -0.0003751730990188662, "vf_loss": 0.014518805220723153, "vf_explained_var": 0.0197864830493927, "kl": 0.002375570711592445, "entropy": 1.2357098937034607, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 545.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -0.78, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": -0.025, "agent_1": -0.02, "agent_2": 0.265, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, 0.5, -0.5, -2.0, 0.5, 0.5, -0.5, -3.0, -0.5, -1.5, -1.5, -2.0, -0.5, -0.5, -0.5, -1.5, 0.5, -0.5, -1.5, -0.5, -2.0, 0.5, -0.5, -1.5, 0.5, 0.5, -3.0, 0.5, -2.0, -2.0, -1.5, -0.5, -3.0, -1.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -1.5, -1.0, -3.0, -2.0, -2.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -2.0, 0.5, -2.0, -0.5, -2.0, 0.5, -1.5, -2.0, -2.0, -1.5, -1.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -2.0, -1.5, -0.5, 0.5, 0.5, -2.0, 0.5, -2.0, -2.0, -2.0, -3.0, -0.5, 0.5, -0.5, -1.0, -2.0, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_1_reward": [-0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_2_reward": [0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.708789649178964, "mean_inference_ms": 20.5583909140181, "mean_action_processing_ms": 2.959765809539426, "mean_env_wait_ms": 19.01668677278375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02232229709625244, "StateBufferConnector_ms": 0.015098094940185547, "ViewRequirementAgentConnector_ms": 0.18468326330184937}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -0.78, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 536.7367192324044, "num_env_steps_trained_throughput_per_sec": 536.7367192324044, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 7230.557, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7230.557, "sample_time_ms": 6293.922, "learn_time_ms": 897.684, "learn_throughput": 4455.912, "synch_weights_time_ms": 38.038}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "85d7a_00000", "date": "2024-09-11_18-19-37", "timestamp": 1726071577, "time_this_iter_s": 7.480788230895996, "time_total_s": 421.8589069843292, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67EC1900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 421.8589069843292, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 74.47777777777777, "ram_util_percent": 92.0888888888889, "gpu_util_percent0": 0.09444444444444446, "vram_util_percent0": 0.10411241319444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13768838346004486, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0003, "total_loss": 0.019063957408070563, "policy_loss": -0.0003898353368640528, "vf_loss": 0.022425795905292034, "vf_explained_var": 0.39515382051467896, "kl": 0.000217257500935375, "entropy": 0.2972003608942032, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 555.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1496635213494301, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0003, "total_loss": 0.035813425108790396, "policy_loss": -0.0014698687871714355, "vf_loss": 0.04548907876014709, "vf_explained_var": 0.3262461245059967, "kl": 0.0010613334887239034, "entropy": 0.8205783903598786, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 555.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12461991533637047, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0003, "total_loss": 0.03734125047922134, "policy_loss": -0.0003692893629704486, "vf_loss": 0.04426717348396778, "vf_explained_var": 0.2802260458469391, "kl": 0.00026348712453909683, "entropy": 0.6556632459163666, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 555.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3149508431553841, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0003, "total_loss": 0.010684135742485524, "policy_loss": -0.0017574943072759196, "vf_loss": 0.02469363696873188, "vf_explained_var": 0.010590171813964844, "kl": 0.001154062437490211, "entropy": 1.225200593471527, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 555.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -0.6, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.045, "agent_1": 0.045, "agent_2": 0.31, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -2.0, -1.5, -0.5, 0.5, 0.5, -2.0, 0.5, -2.0, -2.0, -2.0, -3.0, -0.5, 0.5, -0.5, -1.0, -2.0, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -1.5, -0.5, -1.5, 0.5, -0.5, -1.0, -0.5, -0.5, -3.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -3.5, -1.0, 0.5, -0.5, -0.5, -1.5, -2.0, 0.5, -0.5, -1.0, 0.5, -0.5, -2.0, -3.5, -0.5, 0.5, -0.5, -2.0, 0.5, 0.5, -0.5, 0.5, -1.5, -0.5, 0.5, -0.5, 0.5, -3.5, -0.5, -1.5, -2.0, 0.5, -0.5, 0.5, -2.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -2.0, 0.5, 0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5], "policy_agent_1_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5], "policy_agent_2_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.688427090714155, "mean_inference_ms": 20.5209435209942, "mean_action_processing_ms": 2.9547177288480135, "mean_env_wait_ms": 18.966867009050965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03382331132888794, "StateBufferConnector_ms": 0.013214051723480225, "ViewRequirementAgentConnector_ms": 0.17938107252120972}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -0.6, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 588.6563380685928, "num_env_steps_trained_throughput_per_sec": 588.6563380685928, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 7187.345, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7187.345, "sample_time_ms": 6264.742, "learn_time_ms": 883.68, "learn_throughput": 4526.525, "synch_weights_time_ms": 38.023}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "85d7a_00000", "date": "2024-09-11_18-19-44", "timestamp": 1726071584, "time_this_iter_s": 6.820762395858765, "time_total_s": 428.679669380188, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0E9E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 428.679669380188, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 63.79999999999999, "ram_util_percent": 92.11111111111111, "gpu_util_percent0": 0.061111111111111116, "vram_util_percent0": 0.10264756944444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10903477817773818, "cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0003, "total_loss": 0.019575460255146025, "policy_loss": -0.0002862875549908495, "vf_loss": 0.02443188279867172, "vf_explained_var": 0.4883347928524017, "kl": 0.00019960974204877858, "entropy": 0.4570136725902557, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 565.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1951944798231125, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0003, "total_loss": 0.020563472993671894, "policy_loss": -0.0008599126414992498, "vf_loss": 0.029248874820768832, "vf_explained_var": 0.5328371047973632, "kl": 0.0018001573725086929, "entropy": 0.7825488746166229, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 565.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10398156419396401, "cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0003, "total_loss": 0.02885642498731613, "policy_loss": -0.0008205535554225207, "vf_loss": 0.03587053492665291, "vf_explained_var": 0.3741882681846619, "kl": 0.0007792945518758643, "entropy": 0.6193555235862732, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 565.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19006406366825104, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0003, "total_loss": -0.0007269640773301944, "policy_loss": -0.00032788956182230324, "vf_loss": 0.011809802800416946, "vf_explained_var": 0.03946102261543274, "kl": 0.0009390796022671566, "entropy": 1.2208875179290772, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 565.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -0.695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.075, "agent_1": -0.03, "agent_2": 0.26, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -0.5, -0.5, -0.5, -1.5, -0.5, -1.5, 0.5, -0.5, -1.0, -0.5, -0.5, -3.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -3.5, -1.0, 0.5, -0.5, -0.5, -1.5, -2.0, 0.5, -0.5, -1.0, 0.5, -0.5, -2.0, -3.5, -0.5, 0.5, -0.5, -2.0, 0.5, 0.5, -0.5, 0.5, -1.5, -0.5, 0.5, -0.5, 0.5, -3.5, -0.5, -1.5, -2.0, 0.5, -0.5, 0.5, -2.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -2.0, 0.5, 0.5, 0.5, -1.5, -0.5, -1.0, 0.5, 0.5, -3.0, 0.5, -0.5, -3.0, -2.0, -1.0, 0.5, 0.5, -2.0, -2.5, 0.5, -0.5, -2.0, -0.5, -1.5, -0.5, 0.5, -0.5, 0.5, -2.5, -2.5, -1.5, -2.0, 0.5, -0.5, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5], "policy_agent_1_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -1.0], "policy_agent_2_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.67745340213444, "mean_inference_ms": 20.499174662040215, "mean_action_processing_ms": 2.9518251335612153, "mean_env_wait_ms": 18.945464356092792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034309446811676025, "StateBufferConnector_ms": 0.012431681156158447, "ViewRequirementAgentConnector_ms": 0.16831886768341064}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -0.695, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 564.7903706046976, "num_env_steps_trained_throughput_per_sec": 564.7903706046976, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 7163.501, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7163.501, "sample_time_ms": 6243.34, "learn_time_ms": 880.429, "learn_throughput": 4543.239, "synch_weights_time_ms": 38.731}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "85d7a_00000", "date": "2024-09-11_18-19-51", "timestamp": 1726071591, "time_this_iter_s": 7.105858087539673, "time_total_s": 435.78552746772766, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA68091240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 435.78552746772766, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 66.92222222222223, "ram_util_percent": 92.08888888888889, "gpu_util_percent0": 0.061111111111111116, "vram_util_percent0": 0.1025661892361111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.08232995532453061, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0003, "total_loss": 0.011547515448182822, "policy_loss": -0.0011581054945054348, "vf_loss": 0.016008221358060837, "vf_explained_var": 0.533250916004181, "kl": 0.00038051099450058244, "entropy": 0.3302599430084229, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 575.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.26744220927357676, "cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0003, "total_loss": 0.011823417525738478, "policy_loss": -1.4255442874855361e-05, "vf_loss": 0.0197434788569808, "vf_explained_var": 0.5273466885089875, "kl": 0.0007710400273936102, "entropy": 0.7905806064605713, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 575.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13277099132537842, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0003, "total_loss": 0.02016693092882633, "policy_loss": -0.0012918091168103274, "vf_loss": 0.027451980300247668, "vf_explained_var": 0.388458389043808, "kl": 0.0004906943482637871, "entropy": 0.5993238806724548, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 575.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12332161292433738, "cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0003, "total_loss": -0.00011208501091459766, "policy_loss": -0.0009143019262410235, "vf_loss": 0.01308173667639494, "vf_explained_var": 0.03640980720520019, "kl": 0.001089458378010022, "entropy": 1.227951979637146, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 575.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -0.62, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.085, "agent_1": 0.035, "agent_2": 0.26, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -0.5, -2.0, -3.5, -0.5, 0.5, -0.5, -2.0, 0.5, 0.5, -0.5, 0.5, -1.5, -0.5, 0.5, -0.5, 0.5, -3.5, -0.5, -1.5, -2.0, 0.5, -0.5, 0.5, -2.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -2.0, 0.5, 0.5, 0.5, -1.5, -0.5, -1.0, 0.5, 0.5, -3.0, 0.5, -0.5, -3.0, -2.0, -1.0, 0.5, 0.5, -2.0, -2.5, 0.5, -0.5, -2.0, -0.5, -1.5, -0.5, 0.5, -0.5, 0.5, -2.5, -2.5, -1.5, -2.0, 0.5, -0.5, -2.0, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -2.0, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -2.0, 0.5, -0.5, -0.5, 0.5, -1.5, -1.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -2.0, -1.0, -3.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5], "policy_agent_1_reward": [0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5], "policy_agent_2_reward": [0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.662485135305166, "mean_inference_ms": 20.476202174033705, "mean_action_processing_ms": 2.9507432418909145, "mean_env_wait_ms": 18.932299190286706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039491891860961914, "StateBufferConnector_ms": 0.008704304695129395, "ViewRequirementAgentConnector_ms": 0.17098623514175415}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -0.62, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 586.5280468808066, "num_env_steps_trained_throughput_per_sec": 586.5280468808066, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 7090.522, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7090.522, "sample_time_ms": 6172.526, "learn_time_ms": 878.268, "learn_throughput": 4554.42, "synch_weights_time_ms": 38.727}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "85d7a_00000", "date": "2024-09-11_18-19-58", "timestamp": 1726071598, "time_this_iter_s": 6.848603248596191, "time_total_s": 442.63413071632385, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0DA20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 442.63413071632385, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 64.54444444444444, "ram_util_percent": 92.1, "gpu_util_percent0": 0.06222222222222223, "vram_util_percent0": 0.10100640190972222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.07464375495910644, "cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0003, "total_loss": 0.010218719486147165, "policy_loss": -0.0005369830084873684, "vf_loss": 0.013889681734144687, "vf_explained_var": 0.5588238954544067, "kl": 0.00030249745550463557, "entropy": 0.31339805424213407, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15432757064700126, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0003, "total_loss": 0.010298299323767423, "policy_loss": -8.405752378166653e-05, "vf_loss": 0.018190937861800194, "vf_explained_var": 0.5585686802864075, "kl": 0.00018196483442807222, "entropy": 0.7808580219745636, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17927258536219598, "cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0003, "total_loss": 0.01388859050348401, "policy_loss": -0.0008305187761379785, "vf_loss": 0.020509663969278336, "vf_explained_var": 0.47767016291618347, "kl": 0.0002783814388749306, "entropy": 0.5790554761886597, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1203094556927681, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0003, "total_loss": 0.0010767962085083127, "policy_loss": -0.0013351817662623944, "vf_loss": 0.01460768012329936, "vf_explained_var": 0.021641349792480467, "kl": 0.001498899081161653, "entropy": 1.2195700526237487, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -0.495, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.19, "agent_1": 0.05, "agent_2": 0.265, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -2.0, 0.5, 0.5, 0.5, -1.5, -0.5, -1.0, 0.5, 0.5, -3.0, 0.5, -0.5, -3.0, -2.0, -1.0, 0.5, 0.5, -2.0, -2.5, 0.5, -0.5, -2.0, -0.5, -1.5, -0.5, 0.5, -0.5, 0.5, -2.5, -2.5, -1.5, -2.0, 0.5, -0.5, -2.0, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -2.0, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -2.0, 0.5, -0.5, -0.5, 0.5, -1.5, -1.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -2.0, -1.0, -3.0, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -2.5, -0.5, -0.5, 0.5, 0.5, -3.0, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_1_reward": [0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5], "policy_agent_2_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.65838338986685, "mean_inference_ms": 20.45548036959228, "mean_action_processing_ms": 2.9457674771348685, "mean_env_wait_ms": 18.906758876188167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03724747896194458, "StateBufferConnector_ms": 0.010518670082092285, "ViewRequirementAgentConnector_ms": 0.19027340412139893}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -0.495, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 520.9651378294785, "num_env_steps_trained_throughput_per_sec": 520.9651378294785, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 7095.893, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7095.893, "sample_time_ms": 6172.724, "learn_time_ms": 884.044, "learn_throughput": 4524.662, "synch_weights_time_ms": 38.225}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "85d7a_00000", "date": "2024-09-11_18-20-06", "timestamp": 1726071606, "time_this_iter_s": 7.70764422416687, "time_total_s": 450.3417749404907, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0F010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 450.3417749404907, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 71.0, "ram_util_percent": 92.35, "gpu_util_percent0": 0.123, "vram_util_percent0": 0.1004150390625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1272188976407051, "cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0003, "total_loss": 0.014838526584208011, "policy_loss": -0.0010814313076480176, "vf_loss": 0.019103209115564825, "vf_explained_var": 0.5440452098846436, "kl": 0.0006370024545958586, "entropy": 0.31832515001296996, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 595.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40016906037926675, "cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0003, "total_loss": 0.04314391613006592, "policy_loss": -0.0014568301721737953, "vf_loss": 0.05238655172288418, "vf_explained_var": 0.34873843789100645, "kl": 0.0009484697591688018, "entropy": 0.778580266237259, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 595.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15760912448167802, "cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0003, "total_loss": 0.03365911804139614, "policy_loss": -0.0010811049294716212, "vf_loss": 0.040554947778582574, "vf_explained_var": 0.3298746168613434, "kl": 0.0010535659654124173, "entropy": 0.5814725875854492, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 595.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30258590206503866, "cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0003, "total_loss": 0.012006234843283892, "policy_loss": -0.0010724450645284377, "vf_loss": 0.025239165872335434, "vf_explained_var": 0.007580870389938354, "kl": 0.000676901772749261, "entropy": 1.2160487174987793, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 595.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -0.485, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.1, "agent_1": 0.15, "agent_2": 0.265, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, -2.0, -1.0, -3.0, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -2.5, -0.5, -0.5, 0.5, 0.5, -3.0, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, -3.0, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -1.5, -2.0, -2.0, -1.0, -1.0, 0.5, 0.5, -1.5, 0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -3.5, -0.5, 0.5, -0.5, -0.5, -2.0, 0.5, -0.5, -0.5, -0.5, -1.5, -0.5, 0.5, -2.0, -0.5, 0.5, -0.5, -0.5, -2.0, -1.5, -2.0, -0.5, 0.5, 0.5, -1.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_1_reward": [0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_2_reward": [0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.664665852057114, "mean_inference_ms": 20.445816236935478, "mean_action_processing_ms": 2.943946788689623, "mean_env_wait_ms": 18.891830400300925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04074263572692871, "StateBufferConnector_ms": 0.016062498092651367, "ViewRequirementAgentConnector_ms": 0.2097347378730774}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -0.485, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 517.1263973244533, "num_env_steps_trained_throughput_per_sec": 517.1263973244533, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 7180.148, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7180.148, "sample_time_ms": 6245.147, "learn_time_ms": 894.599, "learn_throughput": 4471.277, "synch_weights_time_ms": 39.401}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "85d7a_00000", "date": "2024-09-11_18-20-13", "timestamp": 1726071613, "time_this_iter_s": 7.7700514793396, "time_total_s": 458.1118264198303, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0DCF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 458.1118264198303, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 72.59, "ram_util_percent": 92.35999999999999, "gpu_util_percent0": 0.10400000000000001, "vram_util_percent0": 0.09986572265625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16579151898622513, "cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0003, "total_loss": 0.021171900257468224, "policy_loss": -0.0013101810179250606, "vf_loss": 0.027080651372671127, "vf_explained_var": 0.4662125468254089, "kl": 0.00037012678221799434, "entropy": 0.45985693037509917, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 605.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.23112960755825043, "cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0003, "total_loss": 0.017622671090066433, "policy_loss": -0.0023222420160891486, "vf_loss": 0.026937852241098882, "vf_explained_var": 0.581182461977005, "kl": 0.0046218648842568655, "entropy": 0.6992938995361329, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 605.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.25130795165896413, "cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0003, "total_loss": 0.014194394741207362, "policy_loss": -0.0003208424559602463, "vf_loss": 0.019850364699959756, "vf_explained_var": 0.5032619118690491, "kl": 0.0008607993623627408, "entropy": 0.5335127294063569, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 605.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.20811488032341002, "cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0003, "total_loss": -0.0018299040479178076, "policy_loss": -0.0019752739996420133, "vf_loss": 0.012536539323627948, "vf_explained_var": 0.0013077139854431152, "kl": 0.0023969798796315443, "entropy": 1.2391170263290405, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 605.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -0.535, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.065, "agent_1": 0.195, "agent_2": 0.205, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, -3.0, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -1.5, -2.0, -2.0, -1.0, -1.0, 0.5, 0.5, -1.5, 0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -3.5, -0.5, 0.5, -0.5, -0.5, -2.0, 0.5, -0.5, -0.5, -0.5, -1.5, -0.5, 0.5, -2.0, -0.5, 0.5, -0.5, -0.5, -2.0, -1.5, -2.0, -0.5, 0.5, 0.5, -1.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -2.0, -0.5, 0.5, 0.5, 0.5, -2.0, -2.5, -0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -2.5, -1.0, 0.5, -1.5, 0.5, -1.5, 0.5, -2.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5], "policy_agent_1_reward": [0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_2_reward": [-1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.665726047345029, "mean_inference_ms": 20.440182946788244, "mean_action_processing_ms": 2.9561397004406036, "mean_env_wait_ms": 18.886204311665168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04524785280227661, "StateBufferConnector_ms": 0.016434431076049805, "ViewRequirementAgentConnector_ms": 0.19202762842178345}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -0.535, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 542.0755134392576, "num_env_steps_trained_throughput_per_sec": 542.0755134392576, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 7191.022, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7190.922, "sample_time_ms": 6255.305, "learn_time_ms": 895.238, "learn_throughput": 4468.085, "synch_weights_time_ms": 39.38}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "85d7a_00000", "date": "2024-09-11_18-20-21", "timestamp": 1726071621, "time_this_iter_s": 7.409967660903931, "time_total_s": 465.52179408073425, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0DC60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 465.52179408073425, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 69.60000000000001, "ram_util_percent": 92.44444444444444, "gpu_util_percent0": 0.07, "vram_util_percent0": 0.0989040798611111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12084590792655944, "cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 0.0003, "total_loss": 0.015184416901320219, "policy_loss": 0.00021542704007515567, "vf_loss": 0.018216849863529207, "vf_explained_var": 0.5459101319313049, "kl": 0.00023261564165295568, "entropy": 0.32478605806827543, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 615.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.21281380578875542, "cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0003, "total_loss": 0.016206034831702708, "policy_loss": -0.0012056599513016407, "vf_loss": 0.024154859967529772, "vf_explained_var": 0.5300518095493316, "kl": 0.0005594155758444685, "entropy": 0.6743163704872132, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 615.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.23012389093637467, "cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 0.0003, "total_loss": 0.027450867369771002, "policy_loss": -0.0007348961647949181, "vf_loss": 0.03349538743495941, "vf_explained_var": 0.37969218492507933, "kl": 0.00025545352982589973, "entropy": 0.5309626281261444, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 615.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15060582607984543, "cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0003, "total_loss": -2.4880443379515783e-05, "policy_loss": -0.0009357200542581268, "vf_loss": 0.013636541832238436, "vf_explained_var": -0.006624531745910644, "kl": 0.001364172008470632, "entropy": 1.2725702762603759, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 615.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -0.575, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.085, "agent_1": 0.12, "agent_2": 0.22, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, 0.5, 0.5, -0.5, -0.5, -3.5, -0.5, 0.5, -0.5, -0.5, -2.0, 0.5, -0.5, -0.5, -0.5, -1.5, -0.5, 0.5, -2.0, -0.5, 0.5, -0.5, -0.5, -2.0, -1.5, -2.0, -0.5, 0.5, 0.5, -1.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -2.0, -0.5, 0.5, 0.5, 0.5, -2.0, -2.5, -0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -2.5, -1.0, 0.5, -1.5, 0.5, -1.5, 0.5, -2.0, -2.0, -0.5, -2.0, 0.5, -2.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -1.5, -1.0, -3.5, -0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -2.0, 0.5, -2.0, -1.0, -0.5, -1.0, 0.5, -3.0, -0.5, -0.5, -0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5], "policy_agent_1_reward": [0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5], "policy_agent_2_reward": [0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.655631183167436, "mean_inference_ms": 20.422234294631156, "mean_action_processing_ms": 2.9680256605583213, "mean_env_wait_ms": 18.879235220956648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05029815435409546, "StateBufferConnector_ms": 0.012090206146240234, "ViewRequirementAgentConnector_ms": 0.18393057584762573}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -0.575, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 574.8527286496374, "num_env_steps_trained_throughput_per_sec": 574.8527286496374, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 7195.037, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7194.937, "sample_time_ms": 6258.3, "learn_time_ms": 896.047, "learn_throughput": 4464.053, "synch_weights_time_ms": 39.49}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "85d7a_00000", "date": "2024-09-11_18-20-28", "timestamp": 1726071628, "time_this_iter_s": 6.9859299659729, "time_total_s": 472.50772404670715, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA68091A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 472.50772404670715, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 64.57777777777777, "ram_util_percent": 92.3, "gpu_util_percent0": 0.05888888888888889, "vram_util_percent0": 0.0980495876736111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11707916185259819, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0003, "total_loss": 0.008460317458957433, "policy_loss": -0.0013172917173505994, "vf_loss": 0.012756577413529157, "vf_explained_var": 0.5373478710651398, "kl": 0.00024438474486032646, "entropy": 0.29789669513702394, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 625.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12680679038167, "cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 0.0003, "total_loss": 0.013597599882632493, "policy_loss": -0.0009731826306961011, "vf_loss": 0.02081381846219301, "vf_explained_var": 0.5341671526432037, "kl": 0.001533567250771739, "entropy": 0.6243033111095428, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 625.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.16083093956112862, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0003, "total_loss": 0.015978451911360027, "policy_loss": -0.000546963618216978, "vf_loss": 0.021637803688645364, "vf_explained_var": 0.4314281463623047, "kl": 0.0002697847263334552, "entropy": 0.5112386882305145, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 625.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.07612418346107006, "cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 0.0003, "total_loss": 0.0018202487379312515, "policy_loss": -1.9211970084143104e-05, "vf_loss": 0.01489373780786991, "vf_explained_var": 0.006946760416030884, "kl": 0.0010759996479464463, "entropy": 1.3054277539253234, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 625.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -0.475, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -1.0, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.145, "agent_1": 0.145, "agent_2": 0.235, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -2.0, -0.5, 0.5, 0.5, 0.5, -2.0, -2.5, -0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, -2.5, -1.0, 0.5, -1.5, 0.5, -1.5, 0.5, -2.0, -2.0, -0.5, -2.0, 0.5, -2.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -1.5, -1.0, -3.5, -0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -2.0, 0.5, -2.0, -1.0, -0.5, -1.0, 0.5, -3.0, -0.5, -0.5, -0.5, -2.0, 0.5, -2.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -2.0, -0.5, 0.5, -0.5, -1.5, 0.5, 0.5, 0.5, -1.0, 0.5, -2.0, -2.0, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_1_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0], "policy_agent_2_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.650848073609636, "mean_inference_ms": 20.4028659643278, "mean_action_processing_ms": 2.9758436045431473, "mean_env_wait_ms": 18.849482432183247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04968661069869995, "StateBufferConnector_ms": 0.0121651291847229, "ViewRequirementAgentConnector_ms": 0.17150282859802246}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -0.475, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 549.6887747245366, "num_env_steps_trained_throughput_per_sec": 549.6887747245366, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 7212.827, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7212.727, "sample_time_ms": 6276.54, "learn_time_ms": 895.48, "learn_throughput": 4466.879, "synch_weights_time_ms": 39.707}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "85d7a_00000", "date": "2024-09-11_18-20-35", "timestamp": 1726071635, "time_this_iter_s": 7.308338165283203, "time_total_s": 479.81606221199036, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0DCF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 479.81606221199036, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 65.39999999999999, "ram_util_percent": 92.30999999999999, "gpu_util_percent0": 0.08499999999999999, "vram_util_percent0": 0.09888916015625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15951390340924262, "cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 0.0003, "total_loss": 0.02060196492820978, "policy_loss": -0.0009925824028869101, "vf_loss": 0.02505421470850706, "vf_explained_var": 0.4757657766342163, "kl": 0.0004567077699789479, "entropy": 0.3459666520357132, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 635.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19243022575974464, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0003, "total_loss": 0.020322304219007492, "policy_loss": -0.0005898210554732941, "vf_loss": 0.0270595483481884, "vf_explained_var": 0.43401983976364134, "kl": 0.0002652365292306058, "entropy": 0.6147421956062317, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 635.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17376314997673034, "cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 0.0003, "total_loss": 0.03007679749280214, "policy_loss": -0.002098060107527999, "vf_loss": 0.03688125908374786, "vf_explained_var": 0.3672464907169342, "kl": 0.0014348003855047865, "entropy": 0.47063995599746705, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 635.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3394631028175354, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0003, "total_loss": 0.009857566189020872, "policy_loss": -0.00223731701989891, "vf_loss": 0.02515710350126028, "vf_explained_var": 0.001948326826095581, "kl": 0.0017789001291021122, "entropy": 1.3062222361564637, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 635.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -0.35, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.23, "agent_1": 0.145, "agent_2": 0.275, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -0.5, -0.5, -0.5, -2.0, 0.5, -2.0, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -2.0, -0.5, 0.5, -0.5, -1.5, 0.5, 0.5, 0.5, -1.0, 0.5, -2.0, -2.0, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, 0.5, -2.0, 0.5, -2.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -3.5, -2.5, -1.0, -2.0, -1.0, 0.5, -2.0, -0.5, 0.5, 0.5, 0.5, -2.0, 0.5, -1.5, -0.5, -0.5, -1.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -2.0, -0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -2.0, -0.5, 0.5, 0.5, 0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [-0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_1_reward": [-0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5], "policy_agent_2_reward": [-1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.633926833080642, "mean_inference_ms": 20.378887178693223, "mean_action_processing_ms": 2.9732864779818247, "mean_env_wait_ms": 18.820856267726406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03526884317398071, "StateBufferConnector_ms": 0.010765790939331055, "ViewRequirementAgentConnector_ms": 0.17406338453292847}, "num_episodes": 64, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -0.35, "episodes_this_iter": 64}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 553.5795732592271, "num_env_steps_trained_throughput_per_sec": 553.5795732592271, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 7240.365, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7240.265, "sample_time_ms": 6306.742, "learn_time_ms": 892.703, "learn_throughput": 4480.775, "synch_weights_time_ms": 39.824}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "85d7a_00000", "date": "2024-09-11_18-20-43", "timestamp": 1726071643, "time_this_iter_s": 7.252043724060059, "time_total_s": 487.0681059360504, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA68092710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 487.0681059360504, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 69.73333333333335, "ram_util_percent": 92.37777777777778, "gpu_util_percent0": 0.08333333333333333, "vram_util_percent0": 0.09891764322916667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.20549342334270476, "cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 0.0003, "total_loss": 0.012470472231507301, "policy_loss": -0.0020886010250251276, "vf_loss": 0.018513211980462074, "vf_explained_var": 0.5588268101215362, "kl": 0.0011972163687460125, "entropy": 0.39541385471820834, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 645.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.12660030275583267, "cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 0.0003, "total_loss": 0.01790383867919445, "policy_loss": -0.001505133022510563, "vf_loss": 0.025332915596663952, "vf_explained_var": 0.5555870652198791, "kl": 0.0008157719862822432, "entropy": 0.5923944056034088, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 645.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.11860587149858474, "cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 0.0003, "total_loss": 0.026439793594181537, "policy_loss": -0.0006000488614603227, "vf_loss": 0.03229185417294502, "vf_explained_var": 0.4639918863773346, "kl": 0.00040261298536279353, "entropy": 0.5252012133598327, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 645.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.19316680878400802, "cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 0.0003, "total_loss": -0.0012820733652915805, "policy_loss": -0.000755412814214651, "vf_loss": 0.012555600609630346, "vf_explained_var": -0.005095565319061279, "kl": 0.003737415708383196, "entropy": 1.3082260966300965, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 645.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -0.395, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.27, "agent_1": 0.055, "agent_2": 0.28, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, 0.5, 0.5, -1.0, 0.5, -2.0, 0.5, -2.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -3.5, -2.5, -1.0, -2.0, -1.0, 0.5, -2.0, -0.5, 0.5, 0.5, 0.5, -2.0, 0.5, -1.5, -0.5, -0.5, -1.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -2.0, -0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -2.0, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -3.0, -2.0, -1.0, -2.0, -1.5, 0.5, -0.5, 0.5, -2.0, 0.5, 0.5, -2.0, -2.0, 0.5, -2.0, -0.5, -2.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5], "policy_agent_1_reward": [-0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0], "policy_agent_2_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.624723256355537, "mean_inference_ms": 20.36636815395661, "mean_action_processing_ms": 2.9713795685819786, "mean_env_wait_ms": 18.811074405131897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03142327070236206, "StateBufferConnector_ms": 0.014003455638885498, "ViewRequirementAgentConnector_ms": 0.16041713953018188}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -0.395, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 564.7079985278804, "num_env_steps_trained_throughput_per_sec": 564.7079985278804, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 7203.451, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7203.351, "sample_time_ms": 6270.596, "learn_time_ms": 892.228, "learn_throughput": 4483.159, "synch_weights_time_ms": 39.631}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "85d7a_00000", "date": "2024-09-11_18-20-50", "timestamp": 1726071650, "time_this_iter_s": 7.109222650527954, "time_total_s": 494.17732858657837, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0F1C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 494.17732858657837, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 64.27777777777777, "ram_util_percent": 92.3, "gpu_util_percent0": 0.061111111111111116, "vram_util_percent0": 0.09855143229166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1323363021016121, "cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 0.0003, "total_loss": 0.015876399446278812, "policy_loss": -0.00025830336946910395, "vf_loss": 0.019115648604929446, "vf_explained_var": 0.4723010420799255, "kl": 0.00030055240476940527, "entropy": 0.2980946809053421, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 655.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.214495712518692, "cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 0.0003, "total_loss": 0.0036683524260297416, "policy_loss": -0.0006036411754394066, "vf_loss": 0.00972130298614502, "vf_explained_var": 0.6654501795768738, "kl": 0.0007039726038783556, "entropy": 0.544930922985077, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 655.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.27203032821416856, "cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 0.0003, "total_loss": 0.011699561215937137, "policy_loss": -0.0015685228572692722, "vf_loss": 0.017848655022680758, "vf_explained_var": 0.4905106723308563, "kl": 0.0005990785422000045, "entropy": 0.45805703997612, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 655.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.13818930238485336, "cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 0.0003, "total_loss": -0.0005731415451009525, "policy_loss": -0.0007981598166225013, "vf_loss": 0.013335617166012526, "vf_explained_var": 0.022322958707809447, "kl": 0.0013480003868608036, "entropy": 1.3110599875450135, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 655.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.0, "episode_reward_mean": -0.225, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.32, "agent_1": 0.145, "agent_2": 0.31, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -2.0, -0.5, 0.5, 0.5, -0.5, 0.5, -1.0, 0.5, -1.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -2.0, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -3.0, -2.0, -1.0, -2.0, -1.5, 0.5, -0.5, 0.5, -2.0, 0.5, 0.5, -2.0, -2.0, 0.5, -2.0, -0.5, -2.5, 0.5, -1.0, 0.5, -1.0, -1.0, -2.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_1_reward": [0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_2_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.612533876596801, "mean_inference_ms": 20.34732212620843, "mean_action_processing_ms": 2.970193183447325, "mean_env_wait_ms": 18.798739970293685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029360651969909668, "StateBufferConnector_ms": 0.015213072299957275, "ViewRequirementAgentConnector_ms": 0.1548774242401123}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.0, "episode_return_mean": -0.225, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 582.1444437323538, "num_env_steps_trained_throughput_per_sec": 582.1444437323538, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 7211.052, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7210.953, "sample_time_ms": 6273.124, "learn_time_ms": 897.972, "learn_throughput": 4454.481, "synch_weights_time_ms": 38.96}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "85d7a_00000", "date": "2024-09-11_18-20-57", "timestamp": 1726071657, "time_this_iter_s": 6.908997297286987, "time_total_s": 501.08632588386536, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0FF40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 501.08632588386536, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 64.52222222222221, "ram_util_percent": 92.26666666666667, "gpu_util_percent0": 0.05777777777777778, "vram_util_percent0": 0.09857855902777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_2": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10727529972791672, "cur_kl_coeff": 2.7105054312137612e-21, "cur_lr": 0.0003, "total_loss": 0.00702435988932848, "policy_loss": -0.0010976186180414516, "vf_loss": 0.010765219200402498, "vf_explained_var": 0.6584341049194335, "kl": 0.00020417896087678855, "entropy": 0.2643240302801132, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 665.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.15156942009925842, "cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 0.0003, "total_loss": 0.008297599013894796, "policy_loss": -0.00012260539447197515, "vf_loss": 0.01366360867395997, "vf_explained_var": 0.6052683591842651, "kl": 7.834590742277215e-05, "entropy": 0.5243404388427735, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 665.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18036999702453613, "cur_kl_coeff": 2.7105054312137612e-21, "cur_lr": 0.0003, "total_loss": 0.014866734389215708, "policy_loss": -0.0012049735141772544, "vf_loss": 0.02072832491248846, "vf_explained_var": 0.4943040728569031, "kl": 0.00029760127881672815, "entropy": 0.46566176116466523, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 665.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}, "agent_3": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.08966986909508705, "cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 0.0003, "total_loss": 0.0008170418885129038, "policy_loss": -0.000829042984832995, "vf_loss": 0.014973246492445469, "vf_explained_var": -0.00253833532333374, "kl": 0.0013608688070235076, "entropy": 1.3327161073684692, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 4000.0, "num_grad_updates_lifetime": 665.5, "diff_num_grad_updates_vs_sampler_policy": 4.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -3.5, "episode_reward_mean": -0.255, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"agent_0": -0.5, "agent_1": -1.0, "agent_2": -1.0, "agent_3": -1.0}, "policy_reward_max": {"agent_0": 0.5, "agent_1": 0.5, "agent_2": 0.5, "agent_3": -1.0}, "policy_reward_mean": {"agent_0": 0.32, "agent_1": 0.13, "agent_2": 0.295, "agent_3": -1.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -3.0, -2.0, -1.0, -2.0, -1.5, 0.5, -0.5, 0.5, -2.0, 0.5, 0.5, -2.0, -2.0, 0.5, -2.0, -0.5, -2.5, 0.5, -1.0, 0.5, -1.0, -1.0, -2.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -3.5, -0.5, -2.0, -0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_agent_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_1_reward": [-0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "policy_agent_2_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5], "policy_agent_3_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.605665455966038, "mean_inference_ms": 20.32529427022773, "mean_action_processing_ms": 2.9650377575745965, "mean_env_wait_ms": 18.770723393600484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03652596473693848, "StateBufferConnector_ms": 0.016003549098968506, "ViewRequirementAgentConnector_ms": 0.17055261135101318}, "num_episodes": 32, "episode_return_max": 0.5, "episode_return_min": -3.5, "episode_return_mean": -0.255, "episodes_this_iter": 32}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 555.9337651735789, "num_env_steps_trained_throughput_per_sec": 555.9337651735789, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 7222.335, "restore_workers_time_ms": 0.0, "training_step_time_ms": 7222.235, "sample_time_ms": 6286.275, "learn_time_ms": 897.017, "learn_throughput": 4459.227, "synch_weights_time_ms": 38.047}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "85d7a_00000", "date": "2024-09-11_18-21-04", "timestamp": 1726071664, "time_this_iter_s": 7.224591970443726, "time_total_s": 508.3109178543091, "pid": 10160, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "DTE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x000002AA67F0F250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"agent_0": [null, null, null, null], "agent_1": [null, null, null, null], "agent_2": [null, null, null, null], "agent_3": [null, null, null, null], "shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 508.3109178543091, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 69.97777777777777, "ram_util_percent": 92.36666666666666, "gpu_util_percent0": 0.10555555555555556, "vram_util_percent0": 0.09834798177083333}}
