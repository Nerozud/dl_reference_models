{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.452172218170017, "cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 0.050633433274924755, "policy_loss": -0.0010568056371994317, "vf_loss": 0.06384287551045417, "vf_explained_var": -0.0021416395902633667, "kl": 0.00197825945333534, "entropy": 1.2548288136720658, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 20.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -2.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.8625, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.965625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -2.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -2.5, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.483333442501442, "mean_inference_ms": 5.4928270166743545, "mean_action_processing_ms": 2.85517211683734, "mean_env_wait_ms": 21.516075926626517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11316254734992981, "StateBufferConnector_ms": 0.055306702852249146, "ViewRequirementAgentConnector_ms": 0.6811729073524475}, "num_episodes": 160, "episode_return_max": -2.5, "episode_return_min": -4.0, "episode_return_mean": -3.8625, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 711.0555734567436, "num_env_steps_trained_throughput_per_sec": 711.0555734567436, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 22501.757, "restore_workers_time_ms": 0.0, "training_step_time_ms": 22501.757, "sample_time_ms": 19491.253, "learn_time_ms": 2976.907, "learn_throughput": 5374.707, "synch_weights_time_ms": 29.596}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 1, "trial_id": "3419b_00000", "date": "2024-09-11_17-48-54", "timestamp": 1726069734, "time_this_iter_s": 22.510974645614624, "time_total_s": 22.510974645614624, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x00000297102FD090>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.510974645614624, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 72.7448275862069, "ram_util_percent": 86.63103448275861, "gpu_util_percent0": 0.048620689655172425, "vram_util_percent0": 0.1427464978448276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3865151908248663, "cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 0.03510085050947964, "policy_loss": -0.0021148979023564605, "vf_loss": 0.049415566865354775, "vf_explained_var": 0.01782643347978592, "kl": 0.004454986349492174, "entropy": 1.2645318120718003, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": -2.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.834375, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.95859375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -2.5, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -3.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -3.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -2.5, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.060699457174296, "mean_inference_ms": 5.18010549254708, "mean_action_processing_ms": 2.6941615920681334, "mean_env_wait_ms": 20.40473010751989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1038070023059845, "StateBufferConnector_ms": 0.041023045778274536, "ViewRequirementAgentConnector_ms": 0.6648674607276917}, "num_episodes": 160, "episode_return_max": -2.5, "episode_return_min": -4.0, "episode_return_mean": -3.834375, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 791.2037684714899, "num_env_steps_trained_throughput_per_sec": 791.2037684714899, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 21362.054, "restore_workers_time_ms": 0.0, "training_step_time_ms": 21362.054, "sample_time_ms": 18514.747, "learn_time_ms": 2814.51, "learn_throughput": 5684.826, "synch_weights_time_ms": 28.788}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 2, "trial_id": "3419b_00000", "date": "2024-09-11_17-49-26", "timestamp": 1726069766, "time_this_iter_s": 20.231382608413696, "time_total_s": 42.74235725402832, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x0000029710290DC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42.74235725402832, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 48.06585365853659, "ram_util_percent": 90.33658536585367, "gpu_util_percent0": 0.01926829268292683, "vram_util_percent0": 0.14449552210365854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.27621315233409405, "cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 0.026448606373742224, "policy_loss": -0.0018602409181767143, "vf_loss": 0.04037809045985341, "vf_explained_var": 0.01770767420530319, "kl": 0.0048386068325498854, "entropy": 1.2311172574758529, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 100.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": -2.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.7375, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.934375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.0, -3.5, -2.5, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -3.0, -4.0, -2.5, -4.0, -3.5, -3.5, -2.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -2.0, -2.5, -2.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -3.0, -3.0, -4.0, -3.0, -2.0, -4.0, -3.5, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -3.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -2.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.0, -4.0, -4.0, -4.0, -4.0, -4.0, -2.5, -4.0, -4.0, -4.0, -2.5, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.903425952420879, "mean_inference_ms": 5.062959596842309, "mean_action_processing_ms": 2.6250158763583067, "mean_env_wait_ms": 19.744482261192633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09876370429992676, "StateBufferConnector_ms": 0.04400685429573059, "ViewRequirementAgentConnector_ms": 0.6069353222846985}, "num_episodes": 160, "episode_return_max": -2.0, "episode_return_min": -4.0, "episode_return_mean": -3.7375, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 816.4307033312506, "num_env_steps_trained_throughput_per_sec": 816.4307033312506, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 20773.869, "restore_workers_time_ms": 0.0, "training_step_time_ms": 20773.869, "sample_time_ms": 17972.588, "learn_time_ms": 2768.602, "learn_throughput": 5779.089, "synch_weights_time_ms": 29.0}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 3, "trial_id": "3419b_00000", "date": "2024-09-11_17-49-45", "timestamp": 1726069785, "time_this_iter_s": 19.606841325759888, "time_total_s": 62.34919857978821, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x00000297102FCDC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 62.34919857978821, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 63.484615384615395, "ram_util_percent": 90.78461538461539, "gpu_util_percent0": 0.005384615384615385, "vram_util_percent0": 0.14453125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.20463095987215638, "cur_kl_coeff": 0.025, "cur_lr": 0.0003, "total_loss": 0.020745107228867708, "policy_loss": -0.002011385962373424, "vf_loss": 0.03403365137055516, "vf_explained_var": 0.020201793313026427, "kl": 0.00470095142864011, "entropy": 1.1394682079553604, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 140.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": -1.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.65, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.9125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -4.0, -4.0, -4.0, -2.5, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -3.0, -4.0, -4.0, -4.0, -4.0, -2.5, -2.0, -4.0, -2.5, -4.0, -4.0, -2.5, -3.5, -4.0, -3.5, -4.0, -3.5, -2.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -3.5, -2.0, -4.0, -3.0, -4.0, -3.5, -3.5, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -4.0, -2.5, -2.5, -3.5, -4.0, -3.5, -3.0, -4.0, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -3.0, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -4.0, -3.5, -3.0, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -3.5, -2.0, -4.0, -4.0, -3.0, -2.5, -2.5, -4.0, -3.5, -4.0, -4.0, -4.0, -4.0, -2.5, -4.0, -3.5, -4.0, -4.0, -2.5, -4.0, -1.5, -4.0, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.851354826217529, "mean_inference_ms": 5.030869454636924, "mean_action_processing_ms": 2.6118035080550848, "mean_env_wait_ms": 19.223068414003713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12252658605575562, "StateBufferConnector_ms": 0.030098557472229004, "ViewRequirementAgentConnector_ms": 0.6449726223945618}, "num_episodes": 160, "episode_return_max": -1.5, "episode_return_min": -4.0, "episode_return_mean": -3.65, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 820.1062915340123, "num_env_steps_trained_throughput_per_sec": 820.1062915340123, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 20457.818, "restore_workers_time_ms": 0.0, "training_step_time_ms": 20457.818, "sample_time_ms": 17652.806, "learn_time_ms": 2772.876, "learn_throughput": 5770.183, "synch_weights_time_ms": 28.373}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 4, "trial_id": "3419b_00000", "date": "2024-09-11_17-50-05", "timestamp": 1726069805, "time_this_iter_s": 19.52178382873535, "time_total_s": 81.87098240852356, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x00000297102FEEF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81.87098240852356, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 65.932, "ram_util_percent": 90.96799999999999, "gpu_util_percent0": 0.0276, "vram_util_percent0": 0.14396484375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.1299171513877809, "cur_kl_coeff": 0.0125, "cur_lr": 0.0003, "total_loss": 0.01787248378386721, "policy_loss": -0.001147408196993638, "vf_loss": 0.02949553313665092, "vf_explained_var": 0.11264607906341553, "kl": 0.001794141306754682, "entropy": 1.0498068153858184, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.45625, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.8640625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.0, -2.5, -3.5, -4.0, -4.0, -0.5, -3.5, -4.0, -2.5, -2.5, -3.0, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -2.5, -4.0, -1.5, -3.5, -3.5, -3.5, -4.0, -3.5, -1.5, -4.0, -3.5, -4.0, -3.5, -1.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -1.0, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -3.0, -3.5, -4.0, -3.5, -4.0, -4.0, -3.5, -2.5, -3.5, -2.5, -4.0, -2.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -2.5, -2.5, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -4.0, -4.0, -2.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -2.5, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -2.0, -4.0, -2.5, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -2.5, -3.5, -4.0, -4.0, -4.0, -3.5, -3.5, -3.5, -2.5, -4.0, -3.5, -3.5, -2.5, -3.0, -3.5, -3.5, -4.0, -3.5, -4.0, -4.0, -4.0, -2.5, -4.0, -3.5, -3.5, -4.0, -4.0, -3.5, -4.0, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.855771208514885, "mean_inference_ms": 5.043667299849469, "mean_action_processing_ms": 2.7059185557344447, "mean_env_wait_ms": 18.754320841033856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10712146759033203, "StateBufferConnector_ms": 0.03207504749298096, "ViewRequirementAgentConnector_ms": 0.6671096384525299}, "num_episodes": 160, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -3.45625, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 814.7496191730743, "num_env_steps_trained_throughput_per_sec": 814.7496191730743, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 20293.842, "restore_workers_time_ms": 0.0, "training_step_time_ms": 20293.842, "sample_time_ms": 17452.229, "learn_time_ms": 2809.372, "learn_throughput": 5695.223, "synch_weights_time_ms": 28.18}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 5, "trial_id": "3419b_00000", "date": "2024-09-11_17-50-25", "timestamp": 1726069825, "time_this_iter_s": 19.647194385528564, "time_total_s": 101.51817679405212, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x00000297102FF9A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 101.51817679405212, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 68.2, "ram_util_percent": 90.96400000000001, "gpu_util_percent0": 0.0424, "vram_util_percent0": 0.1478173828125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.10745784360915422, "cur_kl_coeff": 0.00625, "cur_lr": 0.0003, "total_loss": 0.014257554194773547, "policy_loss": -0.0019320175830216612, "vf_loss": 0.026102835033088922, "vf_explained_var": 0.2508703157305717, "kl": 0.004945830605583979, "entropy": 0.9944174855947494, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 220.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.43125, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.8578125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -2.5, -3.5, -3.5, -3.5, -2.5, -3.5, -1.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -2.0, -3.5, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -4.0, -3.0, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -2.0, -3.5, -4.0, -2.5, -4.0, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -4.0, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -0.5, -2.0, -3.5, -4.0, -3.5, -2.5, -3.5, -3.5, -4.0, -2.5, -4.0, -4.0, -2.5, -3.5, -3.5, -2.0, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -2.5, -2.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -4.0, -3.0, -3.5, -3.5, -4.0, -3.5, -3.5, -2.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.999807953715364, "mean_inference_ms": 5.124021911176193, "mean_action_processing_ms": 2.7320577040865834, "mean_env_wait_ms": 18.58554315225397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.14378875494003296, "StateBufferConnector_ms": 0.03478839993476868, "ViewRequirementAgentConnector_ms": 0.7904602587223053}, "num_episodes": 160, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -3.43125, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 781.1508496500808, "num_env_steps_trained_throughput_per_sec": 781.1508496500808, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 20325.301, "restore_workers_time_ms": 0.0, "training_step_time_ms": 20325.301, "sample_time_ms": 17478.607, "learn_time_ms": 2814.375, "learn_throughput": 5685.099, "synch_weights_time_ms": 28.268}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 6, "trial_id": "3419b_00000", "date": "2024-09-11_17-50-45", "timestamp": 1726069845, "time_this_iter_s": 20.490758180618286, "time_total_s": 122.00893497467041, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x00000297103C0700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 122.00893497467041, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 72.21153846153847, "ram_util_percent": 91.0576923076923, "gpu_util_percent0": 0.06461538461538462, "vram_util_percent0": 0.149169921875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09366223318502306, "cur_kl_coeff": 0.003125, "cur_lr": 0.0003, "total_loss": 0.01396054035431007, "policy_loss": -0.0017375362669554307, "vf_loss": 0.025788289261981845, "vf_explained_var": 0.31928853690624237, "kl": 0.003847757954235931, "entropy": 1.0102236688137054, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 260.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": -1.0, "episode_reward_min": -4.0, "episode_reward_mean": -3.28125, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.8203125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5, -3.0, -1.5, -3.0, -3.5, -2.0, -3.0, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -2.0, -3.0, -3.5, -3.5, -3.5, -3.5, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -2.5, -3.5, -2.5, -3.5, -2.5, -3.0, -3.0, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -1.0, -3.5, -2.5, -3.5, -3.5, -1.5, -3.5, -3.5, -3.5, -3.5, -4.0, -3.0, -2.5, -3.5, -3.5, -3.0, -3.5, -2.5, -3.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -2.5, -2.0, -3.5, -3.5, -3.5, -3.5, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -1.5, -3.5, -3.5, -3.0, -3.0, -2.5, -3.5, -3.5, -2.5, -3.5, -3.5, -3.5, -1.5, -3.5, -3.5, -2.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -4.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.060837696021505, "mean_inference_ms": 5.174941954970938, "mean_action_processing_ms": 2.7473507370822126, "mean_env_wait_ms": 18.453799930854174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12064993381500244, "StateBufferConnector_ms": 0.03365084528923035, "ViewRequirementAgentConnector_ms": 0.6975151598453522}, "num_episodes": 160, "episode_return_max": -1.0, "episode_return_min": -4.0, "episode_return_mean": -3.28125, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 793.4279924360712, "num_env_steps_trained_throughput_per_sec": 793.4279924360712, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 20302.496, "restore_workers_time_ms": 0.0, "training_step_time_ms": 20302.496, "sample_time_ms": 17471.909, "learn_time_ms": 2798.235, "learn_throughput": 5717.89, "synch_weights_time_ms": 28.307}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 7, "trial_id": "3419b_00000", "date": "2024-09-11_17-51-05", "timestamp": 1726069865, "time_this_iter_s": 20.173822164535522, "time_total_s": 142.18275713920593, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x00000297102FD5A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 142.18275713920593, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 72.66, "ram_util_percent": 91.40400000000001, "gpu_util_percent0": 0.11320000000000001, "vram_util_percent0": 0.151669921875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.09443210233002901, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0003, "total_loss": 0.01670685697463341, "policy_loss": -0.002377063902531518, "vf_loss": 0.029616348911076784, "vf_explained_var": 0.29150719493627547, "kl": 0.0043692240363725435, "entropy": 1.0539255499839784, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": -1.5, "episode_reward_min": -4.0, "episode_reward_mean": -3.059375, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.76484375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.0, -3.5, -3.0, -2.5, -1.5, -3.0, -3.5, -1.5, -3.5, -3.5, -3.0, -2.5, -3.5, -4.0, -3.5, -2.5, -2.0, -3.0, -2.0, -3.5, -3.5, -3.0, -3.5, -3.5, -3.0, -1.5, -3.5, -3.0, -3.0, -1.5, -3.5, -3.5, -3.0, -3.5, -3.0, -3.5, -2.5, -2.5, -3.5, -3.5, -3.5, -3.0, -3.0, -2.0, -2.0, -3.5, -3.0, -2.0, -3.0, -3.5, -3.5, -4.0, -3.5, -3.5, -3.5, -2.0, -3.0, -3.5, -3.5, -3.5, -3.5, -2.5, -3.0, -2.0, -2.0, -3.5, -3.5, -3.5, -4.0, -4.0, -3.5, -3.0, -3.0, -3.5, -3.5, -3.0, -2.0, -3.5, -3.0, -3.5, -3.5, -3.5, -3.5, -4.0, -3.0, -3.5, -3.5, -2.5, -3.0, -2.5, -3.0, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -2.0, -3.0, -3.5, -2.5, -3.5, -2.0, -2.5, -2.0, -3.5, -3.0, -2.5, -3.5, -3.5, -3.0, -3.0, -3.5, -3.0, -3.0, -3.5, -3.0, -3.5, -3.5, -2.5, -1.5, -3.5, -3.0, -3.5, -1.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.0, -3.5, -2.5, -4.0, -3.5, -3.0, -3.5, -2.5, -2.0, -3.5, -3.0, -2.0, -1.5, -2.5, -2.5, -3.0, -3.5, -3.0, -3.5, -3.0, -3.0, -2.5, -3.0, -2.0, -3.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.084316867138558, "mean_inference_ms": 5.187847299356515, "mean_action_processing_ms": 2.7475053520388557, "mean_env_wait_ms": 18.346487716030282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1170167326927185, "StateBufferConnector_ms": 0.05947336554527283, "ViewRequirementAgentConnector_ms": 0.6834058463573456}, "num_episodes": 160, "episode_return_max": -1.5, "episode_return_min": -4.0, "episode_return_mean": -3.059375, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 800.0456740705147, "num_env_steps_trained_throughput_per_sec": 800.0456740705147, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 20264.541, "restore_workers_time_ms": 0.0, "training_step_time_ms": 20264.541, "sample_time_ms": 17442.259, "learn_time_ms": 2790.031, "learn_throughput": 5734.703, "synch_weights_time_ms": 28.212}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 8, "trial_id": "3419b_00000", "date": "2024-09-11_17-51-25", "timestamp": 1726069885, "time_this_iter_s": 20.007145166397095, "time_total_s": 162.18990230560303, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x00000297102FED40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 162.18990230560303, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 67.52307692307691, "ram_util_percent": 91.69615384615386, "gpu_util_percent0": 0.08307692307692308, "vram_util_percent0": 0.15519362229567307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.07006509546190501, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0003, "total_loss": 0.020552802458405496, "policy_loss": -0.001600727160621318, "vf_loss": 0.032909110002219674, "vf_explained_var": 0.27668641954660417, "kl": 0.0035819893705820506, "entropy": 1.075837966799736, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 340.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": -1.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.89375, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.7234375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -1.5, -2.5, -3.0, -3.0, -2.5, -3.0, -1.5, -1.5, -3.5, -3.0, -3.5, -3.0, -3.5, -3.0, -1.5, -2.5, -3.0, -2.0, -3.5, -3.0, -3.5, -3.0, -3.5, -3.0, -3.5, -3.0, -3.5, -2.0, -3.0, -3.5, -2.5, -3.0, -3.0, -3.0, -4.0, -2.0, -2.0, -2.0, -2.5, -3.5, -1.5, -3.5, -3.5, -3.0, -2.5, -3.0, -3.5, -3.5, -3.5, -2.0, -3.0, -3.0, -3.0, -3.5, -2.0, -3.5, -3.0, -2.5, -1.5, -1.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.0, -3.5, -3.0, -1.5, -3.0, -2.0, -3.5, -2.0, -2.0, -3.0, -2.5, -2.5, -3.0, -3.5, -3.0, -3.5, -3.5, -1.5, -3.5, -1.5, -3.0, -2.0, -3.5, -2.5, -3.5, -2.5, -3.5, -3.0, -2.5, -3.0, -3.0, -3.5, -2.0, -3.0, -3.0, -3.5, -3.5, -3.5, -3.0, -3.0, -3.0, -3.0, -1.5, -3.5, -1.5, -2.0, -3.5, -3.0, -3.0, -3.5, -3.0, -2.5, -3.5, -2.5, -3.5, -2.5, -2.5, -1.5, -3.0, -3.5, -2.0, -3.0, -2.0, -3.5, -2.5, -3.0, -3.5, -2.5, -3.5, -3.5, -2.0, -3.5, -3.0, -1.5, -3.5, -2.5, -3.5, -3.0, -3.5, -3.5, -3.0, -3.5, -3.5, -3.5, -3.5, -3.0, -2.0, -3.5, -3.5, -3.0, -3.5, -3.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.043235678112367, "mean_inference_ms": 5.160539839114647, "mean_action_processing_ms": 2.725137277222612, "mean_env_wait_ms": 18.15672737575854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07196754217147827, "StateBufferConnector_ms": 0.034879446029663086, "ViewRequirementAgentConnector_ms": 0.7034657895565033}, "num_episodes": 160, "episode_return_max": -1.5, "episode_return_min": -4.0, "episode_return_mean": -2.89375, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 844.0130247588262, "num_env_steps_trained_throughput_per_sec": 844.0130247588262, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 20119.264, "restore_workers_time_ms": 0.0, "training_step_time_ms": 20119.264, "sample_time_ms": 17296.432, "learn_time_ms": 2790.202, "learn_throughput": 5734.351, "synch_weights_time_ms": 28.594}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 9, "trial_id": "3419b_00000", "date": "2024-09-11_17-51-44", "timestamp": 1726069904, "time_this_iter_s": 18.965561151504517, "time_total_s": 181.15546345710754, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x00000297103C1990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 181.15546345710754, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 65.75, "ram_util_percent": 91.72916666666667, "gpu_util_percent0": 0.045000000000000005, "vram_util_percent0": 0.1429901123046875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.06959852697327733, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0003, "total_loss": 0.021469897055067123, "policy_loss": -0.0015053411101689563, "vf_loss": 0.033852798584848645, "vf_explained_var": 0.3135202914476395, "kl": 0.0021021430694872834, "entropy": 1.0878381103277206, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 380.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.76875, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.6921875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -3.5, -1.5, -3.0, -1.5, -3.5, -2.0, -3.5, -2.0, -2.5, -3.5, -3.0, -3.5, -3.0, -3.5, -3.0, -3.0, -3.0, -2.5, -3.0, -3.5, -2.0, -3.5, -2.5, -2.0, -1.5, -3.5, -3.5, -3.0, -2.0, -3.0, -3.0, -2.5, -3.0, -2.5, -3.5, -3.5, -3.0, -3.0, -3.0, -2.5, -3.0, -1.5, -2.0, -3.0, -2.0, -2.0, -3.0, -3.5, -1.5, -3.0, -3.0, -3.0, -3.5, -2.5, -3.5, -3.0, -3.5, -3.5, -3.5, -2.5, -3.5, -1.5, -3.5, -3.0, -3.5, -3.0, -3.0, -3.0, -3.5, -2.0, -3.5, -3.0, -3.0, -3.0, -2.0, -3.0, -1.5, -3.5, -2.0, -3.5, -3.0, -2.5, -3.0, -3.0, -3.5, -2.5, -3.0, -3.0, -2.5, -1.0, -2.5, -3.5, -2.5, -1.5, -2.0, -1.5, -1.0, -3.5, -3.0, -3.5, -3.0, -3.0, -2.5, -3.0, -2.0, -3.5, -3.5, -3.0, -3.5, -2.5, -2.5, -3.5, -2.5, -3.0, -3.5, -2.0, -2.5, -2.5, -2.0, -3.5, -3.0, -3.0, -2.0, -2.0, -3.0, -3.5, -3.5, -2.0, -1.5, -3.0, -3.0, -2.5, -2.5, -3.5, -2.5, -3.0, -3.5, -2.5, -3.5, -2.5, -3.0, -2.5, -3.0, -3.5, -2.0, -3.0, -3.0, -0.5, -3.0, -3.0, -3.0, -2.0, -1.5, -3.0, -2.5, -3.0, -2.5, -3.5, -1.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.016341776877397, "mean_inference_ms": 5.140846138166394, "mean_action_processing_ms": 2.7100046714099264, "mean_env_wait_ms": 18.05468042167133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10647788643836975, "StateBufferConnector_ms": 0.05210384726524353, "ViewRequirementAgentConnector_ms": 0.6527669727802277}, "num_episodes": 160, "episode_return_max": -0.5, "episode_return_min": -3.5, "episode_return_mean": -2.76875, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 831.7619302627144, "num_env_steps_trained_throughput_per_sec": 831.7619302627144, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 20030.965, "restore_workers_time_ms": 0.0, "training_step_time_ms": 20030.965, "sample_time_ms": 17216.235, "learn_time_ms": 2781.874, "learn_throughput": 5751.519, "synch_weights_time_ms": 28.822}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 10, "trial_id": "3419b_00000", "date": "2024-09-11_17-52-04", "timestamp": 1726069924, "time_this_iter_s": 19.243562936782837, "time_total_s": 200.39902639389038, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x00000297103C2C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 200.39902639389038, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 67.15833333333333, "ram_util_percent": 91.64583333333333, "gpu_util_percent0": 0.05541666666666667, "vram_util_percent0": 0.14348856608072916}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.06389233153313398, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0003, "total_loss": 0.023364074400160462, "policy_loss": -0.0024142390830093063, "vf_loss": 0.03689616471529007, "vf_explained_var": 0.306173799932003, "kl": 0.003966443690956112, "entropy": 1.1118626922369004, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -3.5, "episode_reward_mean": -2.7, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.5, -3.5, -3.0, -3.0, -3.5, -3.0, -3.0, -3.0, -3.5, -2.5, -2.0, -3.0, -3.5, -2.5, -3.5, -1.5, -3.5, -1.5, -3.0, -3.0, -3.0, -0.5, -0.5, -2.0, -2.5, -3.5, -3.5, -2.5, -2.5, -3.0, -3.0, -3.0, -3.0, -3.0, -2.5, -3.0, -3.0, -2.5, -2.5, -3.5, -3.0, -3.0, -2.5, -1.5, -3.0, -2.5, -3.0, -3.5, -3.0, -3.0, -3.0, -2.5, -3.0, -3.0, -2.5, -3.5, -3.5, -3.5, -3.5, -2.0, -3.5, -1.5, -2.5, -2.0, -3.0, -3.0, -3.0, -3.0, -2.0, -2.5, -2.5, -2.5, -1.5, -3.0, -3.0, -2.5, -3.0, -3.5, -3.5, -1.5, -3.5, -3.5, -3.0, -3.5, -2.5, -3.5, -3.5, -3.0, -3.5, -3.0, -3.5, -2.5, -3.0, -1.5, -3.5, -3.0, -2.5, -1.5, -2.5, -3.0, -2.5, -3.0, -3.0, -3.0, -1.5, -2.5, -3.0, -0.5, -1.0, -3.0, -2.5, -2.5, -3.0, -3.5, -2.0, -3.0, -3.0, -3.0, -2.5, -3.0, -1.5, -2.5, -1.5, -3.0, -3.0, -3.5, -3.5, -2.0, -3.0, -2.0, -2.5, -3.5, -2.5, -3.5, -3.5, -3.0, -2.5, -2.0, -3.5, -2.0, -2.5, -3.0, -3.5, -3.0, -1.5, -2.5, -2.0, -2.5, -0.5, -2.5, -3.0, -1.5, -2.5, -3.0, -3.5, -3.0, -3.0, -1.5, -2.0, -2.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, 0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.989020141508985, "mean_inference_ms": 5.121542088358299, "mean_action_processing_ms": 2.694331625551987, "mean_env_wait_ms": 18.02690940712868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12672662734985352, "StateBufferConnector_ms": 0.035685598850250244, "ViewRequirementAgentConnector_ms": 0.6338298320770264}, "num_episodes": 160, "episode_return_max": -0.5, "episode_return_min": -3.5, "episode_return_mean": -2.7, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 816.0886222794823, "num_env_steps_trained_throughput_per_sec": 816.0886222794823, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 19741.361, "restore_workers_time_ms": 0.0, "training_step_time_ms": 19741.361, "sample_time_ms": 16950.816, "learn_time_ms": 2757.157, "learn_throughput": 5803.079, "synch_weights_time_ms": 29.353}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 11, "trial_id": "3419b_00000", "date": "2024-09-11_17-52-23", "timestamp": 1726069943, "time_this_iter_s": 19.612889766693115, "time_total_s": 220.0119161605835, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x00000297103C3D90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 220.0119161605835, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 63.715384615384615, "ram_util_percent": 91.61923076923075, "gpu_util_percent0": 0.05538461538461539, "vram_util_percent0": 0.14369553786057693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.07473966693505645, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0003, "total_loss": 0.025718455552123487, "policy_loss": -0.0029293888248503206, "vf_loss": 0.039694773592054845, "vf_explained_var": 0.2600641191005707, "kl": 0.005895165071797237, "entropy": 1.1047506004571914, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 460.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": -0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.48125, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.6203125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5, -1.5, -2.5, -0.5, -2.5, -3.5, -2.0, -3.5, -3.0, -3.0, -2.5, -2.5, -3.0, -3.0, -3.5, -3.0, -2.5, -1.5, -3.0, -2.0, -1.5, -3.5, -3.0, -2.5, -2.0, -1.5, -2.0, -3.5, -3.0, -2.5, -2.0, -3.0, -2.0, -2.0, -2.5, -3.0, -4.0, -2.5, -0.5, -2.5, -2.5, -0.5, -3.0, -2.0, -3.5, -1.5, -3.0, -2.5, -2.0, -3.0, -2.0, -3.0, -2.5, -2.0, -3.0, -2.0, -1.5, -2.5, -2.5, -0.5, -3.0, -2.5, -2.5, -3.0, -3.5, -2.5, -3.0, -3.0, -2.0, -1.5, -3.0, -2.5, -3.5, -3.5, -3.0, -3.0, -2.0, -2.5, -2.5, -1.5, -2.5, -2.0, -2.5, -3.5, -3.5, -2.0, -2.5, -2.0, -3.0, -2.5, -1.5, -3.0, -2.5, -3.0, -3.5, -1.5, -3.0, -0.5, -3.5, -2.0, -1.5, -2.5, -2.5, -3.0, -2.5, -2.5, -0.5, -3.0, -2.0, -3.0, -2.5, -2.0, -1.5, -3.0, -3.0, -3.0, -2.0, -3.0, -2.0, -3.0, -2.0, -1.5, -2.5, -3.0, -1.5, -2.5, -3.0, -3.5, -1.5, -3.0, -2.5, -3.5, -2.5, -3.5, -2.5, -2.5, -2.0, -2.5, -3.0, -3.5, -3.0, -3.0, -3.0, -2.5, -1.5, -3.0, -3.0, -3.0, -2.5, -2.5, -1.5, -2.5, -1.0, -1.5, -2.0, -2.5, -3.0, -1.5, -3.0, -3.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.989051743877508, "mean_inference_ms": 5.125243918853211, "mean_action_processing_ms": 2.6921268314783666, "mean_env_wait_ms": 18.146350560158897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10295987129211426, "StateBufferConnector_ms": 0.040106773376464844, "ViewRequirementAgentConnector_ms": 0.6669421494007111}, "num_episodes": 160, "episode_return_max": -0.5, "episode_return_min": -4.0, "episode_return_mean": -2.48125, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 761.3550897835048, "num_env_steps_trained_throughput_per_sec": 761.3550897835048, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 19820.642, "restore_workers_time_ms": 0.0, "training_step_time_ms": 19820.642, "sample_time_ms": 16982.37, "learn_time_ms": 2805.115, "learn_throughput": 5703.866, "synch_weights_time_ms": 29.211}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 12, "trial_id": "3419b_00000", "date": "2024-09-11_17-52-44", "timestamp": 1726069964, "time_this_iter_s": 21.024352312088013, "time_total_s": 241.0362684726715, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x00000297103C1D80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 241.0362684726715, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 70.96153846153847, "ram_util_percent": 91.84615384615384, "gpu_util_percent0": 0.10153846153846155, "vram_util_percent0": 0.1486487755408654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.057763146981596944, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0003, "total_loss": 0.027384634793270378, "policy_loss": -0.0018989211030202569, "vf_loss": 0.039894514810293914, "vf_explained_var": 0.26577114313840866, "kl": 0.0029532713450862503, "entropy": 1.0611246347427368, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 16000.0, "num_grad_updates_lifetime": 500.5, "diff_num_grad_updates_vs_sampler_policy": 19.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 0.5, "episode_reward_min": -4.0, "episode_reward_mean": -2.390625, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 16000, "policy_reward_min": {"shared_policy": -1.0}, "policy_reward_max": {"shared_policy": 0.5}, "policy_reward_mean": {"shared_policy": -0.59765625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.5, -3.0, -3.5, -2.5, -1.0, -3.0, -3.0, -3.5, -2.0, -2.5, -3.0, -3.0, -2.5, -2.0, -2.5, -3.0, -3.5, -2.5, -2.0, -3.0, -3.0, -2.5, -1.0, -3.0, -1.5, -2.5, -1.5, -3.0, -3.0, -3.0, -2.5, -2.5, -0.5, -0.5, -2.5, -2.0, -3.0, -3.0, -2.5, -2.5, -2.0, -3.5, -2.0, -3.0, -2.5, -3.0, -3.0, -2.0, -3.5, -2.0, -2.5, -1.5, -3.0, -1.5, -3.0, -0.5, -2.0, -3.0, -2.0, -2.0, -3.5, -2.0, -3.0, -2.0, -2.0, -0.5, -1.5, -2.0, -3.0, -2.5, -3.0, -1.5, -1.5, -3.0, -2.5, -3.5, -2.5, -2.0, -3.0, -2.5, -1.5, -2.5, -3.5, -3.0, -1.5, -2.5, -3.0, -2.0, -3.0, -1.5, -1.5, -3.5, -2.5, -3.0, -3.0, -2.0, -1.5, -3.0, -1.5, -3.0, -1.5, -3.5, 0.5, -2.5, -2.0, -3.0, -3.5, -0.5, -3.0, -2.0, -1.5, -2.0, -1.5, -0.5, -3.0, -3.0, -2.5, -1.5, -1.5, -0.5, -3.5, -2.5, -2.5, -3.0, -3.0, -1.5, -3.0, -2.0, -1.5, -2.5, -2.0, -2.5, -3.0, -3.0, -2.5, -2.0, -3.0, -2.0, -3.0, -3.0, -2.5, -2.5, -3.0, -3.0, -2.0, -3.0, -2.5, -3.0, -2.0, -2.5, -1.5, -3.0, -3.0, -1.5, -3.0, -2.5, -1.5, -3.5, -4.0, -1.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_shared_policy_reward": [-0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, 0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -1.0, -0.5, -1.0, -1.0, 0.5, 0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, 0.5, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, 0.5, -0.5, -1.0, 0.5, -0.5, 0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, 0.5, 0.5, -1.0, -0.5, -1.0, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, 0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, 0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, 0.5, -0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -1.0, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -0.5, -0.5, -1.0, -1.0, -0.5, -0.5, -0.5, -1.0, -0.5, -0.5, 0.5, -1.0, -1.0, -0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -0.5, -0.5, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.039761820016981, "mean_inference_ms": 5.168559825928316, "mean_action_processing_ms": 2.7144106832435915, "mean_env_wait_ms": 18.385974352514904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.13448745012283325, "StateBufferConnector_ms": 0.04993438720703125, "ViewRequirementAgentConnector_ms": 0.6984122097492218}, "num_episodes": 160, "episode_return_max": 0.5, "episode_return_min": -4.0, "episode_return_mean": -2.390625, "episodes_this_iter": 160}, "num_healthy_workers": 8, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 16000, "num_env_steps_trained_this_iter": 16000, "num_env_steps_sampled_throughput_per_sec": 712.6196121631392, "num_env_steps_trained_throughput_per_sec": 712.6196121631392, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 16000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 20106.129, "restore_workers_time_ms": 0.0, "training_step_time_ms": 20106.129, "sample_time_ms": 17248.64, "learn_time_ms": 2824.351, "learn_throughput": 5665.018, "synch_weights_time_ms": 29.195}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 13, "trial_id": "3419b_00000", "date": "2024-09-11_17-53-07", "timestamp": 1726069987, "time_this_iter_s": 22.460577726364136, "time_total_s": 263.49684619903564, "pid": 19824, "hostname": "la-marcmuel-ilm", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "ReferenceModel-2-2", "env_config": {"num_agents": 4, "sensor_range": 2, "deterministic": true, "training_execution_mode": "CTDE", "render_env": false}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "num_envs_per_env_runner": 4, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 300, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 16000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [32, 32], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "my_action_mask_model", "custom_model_config": {"no_masking": false, "fcnet_hiddens": [32, 32]}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_ppo_config.<locals>.<lambda> at 0x00000297102905E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 16000, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"shared_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 263.49684619903564, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 73.63448275862068, "ram_util_percent": 92.52068965517243, "gpu_util_percent0": 0.04655172413793104, "vram_util_percent0": 0.1607623922413793}}
